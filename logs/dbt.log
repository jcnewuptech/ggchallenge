

============================== 2023-01-06 01:29:11.057023 | 151e9aa2-2e77-446a-9a2f-47f571c5d9d3 ==============================
[0m01:29:11.057030 [info ] [MainThread]: Running with dbt=1.3.2
[0m01:29:11.057261 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joaopaulomedeiroscecilio/dev/dbt-data-analysis', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m01:29:11.057344 [debug] [MainThread]: Tracking: tracking
[0m01:29:11.074168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080c4550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10811ddf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10811d220>]}
[0m01:29:11.075433 [debug] [MainThread]: Set downloads directory='/var/folders/nr/2t4z4mks1h3fqcd9w6_2ftvr0000gn/T/dbt-downloads-l66uaqgs'
[0m01:29:11.075751 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m01:29:11.717188 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m01:29:11.717470 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m01:29:11.833200 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m01:29:11.858825 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m01:29:12.860267 [info ] [MainThread]:   Installed from version 1.0.0
[0m01:29:12.860536 [info ] [MainThread]:   Up to date!
[0m01:29:12.860813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '151e9aa2-2e77-446a-9a2f-47f571c5d9d3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081d0f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081d0fa0>]}
[0m01:29:12.861430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080c4550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081d0f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10811d550>]}
[0m01:29:12.861600 [debug] [MainThread]: Flushing usage events


============================== 2023-01-06 01:29:19.903238 | 347568a4-e6e3-42aa-939a-805bd872147d ==============================
[0m01:29:19.903255 [info ] [MainThread]: Running with dbt=1.3.2
[0m01:29:19.904320 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joaopaulomedeiroscecilio/dev/dbt-data-analysis', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
[0m01:29:19.904440 [debug] [MainThread]: Tracking: tracking
[0m01:29:19.917655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f941cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f941df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f941e20>]}
[0m01:29:19.929075 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m01:29:19.929279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '347568a4-e6e3-42aa-939a-805bd872147d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f971130>]}
[0m01:29:19.952562 [debug] [MainThread]: Parsing macros/etc.sql
[0m01:29:19.954157 [debug] [MainThread]: Parsing macros/catalog.sql
[0m01:29:19.957500 [debug] [MainThread]: Parsing macros/adapters.sql
[0m01:29:19.967624 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m01:29:19.969098 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m01:29:19.970477 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m01:29:19.974019 [debug] [MainThread]: Parsing macros/materializations/copy.sql
[0m01:29:19.975326 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m01:29:19.983790 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m01:29:19.984579 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m01:29:19.984760 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m01:29:19.985061 [debug] [MainThread]: Parsing macros/utils/timestamps.sql
[0m01:29:19.985553 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m01:29:19.985729 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m01:29:19.985993 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m01:29:19.986291 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m01:29:19.986752 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m01:29:19.987323 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m01:29:19.987560 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m01:29:19.987792 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m01:29:19.988039 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m01:29:19.988275 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m01:29:19.988481 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m01:29:19.989178 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m01:29:19.989421 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m01:29:19.989794 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m01:29:19.990071 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m01:29:19.991277 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m01:29:19.993020 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m01:29:19.994073 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m01:29:19.994831 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m01:29:20.002672 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m01:29:20.009087 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m01:29:20.014917 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m01:29:20.016977 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m01:29:20.017956 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m01:29:20.018848 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m01:29:20.022609 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m01:29:20.030256 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m01:29:20.030958 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m01:29:20.034094 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m01:29:20.038997 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m01:29:20.047783 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m01:29:20.050604 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m01:29:20.052301 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m01:29:20.054881 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m01:29:20.055498 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m01:29:20.057072 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m01:29:20.058116 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m01:29:20.061384 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m01:29:20.070378 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m01:29:20.071109 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m01:29:20.072286 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m01:29:20.073006 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m01:29:20.073430 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m01:29:20.073799 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m01:29:20.074117 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m01:29:20.074745 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m01:29:20.077215 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m01:29:20.081146 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m01:29:20.081527 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m01:29:20.082088 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m01:29:20.082526 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m01:29:20.082954 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m01:29:20.083518 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m01:29:20.083891 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m01:29:20.084379 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m01:29:20.084953 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m01:29:20.086034 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m01:29:20.086603 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m01:29:20.087094 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m01:29:20.087577 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m01:29:20.088044 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m01:29:20.088472 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m01:29:20.088963 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m01:29:20.089383 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m01:29:20.092465 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m01:29:20.092947 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m01:29:20.093368 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m01:29:20.094198 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m01:29:20.095226 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m01:29:20.095711 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m01:29:20.096415 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m01:29:20.096900 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m01:29:20.097876 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m01:29:20.099393 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m01:29:20.100681 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m01:29:20.107869 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m01:29:20.108803 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m01:29:20.115202 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m01:29:20.117229 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m01:29:20.120570 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m01:29:20.125182 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m01:29:20.128064 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m01:29:20.129430 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m01:29:20.130418 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m01:29:20.131623 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m01:29:20.132334 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m01:29:20.134457 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m01:29:20.136437 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m01:29:20.137499 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m01:29:20.139104 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m01:29:20.140074 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m01:29:20.141200 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m01:29:20.142244 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m01:29:20.143235 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m01:29:20.144545 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m01:29:20.145525 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m01:29:20.146351 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m01:29:20.147867 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m01:29:20.149693 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m01:29:20.151452 [debug] [MainThread]: Parsing macros/generic_tests/not_empty_string.sql
[0m01:29:20.152390 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m01:29:20.157226 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m01:29:20.157757 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_relation.sql
[0m01:29:20.158279 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m01:29:20.158827 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m01:29:20.159331 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m01:29:20.160029 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_ephemeral.sql
[0m01:29:20.160946 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m01:29:20.162893 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m01:29:20.163630 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m01:29:20.165275 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m01:29:20.167261 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m01:29:20.168955 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m01:29:20.169767 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m01:29:20.172474 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m01:29:20.175482 [debug] [MainThread]: Parsing macros/sql/safe_divide.sql
[0m01:29:20.175988 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m01:29:20.182437 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m01:29:20.183052 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m01:29:20.184844 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m01:29:20.185547 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m01:29:20.186540 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m01:29:20.187286 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m01:29:20.190549 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m01:29:20.193235 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m01:29:20.195192 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m01:29:20.196453 [debug] [MainThread]: Parsing macros/sql/width_bucket.sql
[0m01:29:20.198979 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m01:29:20.200027 [debug] [MainThread]: Parsing macros/sql/generate_surrogate_key.sql
[0m01:29:20.201210 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m01:29:20.201940 [debug] [MainThread]: Parsing macros/sql/get_single_value.sql
[0m01:29:20.203312 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m01:29:20.389614 [debug] [MainThread]: 1699: static parser successfully parsed stage/stg_referrals.sql
[0m01:29:20.395626 [debug] [MainThread]: 1603: static parser failed on stage/stg_partners.sql
[0m01:29:20.406294 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_partners.sql
[0m01:29:20.469125 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.ggchallengejoao.example
- seeds.getgroundjoao.partners
- seeds.getgroundjoao.referrals

[0m01:29:20.472250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '347568a4-e6e3-42aa-939a-805bd872147d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fb5d0d0>]}
[0m01:29:20.477080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '347568a4-e6e3-42aa-939a-805bd872147d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fb3fe20>]}
[0m01:29:20.477237 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 431 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m01:29:20.477364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '347568a4-e6e3-42aa-939a-805bd872147d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fb8c370>]}
[0m01:29:20.478075 [info ] [MainThread]: 
[0m01:29:20.478418 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m01:29:20.478918 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801"
[0m01:29:20.479046 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:29:22.936773 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801_getgroundjoao"
[0m01:29:22.937270 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:29:23.527776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '347568a4-e6e3-42aa-939a-805bd872147d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f9eaaf0>]}
[0m01:29:23.528851 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:29:23.529173 [info ] [MainThread]: 
[0m01:29:23.535066 [debug] [Thread-1  ]: Began running node seed.ggchallengejoao.partners
[0m01:29:23.535215 [debug] [Thread-2  ]: Began running node seed.ggchallengejoao.referrals
[0m01:29:23.535313 [debug] [Thread-3  ]: Began running node seed.ggchallengejoao.sales_people
[0m01:29:23.535582 [info ] [Thread-1  ]: 1 of 3 START seed file getgroundjoao.partners .................................. [RUN]
[0m01:29:23.535769 [info ] [Thread-2  ]: 2 of 3 START seed file getgroundjoao.referrals ................................. [RUN]
[0m01:29:23.535919 [info ] [Thread-3  ]: 3 of 3 START seed file getgroundjoao.sales_people .............................. [RUN]
[0m01:29:23.536405 [debug] [Thread-1  ]: Acquiring new bigquery connection "seed.ggchallengejoao.partners"
[0m01:29:23.536870 [debug] [Thread-2  ]: Acquiring new bigquery connection "seed.ggchallengejoao.referrals"
[0m01:29:23.537261 [debug] [Thread-3  ]: Acquiring new bigquery connection "seed.ggchallengejoao.sales_people"
[0m01:29:23.537397 [debug] [Thread-1  ]: Began compiling node seed.ggchallengejoao.partners
[0m01:29:23.537502 [debug] [Thread-2  ]: Began compiling node seed.ggchallengejoao.referrals
[0m01:29:23.537596 [debug] [Thread-3  ]: Began compiling node seed.ggchallengejoao.sales_people
[0m01:29:23.537780 [debug] [Thread-1  ]: finished collecting timing info
[0m01:29:23.537905 [debug] [Thread-2  ]: finished collecting timing info
[0m01:29:23.538000 [debug] [Thread-3  ]: finished collecting timing info
[0m01:29:23.538098 [debug] [Thread-1  ]: Began executing node seed.ggchallengejoao.partners
[0m01:29:23.538190 [debug] [Thread-2  ]: Began executing node seed.ggchallengejoao.referrals
[0m01:29:23.538281 [debug] [Thread-3  ]: Began executing node seed.ggchallengejoao.sales_people
[0m01:29:23.610885 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:29:23.645403 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m01:29:23.646580 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m01:29:28.416029 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
LOAD TABLE
[0m01:29:28.417480 [debug] [Thread-1  ]: BigQuery adapter: Runtime Error
  Error while reading data, error message: Could not parse '1.59885646632248E+018' as INT64 for field created_at (position 1) starting at location 57  with message 'Unable to parse'
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 1; errors: 1; max bad: 0; error percent: 0
  Could not parse '1.59885646632248E+018' as INT64 for field created_at (position 1) starting at location 57  with message 'Unable to parse'
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m01:29:28.419081 [debug] [Thread-1  ]: finished collecting timing info
[0m01:29:28.422668 [debug] [Thread-1  ]: Runtime Error in seed partners (seeds/partners.csv)
  Error while reading data, error message: Could not parse '1.59885646632248E+018' as INT64 for field created_at (position 1) starting at location 57  with message 'Unable to parse'
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 1; errors: 1; max bad: 0; error percent: 0
  Could not parse '1.59885646632248E+018' as INT64 for field created_at (position 1) starting at location 57  with message 'Unable to parse'
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m01:29:28.423930 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '347568a4-e6e3-42aa-939a-805bd872147d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1520a1f40>]}
[0m01:29:28.424867 [error] [Thread-1  ]: 1 of 3 ERROR loading seed file getgroundjoao.partners .......................... [[31mERROR[0m in 4.89s]
[0m01:29:28.426467 [debug] [Thread-1  ]: Finished running node seed.ggchallengejoao.partners
[0m01:29:28.797066 [debug] [Thread-2  ]: BigQuery adapter: Unhandled error while running:
LOAD TABLE
[0m01:29:28.798460 [debug] [Thread-2  ]: BigQuery adapter: Runtime Error
  Error while reading data, error message: Could not parse '1.59895591837478E+018' as INT64 for field created_at (position 1) starting at location 80  with message 'Unable to parse'
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 1; errors: 1; max bad: 0; error percent: 0
  Could not parse '1.59895591837478E+018' as INT64 for field created_at (position 1) starting at location 80  with message 'Unable to parse'
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m01:29:28.801451 [debug] [Thread-2  ]: finished collecting timing info
[0m01:29:28.803803 [debug] [Thread-2  ]: Runtime Error in seed referrals (seeds/referrals.csv)
  Error while reading data, error message: Could not parse '1.59895591837478E+018' as INT64 for field created_at (position 1) starting at location 80  with message 'Unable to parse'
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 1; errors: 1; max bad: 0; error percent: 0
  Could not parse '1.59895591837478E+018' as INT64 for field created_at (position 1) starting at location 80  with message 'Unable to parse'
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m01:29:28.804411 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '347568a4-e6e3-42aa-939a-805bd872147d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1520a1d30>]}
[0m01:29:28.804866 [error] [Thread-2  ]: 2 of 3 ERROR loading seed file getgroundjoao.referrals ......................... [[31mERROR[0m in 5.27s]
[0m01:29:28.805829 [debug] [Thread-2  ]: Finished running node seed.ggchallengejoao.referrals
[0m01:29:29.784593 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.ggchallengejoao.sales_people"
[0m01:29:29.804947 [debug] [Thread-3  ]: finished collecting timing info
[0m01:29:29.805678 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '347568a4-e6e3-42aa-939a-805bd872147d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fe5ae50>]}
[0m01:29:29.806021 [info ] [Thread-3  ]: 3 of 3 OK loaded seed file getgroundjoao.sales_people .......................... [[32mINSERT 12[0m in 6.27s]
[0m01:29:29.806442 [debug] [Thread-3  ]: Finished running node seed.ggchallengejoao.sales_people
[0m01:29:29.808185 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m01:29:29.808811 [info ] [MainThread]: 
[0m01:29:29.809083 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 9.33 seconds (9.33s).
[0m01:29:29.809291 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:29:29.809403 [debug] [MainThread]: Connection 'seed.ggchallengejoao.partners' was properly closed.
[0m01:29:29.809509 [debug] [MainThread]: Connection 'seed.ggchallengejoao.referrals' was properly closed.
[0m01:29:29.809612 [debug] [MainThread]: Connection 'seed.ggchallengejoao.sales_people' was properly closed.
[0m01:29:29.820237 [info ] [MainThread]: 
[0m01:29:29.820552 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m01:29:29.820775 [info ] [MainThread]: 
[0m01:29:29.822591 [error] [MainThread]: [33mRuntime Error in seed partners (seeds/partners.csv)[0m
[0m01:29:29.822789 [error] [MainThread]:   Error while reading data, error message: Could not parse '1.59885646632248E+018' as INT64 for field created_at (position 1) starting at location 57  with message 'Unable to parse'
[0m01:29:29.822960 [error] [MainThread]:   Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 1; errors: 1; max bad: 0; error percent: 0
[0m01:29:29.823122 [error] [MainThread]:   Could not parse '1.59885646632248E+018' as INT64 for field created_at (position 1) starting at location 57  with message 'Unable to parse'
[0m01:29:29.823283 [error] [MainThread]:   You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m01:29:29.823458 [info ] [MainThread]: 
[0m01:29:29.823623 [error] [MainThread]: [33mRuntime Error in seed referrals (seeds/referrals.csv)[0m
[0m01:29:29.823786 [error] [MainThread]:   Error while reading data, error message: Could not parse '1.59895591837478E+018' as INT64 for field created_at (position 1) starting at location 80  with message 'Unable to parse'
[0m01:29:29.823946 [error] [MainThread]:   Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 1; errors: 1; max bad: 0; error percent: 0
[0m01:29:29.824104 [error] [MainThread]:   Could not parse '1.59895591837478E+018' as INT64 for field created_at (position 1) starting at location 80  with message 'Unable to parse'
[0m01:29:29.824263 [error] [MainThread]:   You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m01:29:29.824435 [info ] [MainThread]: 
[0m01:29:29.824620 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m01:29:29.825026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fe38af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1520a5ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1520a1280>]}
[0m01:29:29.825252 [debug] [MainThread]: Flushing usage events


============================== 2023-01-06 01:31:50.250912 | 432a353f-61e7-42ae-9542-77fada03c750 ==============================
[0m01:31:50.250929 [info ] [MainThread]: Running with dbt=1.3.2
[0m01:31:50.251633 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joaopaulomedeiroscecilio/dev/dbt-data-analysis', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
[0m01:31:50.251757 [debug] [MainThread]: Tracking: tracking
[0m01:31:50.281345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fa00d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fa00e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fa00e50>]}
[0m01:31:50.332099 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:31:50.332253 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:31:50.332532 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.ggchallengejoao.example
- seeds.getgroundjoao.referrals
- seeds.getgroundjoao.partners

[0m01:31:50.335941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '432a353f-61e7-42ae-9542-77fada03c750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fc170d0>]}
[0m01:31:50.343638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '432a353f-61e7-42ae-9542-77fada03c750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fb1c730>]}
[0m01:31:50.343876 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 431 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m01:31:50.344028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '432a353f-61e7-42ae-9542-77fada03c750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fb1c610>]}
[0m01:31:50.344818 [info ] [MainThread]: 
[0m01:31:50.345172 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m01:31:50.345681 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801"
[0m01:31:50.345811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:31:52.323035 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801_getgroundjoao"
[0m01:31:52.323475 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:31:52.779989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '432a353f-61e7-42ae-9542-77fada03c750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fbdef10>]}
[0m01:31:52.781263 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:31:52.781554 [info ] [MainThread]: 
[0m01:31:52.787780 [debug] [Thread-1  ]: Began running node seed.ggchallengejoao.partners
[0m01:31:52.787974 [debug] [Thread-2  ]: Began running node seed.ggchallengejoao.referrals
[0m01:31:52.788118 [debug] [Thread-3  ]: Began running node seed.ggchallengejoao.sales_people
[0m01:31:52.788457 [info ] [Thread-1  ]: 1 of 3 START seed file getgroundjoao.partners .................................. [RUN]
[0m01:31:52.788685 [info ] [Thread-2  ]: 2 of 3 START seed file getgroundjoao.referrals ................................. [RUN]
[0m01:31:52.788883 [info ] [Thread-3  ]: 3 of 3 START seed file getgroundjoao.sales_people .............................. [RUN]
[0m01:31:52.789516 [debug] [Thread-1  ]: Acquiring new bigquery connection "seed.ggchallengejoao.partners"
[0m01:31:52.790041 [debug] [Thread-2  ]: Acquiring new bigquery connection "seed.ggchallengejoao.referrals"
[0m01:31:52.790505 [debug] [Thread-3  ]: Acquiring new bigquery connection "seed.ggchallengejoao.sales_people"
[0m01:31:52.790701 [debug] [Thread-1  ]: Began compiling node seed.ggchallengejoao.partners
[0m01:31:52.790855 [debug] [Thread-2  ]: Began compiling node seed.ggchallengejoao.referrals
[0m01:31:52.790999 [debug] [Thread-3  ]: Began compiling node seed.ggchallengejoao.sales_people
[0m01:31:52.791216 [debug] [Thread-1  ]: finished collecting timing info
[0m01:31:52.791315 [debug] [Thread-2  ]: finished collecting timing info
[0m01:31:52.791550 [debug] [Thread-3  ]: finished collecting timing info
[0m01:31:52.791909 [debug] [Thread-1  ]: Began executing node seed.ggchallengejoao.partners
[0m01:31:52.792033 [debug] [Thread-2  ]: Began executing node seed.ggchallengejoao.referrals
[0m01:31:52.792147 [debug] [Thread-3  ]: Began executing node seed.ggchallengejoao.sales_people
[0m01:31:52.852333 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m01:31:52.872610 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:31:52.919348 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m01:31:57.698448 [debug] [Thread-2  ]: BigQuery adapter: Unhandled error while running:
LOAD TABLE
[0m01:31:57.702697 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.ggchallengejoao.sales_people"
[0m01:31:57.702983 [debug] [Thread-2  ]: BigQuery adapter: Runtime Error
  Error while reading data, error message: Could not parse '1.59895591837478E+018' as INT64 for field created_at (position 1) starting at location 80  with message 'Unable to parse'
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 1; errors: 1; max bad: 0; error percent: 0
  Could not parse '1.59895591837478E+018' as INT64 for field created_at (position 1) starting at location 80  with message 'Unable to parse'
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m01:31:57.703365 [debug] [Thread-2  ]: finished collecting timing info
[0m01:31:57.703782 [debug] [Thread-2  ]: Runtime Error in seed referrals (seeds/referrals.csv)
  Error while reading data, error message: Could not parse '1.59895591837478E+018' as INT64 for field created_at (position 1) starting at location 80  with message 'Unable to parse'
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 1; errors: 1; max bad: 0; error percent: 0
  Could not parse '1.59895591837478E+018' as INT64 for field created_at (position 1) starting at location 80  with message 'Unable to parse'
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m01:31:57.713310 [debug] [Thread-3  ]: finished collecting timing info
[0m01:31:57.713596 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '432a353f-61e7-42ae-9542-77fada03c750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fdd1580>]}
[0m01:31:57.713959 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '432a353f-61e7-42ae-9542-77fada03c750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fd66670>]}
[0m01:31:57.714205 [error] [Thread-2  ]: 2 of 3 ERROR loading seed file getgroundjoao.referrals ......................... [[31mERROR[0m in 4.92s]
[0m01:31:57.714403 [info ] [Thread-3  ]: 3 of 3 OK loaded seed file getgroundjoao.sales_people .......................... [[32mINSERT 12[0m in 4.92s]
[0m01:31:57.714781 [debug] [Thread-2  ]: Finished running node seed.ggchallengejoao.referrals
[0m01:31:57.715053 [debug] [Thread-3  ]: Finished running node seed.ggchallengejoao.sales_people
[0m01:31:59.009613 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
LOAD TABLE
[0m01:31:59.010140 [debug] [Thread-1  ]: BigQuery adapter: Runtime Error
  Error while reading data, error message: Could not parse '1.59885646632248E+018' as INT64 for field created_at (position 1) starting at location 57  with message 'Unable to parse'
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 1; errors: 1; max bad: 0; error percent: 0
  Could not parse '1.59885646632248E+018' as INT64 for field created_at (position 1) starting at location 57  with message 'Unable to parse'
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m01:31:59.011709 [debug] [Thread-1  ]: finished collecting timing info
[0m01:31:59.013860 [debug] [Thread-1  ]: Runtime Error in seed partners (seeds/partners.csv)
  Error while reading data, error message: Could not parse '1.59885646632248E+018' as INT64 for field created_at (position 1) starting at location 57  with message 'Unable to parse'
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 1; errors: 1; max bad: 0; error percent: 0
  Could not parse '1.59885646632248E+018' as INT64 for field created_at (position 1) starting at location 57  with message 'Unable to parse'
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m01:31:59.014454 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '432a353f-61e7-42ae-9542-77fada03c750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fdd19d0>]}
[0m01:31:59.014876 [error] [Thread-1  ]: 1 of 3 ERROR loading seed file getgroundjoao.partners .......................... [[31mERROR[0m in 6.23s]
[0m01:31:59.015551 [debug] [Thread-1  ]: Finished running node seed.ggchallengejoao.partners
[0m01:31:59.017897 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m01:31:59.018963 [info ] [MainThread]: 
[0m01:31:59.019451 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 8.67 seconds (8.67s).
[0m01:31:59.019861 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:31:59.020122 [debug] [MainThread]: Connection 'seed.ggchallengejoao.partners' was properly closed.
[0m01:31:59.020342 [debug] [MainThread]: Connection 'seed.ggchallengejoao.referrals' was properly closed.
[0m01:31:59.020530 [debug] [MainThread]: Connection 'seed.ggchallengejoao.sales_people' was properly closed.
[0m01:31:59.033200 [info ] [MainThread]: 
[0m01:31:59.033832 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m01:31:59.034510 [info ] [MainThread]: 
[0m01:31:59.034726 [error] [MainThread]: [33mRuntime Error in seed referrals (seeds/referrals.csv)[0m
[0m01:31:59.035055 [error] [MainThread]:   Error while reading data, error message: Could not parse '1.59895591837478E+018' as INT64 for field created_at (position 1) starting at location 80  with message 'Unable to parse'
[0m01:31:59.035766 [error] [MainThread]:   Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 1; errors: 1; max bad: 0; error percent: 0
[0m01:31:59.035980 [error] [MainThread]:   Could not parse '1.59895591837478E+018' as INT64 for field created_at (position 1) starting at location 80  with message 'Unable to parse'
[0m01:31:59.036114 [error] [MainThread]:   You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m01:31:59.036235 [info ] [MainThread]: 
[0m01:31:59.036352 [error] [MainThread]: [33mRuntime Error in seed partners (seeds/partners.csv)[0m
[0m01:31:59.036466 [error] [MainThread]:   Error while reading data, error message: Could not parse '1.59885646632248E+018' as INT64 for field created_at (position 1) starting at location 57  with message 'Unable to parse'
[0m01:31:59.036575 [error] [MainThread]:   Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 1; errors: 1; max bad: 0; error percent: 0
[0m01:31:59.036683 [error] [MainThread]:   Could not parse '1.59885646632248E+018' as INT64 for field created_at (position 1) starting at location 57  with message 'Unable to parse'
[0m01:31:59.036790 [error] [MainThread]:   You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m01:31:59.036904 [info ] [MainThread]: 
[0m01:31:59.037043 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m01:31:59.039109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fcb8310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fcb8a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fcb81c0>]}
[0m01:31:59.039647 [debug] [MainThread]: Flushing usage events


============================== 2023-01-06 01:32:34.079943 | 0d56df13-69bf-4976-96b7-26fc2dbacb9d ==============================
[0m01:32:34.079977 [info ] [MainThread]: Running with dbt=1.3.2
[0m01:32:34.081188 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joaopaulomedeiroscecilio/dev/dbt-data-analysis', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
[0m01:32:34.081319 [debug] [MainThread]: Tracking: tracking
[0m01:32:34.092134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122b3ed60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122b3ee80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122b3eeb0>]}
[0m01:32:34.116147 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m01:32:34.116417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0d56df13-69bf-4976-96b7-26fc2dbacb9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122b3ee50>]}
[0m01:32:34.141979 [debug] [MainThread]: Parsing macros/etc.sql
[0m01:32:34.143762 [debug] [MainThread]: Parsing macros/catalog.sql
[0m01:32:34.147339 [debug] [MainThread]: Parsing macros/adapters.sql
[0m01:32:34.158140 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m01:32:34.159391 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m01:32:34.160681 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m01:32:34.164255 [debug] [MainThread]: Parsing macros/materializations/copy.sql
[0m01:32:34.165659 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m01:32:34.174307 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m01:32:34.175105 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m01:32:34.175295 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m01:32:34.175594 [debug] [MainThread]: Parsing macros/utils/timestamps.sql
[0m01:32:34.176092 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m01:32:34.176262 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m01:32:34.176520 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m01:32:34.176820 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m01:32:34.177280 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m01:32:34.177846 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m01:32:34.178083 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m01:32:34.178310 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m01:32:34.178558 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m01:32:34.178792 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m01:32:34.178995 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m01:32:34.179710 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m01:32:34.179962 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m01:32:34.180351 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m01:32:34.180643 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m01:32:34.181842 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m01:32:34.183595 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m01:32:34.184636 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m01:32:34.185392 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m01:32:34.192997 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m01:32:34.199432 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m01:32:34.205243 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m01:32:34.207300 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m01:32:34.208112 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m01:32:34.208928 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m01:32:34.212638 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m01:32:34.220272 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m01:32:34.220970 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m01:32:34.224066 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m01:32:34.228949 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m01:32:34.237275 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m01:32:34.239823 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m01:32:34.241402 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m01:32:34.243910 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m01:32:34.244494 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m01:32:34.246018 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m01:32:34.247040 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m01:32:34.250267 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m01:32:34.258971 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m01:32:34.259649 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m01:32:34.260785 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m01:32:34.261501 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m01:32:34.261913 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m01:32:34.262294 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m01:32:34.262609 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m01:32:34.263242 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m01:32:34.265687 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m01:32:34.269600 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m01:32:34.269975 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m01:32:34.270530 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m01:32:34.270973 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m01:32:34.271402 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m01:32:34.271966 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m01:32:34.272336 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m01:32:34.272802 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m01:32:34.273358 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m01:32:34.274422 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m01:32:34.274979 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m01:32:34.275471 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m01:32:34.275954 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m01:32:34.276430 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m01:32:34.276857 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m01:32:34.277351 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m01:32:34.277763 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m01:32:34.280942 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m01:32:34.281429 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m01:32:34.281962 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m01:32:34.282833 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m01:32:34.283903 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m01:32:34.284393 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m01:32:34.285093 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m01:32:34.285585 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m01:32:34.286562 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m01:32:34.288078 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m01:32:34.289360 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m01:32:34.296299 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m01:32:34.297213 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m01:32:34.303565 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m01:32:34.305583 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m01:32:34.308897 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m01:32:34.313465 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m01:32:34.316347 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m01:32:34.317698 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m01:32:34.318655 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m01:32:34.319859 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m01:32:34.320568 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m01:32:34.322687 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m01:32:34.324666 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m01:32:34.325712 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m01:32:34.327319 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m01:32:34.328289 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m01:32:34.329419 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m01:32:34.330459 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m01:32:34.331498 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m01:32:34.332854 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m01:32:34.333824 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m01:32:34.334654 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m01:32:34.336155 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m01:32:34.337975 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m01:32:34.339630 [debug] [MainThread]: Parsing macros/generic_tests/not_empty_string.sql
[0m01:32:34.340477 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m01:32:34.345164 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m01:32:34.345681 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_relation.sql
[0m01:32:34.346189 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m01:32:34.346728 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m01:32:34.347218 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m01:32:34.347903 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_ephemeral.sql
[0m01:32:34.348788 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m01:32:34.350700 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m01:32:34.351405 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m01:32:34.353010 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m01:32:34.354965 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m01:32:34.356538 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m01:32:34.357299 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m01:32:34.359966 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m01:32:34.362944 [debug] [MainThread]: Parsing macros/sql/safe_divide.sql
[0m01:32:34.363452 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m01:32:34.369877 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m01:32:34.370490 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m01:32:34.372231 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m01:32:34.372912 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m01:32:34.373899 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m01:32:34.374639 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m01:32:34.378025 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m01:32:34.380667 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m01:32:34.382711 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m01:32:34.384034 [debug] [MainThread]: Parsing macros/sql/width_bucket.sql
[0m01:32:34.386615 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m01:32:34.387677 [debug] [MainThread]: Parsing macros/sql/generate_surrogate_key.sql
[0m01:32:34.388872 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m01:32:34.389616 [debug] [MainThread]: Parsing macros/sql/get_single_value.sql
[0m01:32:34.390999 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m01:32:34.574677 [debug] [MainThread]: 1699: static parser successfully parsed stage/stg_referrals.sql
[0m01:32:34.580534 [debug] [MainThread]: 1603: static parser failed on stage/stg_partners.sql
[0m01:32:34.591389 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_partners.sql
[0m01:32:34.653988 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ggchallengejoao.example

[0m01:32:34.656970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d56df13-69bf-4976-96b7-26fc2dbacb9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122dfdf70>]}
[0m01:32:34.662126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d56df13-69bf-4976-96b7-26fc2dbacb9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122b714f0>]}
[0m01:32:34.662303 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 431 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m01:32:34.662444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d56df13-69bf-4976-96b7-26fc2dbacb9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122d01880>]}
[0m01:32:34.663155 [info ] [MainThread]: 
[0m01:32:34.663481 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m01:32:34.664004 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801"
[0m01:32:34.664149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:32:36.528615 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801_getgroundjoao"
[0m01:32:36.528888 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:32:37.094424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d56df13-69bf-4976-96b7-26fc2dbacb9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103192130>]}
[0m01:32:37.095706 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:32:37.096173 [info ] [MainThread]: 
[0m01:32:37.103145 [debug] [Thread-1  ]: Began running node seed.ggchallengejoao.partners
[0m01:32:37.103391 [debug] [Thread-2  ]: Began running node seed.ggchallengejoao.referrals
[0m01:32:37.103594 [debug] [Thread-3  ]: Began running node seed.ggchallengejoao.sales_people
[0m01:32:37.104069 [info ] [Thread-1  ]: 1 of 3 START seed file getgroundjoao.partners .................................. [RUN]
[0m01:32:37.104460 [info ] [Thread-2  ]: 2 of 3 START seed file getgroundjoao.referrals ................................. [RUN]
[0m01:32:37.104785 [info ] [Thread-3  ]: 3 of 3 START seed file getgroundjoao.sales_people .............................. [RUN]
[0m01:32:37.105648 [debug] [Thread-1  ]: Acquiring new bigquery connection "seed.ggchallengejoao.partners"
[0m01:32:37.106407 [debug] [Thread-2  ]: Acquiring new bigquery connection "seed.ggchallengejoao.referrals"
[0m01:32:37.107207 [debug] [Thread-3  ]: Acquiring new bigquery connection "seed.ggchallengejoao.sales_people"
[0m01:32:37.107473 [debug] [Thread-1  ]: Began compiling node seed.ggchallengejoao.partners
[0m01:32:37.107672 [debug] [Thread-2  ]: Began compiling node seed.ggchallengejoao.referrals
[0m01:32:37.107852 [debug] [Thread-3  ]: Began compiling node seed.ggchallengejoao.sales_people
[0m01:32:37.108077 [debug] [Thread-1  ]: finished collecting timing info
[0m01:32:37.108257 [debug] [Thread-2  ]: finished collecting timing info
[0m01:32:37.108432 [debug] [Thread-3  ]: finished collecting timing info
[0m01:32:37.108614 [debug] [Thread-1  ]: Began executing node seed.ggchallengejoao.partners
[0m01:32:37.108788 [debug] [Thread-2  ]: Began executing node seed.ggchallengejoao.referrals
[0m01:32:37.108957 [debug] [Thread-3  ]: Began executing node seed.ggchallengejoao.sales_people
[0m01:32:37.176496 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m01:32:37.213501 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:32:37.233152 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m01:32:42.078194 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.ggchallengejoao.partners"
[0m01:32:42.103928 [debug] [Thread-1  ]: finished collecting timing info
[0m01:32:42.104744 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d56df13-69bf-4976-96b7-26fc2dbacb9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122e83d60>]}
[0m01:32:42.105103 [info ] [Thread-1  ]: 1 of 3 OK loaded seed file getgroundjoao.partners .............................. [[32mINSERT 522[0m in 5.00s]
[0m01:32:42.105628 [debug] [Thread-1  ]: Finished running node seed.ggchallengejoao.partners
[0m01:32:42.182436 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.ggchallengejoao.referrals"
[0m01:32:42.184584 [debug] [Thread-2  ]: finished collecting timing info
[0m01:32:42.185057 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d56df13-69bf-4976-96b7-26fc2dbacb9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122eaf040>]}
[0m01:32:42.185277 [info ] [Thread-2  ]: 2 of 3 OK loaded seed file getgroundjoao.referrals ............................. [[32mINSERT 1470[0m in 5.08s]
[0m01:32:42.185606 [debug] [Thread-2  ]: Finished running node seed.ggchallengejoao.referrals
[0m01:32:42.743601 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.ggchallengejoao.sales_people"
[0m01:32:42.748411 [debug] [Thread-3  ]: finished collecting timing info
[0m01:32:42.749244 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d56df13-69bf-4976-96b7-26fc2dbacb9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122eeaeb0>]}
[0m01:32:42.749645 [info ] [Thread-3  ]: 3 of 3 OK loaded seed file getgroundjoao.sales_people .......................... [[32mINSERT 12[0m in 5.64s]
[0m01:32:42.749953 [debug] [Thread-3  ]: Finished running node seed.ggchallengejoao.sales_people
[0m01:32:42.750969 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m01:32:42.751300 [info ] [MainThread]: 
[0m01:32:42.751443 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 8.09 seconds (8.09s).
[0m01:32:42.751570 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:32:42.751637 [debug] [MainThread]: Connection 'seed.ggchallengejoao.partners' was properly closed.
[0m01:32:42.751701 [debug] [MainThread]: Connection 'seed.ggchallengejoao.referrals' was properly closed.
[0m01:32:42.751763 [debug] [MainThread]: Connection 'seed.ggchallengejoao.sales_people' was properly closed.
[0m01:32:42.756988 [info ] [MainThread]: 
[0m01:32:42.757139 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:32:42.757274 [info ] [MainThread]: 
[0m01:32:42.757401 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m01:32:42.757613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122bab6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122babc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122b9d2b0>]}
[0m01:32:42.757736 [debug] [MainThread]: Flushing usage events


============================== 2023-01-06 01:51:05.691760 | ed114cca-6b9e-4bd2-9b1c-88a77d277eb3 ==============================
[0m01:51:05.691789 [info ] [MainThread]: Running with dbt=1.3.2
[0m01:51:05.692502 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joaopaulomedeiroscecilio/dev/dbt-data-analysis', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m01:51:05.692605 [debug] [MainThread]: Tracking: tracking
[0m01:51:05.707810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126bfed60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126bfee80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126bfeeb0>]}
[0m01:51:05.758263 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m01:51:05.758514 [debug] [MainThread]: Partial parsing: updated file: ggchallengejoao://models/stage/stg_partners.sql
[0m01:51:05.758667 [debug] [MainThread]: Partial parsing: updated file: ggchallengejoao://models/stage/stg_referrals.sql
[0m01:51:05.767559 [debug] [MainThread]: 1699: static parser successfully parsed stage/stg_partners.sql
[0m01:51:05.773732 [debug] [MainThread]: 1699: static parser successfully parsed stage/stg_referrals.sql
[0m01:51:05.804132 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ggchallengejoao.example

[0m01:51:05.807215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed114cca-6b9e-4bd2-9b1c-88a77d277eb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126ffb0d0>]}
[0m01:51:05.814274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed114cca-6b9e-4bd2-9b1c-88a77d277eb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126ebc520>]}
[0m01:51:05.814561 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 431 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m01:51:05.814722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed114cca-6b9e-4bd2-9b1c-88a77d277eb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126ebc550>]}
[0m01:51:05.815592 [info ] [MainThread]: 
[0m01:51:05.816035 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m01:51:05.816586 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801"
[0m01:51:05.816758 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:51:07.836302 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801_getgroundjoao"
[0m01:51:07.837157 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:51:08.574333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed114cca-6b9e-4bd2-9b1c-88a77d277eb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126e510a0>]}
[0m01:51:08.576966 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:51:08.577811 [info ] [MainThread]: 
[0m01:51:08.587392 [debug] [Thread-1  ]: Began running node model.ggchallengejoao.stg_partners
[0m01:51:08.587662 [debug] [Thread-2  ]: Began running node model.ggchallengejoao.stg_referrals
[0m01:51:08.588123 [info ] [Thread-1  ]: 1 of 2 START sql table model getgroundjoao.stg_partners ........................ [RUN]
[0m01:51:08.588460 [info ] [Thread-2  ]: 2 of 2 START sql table model getgroundjoao.stg_referrals ....................... [RUN]
[0m01:51:08.589298 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_partners"
[0m01:51:08.590139 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_referrals"
[0m01:51:08.590362 [debug] [Thread-1  ]: Began compiling node model.ggchallengejoao.stg_partners
[0m01:51:08.590605 [debug] [Thread-2  ]: Began compiling node model.ggchallengejoao.stg_referrals
[0m01:51:08.590979 [debug] [Thread-1  ]: Compiling model.ggchallengejoao.stg_partners
[0m01:51:08.591164 [debug] [Thread-2  ]: Compiling model.ggchallengejoao.stg_referrals
[0m01:51:08.597711 [debug] [Thread-1  ]: Writing injected SQL for node "model.ggchallengejoao.stg_partners"
[0m01:51:08.601836 [debug] [Thread-2  ]: Writing injected SQL for node "model.ggchallengejoao.stg_referrals"
[0m01:51:08.603480 [debug] [Thread-1  ]: finished collecting timing info
[0m01:51:08.603641 [debug] [Thread-2  ]: finished collecting timing info
[0m01:51:08.603863 [debug] [Thread-1  ]: Began executing node model.ggchallengejoao.stg_partners
[0m01:51:08.604119 [debug] [Thread-2  ]: Began executing node model.ggchallengejoao.stg_referrals
[0m01:51:08.656469 [debug] [Thread-1  ]: Writing runtime sql for node "model.ggchallengejoao.stg_partners"
[0m01:51:08.656773 [debug] [Thread-2  ]: Writing runtime sql for node "model.ggchallengejoao.stg_referrals"
[0m01:51:08.657440 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:51:08.657539 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m01:51:08.657704 [debug] [Thread-1  ]: On model.ggchallengejoao.stg_partners: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.stg_partners"} */

  
    

    create or replace table `dynamic-point-367801`.`getgroundjoao`.`stg_partners`
    
    
    OPTIONS()
    as (
      

select *
except
    (lead_sales_contact),
    if(
        p.lead_sales_contact = '0', 'No contact', p.lead_sales_contact
    ) as lead_sales_contact,
    timestamp_micros(
        cast(p.created_at / 1000 as int64)
    ) as partner_created_at_timestamp,
    timestamp_micros(cast(p.updated_at / 1000 as int64)) as partner_updated_at_timestamp
from `dynamic-point-367801`.`getgroundjoao`.`partners` p
    );
  
[0m01:51:08.657815 [debug] [Thread-2  ]: On model.ggchallengejoao.stg_referrals: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.stg_referrals"} */

  
    

    create or replace table `dynamic-point-367801`.`getgroundjoao`.`stg_referrals`
    
    
    OPTIONS()
    as (
      

select
    r.*,
    timestamp_micros(
        cast(r.created_at / 1000 as int64)
    ) as referral_created_at_timestamp,
    timestamp_micros(
        cast(r.updated_at / 1000 as int64)
    ) as referral_updated_at_timestamp
from `dynamic-point-367801`.`getgroundjoao`.`referrals` r
    );
  
[0m01:51:12.148362 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:c4d5678a-32a4-4e14-aa57-90a025e3478a:EU&page=queryresults
[0m01:51:12.157421 [debug] [Thread-2  ]: finished collecting timing info
[0m01:51:12.157844 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed114cca-6b9e-4bd2-9b1c-88a77d277eb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12708e0a0>]}
[0m01:51:12.158127 [info ] [Thread-2  ]: 2 of 2 OK created sql table model getgroundjoao.stg_referrals .................. [[32mCREATE TABLE (1.5k rows, 96.2 KB processed)[0m in 3.57s]
[0m01:51:12.158411 [debug] [Thread-2  ]: Finished running node model.ggchallengejoao.stg_referrals
[0m01:51:12.176179 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:cd9cc955-b084-4fab-af18-e12de789a896:EU&page=queryresults
[0m01:51:12.177200 [debug] [Thread-1  ]: finished collecting timing info
[0m01:51:12.177575 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed114cca-6b9e-4bd2-9b1c-88a77d277eb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1270f1ee0>]}
[0m01:51:12.177827 [info ] [Thread-1  ]: 1 of 2 OK created sql table model getgroundjoao.stg_partners ................... [[32mCREATE TABLE (522.0 rows, 19.5 KB processed)[0m in 3.59s]
[0m01:51:12.178231 [debug] [Thread-1  ]: Finished running node model.ggchallengejoao.stg_partners
[0m01:51:12.180012 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m01:51:12.180496 [info ] [MainThread]: 
[0m01:51:12.180698 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 6.36 seconds (6.36s).
[0m01:51:12.180838 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:51:12.180982 [debug] [MainThread]: Connection 'model.ggchallengejoao.stg_partners' was properly closed.
[0m01:51:12.181061 [debug] [MainThread]: Connection 'model.ggchallengejoao.stg_referrals' was properly closed.
[0m01:51:12.192212 [info ] [MainThread]: 
[0m01:51:12.192440 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:51:12.192594 [info ] [MainThread]: 
[0m01:51:12.192724 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m01:51:12.193174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126f6dc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126d1ba30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126f0d790>]}
[0m01:51:12.193458 [debug] [MainThread]: Flushing usage events


============================== 2023-01-06 01:51:53.037024 | 1e1d2ebf-7267-4ce0-aae2-0a2b74acdd57 ==============================
[0m01:51:53.037039 [info ] [MainThread]: Running with dbt=1.3.2
[0m01:51:53.037569 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joaopaulomedeiroscecilio/dev/dbt-data-analysis', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m01:51:53.037675 [debug] [MainThread]: Tracking: tracking
[0m01:51:53.052781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fbbed30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fbbee50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fbbee80>]}
[0m01:51:53.105423 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:51:53.105586 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:51:53.105861 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ggchallengejoao.example

[0m01:51:53.109360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e1d2ebf-7267-4ce0-aae2-0a2b74acdd57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fdd59a0>]}
[0m01:51:53.116172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e1d2ebf-7267-4ce0-aae2-0a2b74acdd57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fcd87c0>]}
[0m01:51:53.116396 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 431 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m01:51:53.116541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e1d2ebf-7267-4ce0-aae2-0a2b74acdd57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fcd86a0>]}
[0m01:51:53.117393 [info ] [MainThread]: 
[0m01:51:53.117768 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m01:51:53.118410 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801_getgroundjoao"
[0m01:51:53.118539 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:51:55.465224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e1d2ebf-7267-4ce0-aae2-0a2b74acdd57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fd9ef40>]}
[0m01:51:55.467533 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:51:55.468277 [info ] [MainThread]: 
[0m01:51:55.475905 [debug] [Thread-1  ]: Began running node test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__0__1.95c6a4ff4f
[0m01:51:55.476189 [debug] [Thread-2  ]: Began running node test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53
[0m01:51:55.476404 [debug] [Thread-3  ]: Began running node test.ggchallengejoao.not_null_stg_referrals_id.f511791502
[0m01:51:55.476636 [debug] [Thread-4  ]: Began running node test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f
[0m01:51:55.476837 [info ] [Thread-1  ]: 1 of 4 START test accepted_values_stg_referrals_is_outbound__0__1 .............. [RUN]
[0m01:51:55.477144 [info ] [Thread-2  ]: 2 of 4 START test accepted_values_stg_referrals_status__disinterested__pending__successful  [RUN]
[0m01:51:55.477398 [info ] [Thread-3  ]: 3 of 4 START test not_null_stg_referrals_id .................................... [RUN]
[0m01:51:55.477652 [info ] [Thread-4  ]: 4 of 4 START test unique_stg_referrals_id ...................................... [RUN]
[0m01:51:55.478677 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__0__1.95c6a4ff4f"
[0m01:51:55.479422 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53"
[0m01:51:55.480133 [debug] [Thread-3  ]: Acquiring new bigquery connection "test.ggchallengejoao.not_null_stg_referrals_id.f511791502"
[0m01:51:55.480818 [debug] [Thread-4  ]: Acquiring new bigquery connection "test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f"
[0m01:51:55.481033 [debug] [Thread-1  ]: Began compiling node test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__0__1.95c6a4ff4f
[0m01:51:55.481235 [debug] [Thread-2  ]: Began compiling node test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53
[0m01:51:55.481415 [debug] [Thread-3  ]: Began compiling node test.ggchallengejoao.not_null_stg_referrals_id.f511791502
[0m01:51:55.481592 [debug] [Thread-4  ]: Began compiling node test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f
[0m01:51:55.481849 [debug] [Thread-1  ]: Compiling test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__0__1.95c6a4ff4f
[0m01:51:55.482023 [debug] [Thread-2  ]: Compiling test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53
[0m01:51:55.482205 [debug] [Thread-3  ]: Compiling test.ggchallengejoao.not_null_stg_referrals_id.f511791502
[0m01:51:55.482384 [debug] [Thread-4  ]: Compiling test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f
[0m01:51:55.499055 [debug] [Thread-1  ]: Writing injected SQL for node "test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__0__1.95c6a4ff4f"
[0m01:51:55.506153 [debug] [Thread-2  ]: Writing injected SQL for node "test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53"
[0m01:51:55.516794 [debug] [Thread-4  ]: Writing injected SQL for node "test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f"
[0m01:51:55.525761 [debug] [Thread-3  ]: Writing injected SQL for node "test.ggchallengejoao.not_null_stg_referrals_id.f511791502"
[0m01:51:55.526117 [debug] [Thread-2  ]: finished collecting timing info
[0m01:51:55.526279 [debug] [Thread-1  ]: finished collecting timing info
[0m01:51:55.526425 [debug] [Thread-4  ]: finished collecting timing info
[0m01:51:55.526579 [debug] [Thread-2  ]: Began executing node test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53
[0m01:51:55.526668 [debug] [Thread-3  ]: finished collecting timing info
[0m01:51:55.526778 [debug] [Thread-1  ]: Began executing node test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__0__1.95c6a4ff4f
[0m01:51:55.526892 [debug] [Thread-4  ]: Began executing node test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f
[0m01:51:55.539806 [debug] [Thread-2  ]: Writing runtime sql for node "test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53"
[0m01:51:55.539958 [debug] [Thread-3  ]: Began executing node test.ggchallengejoao.not_null_stg_referrals_id.f511791502
[0m01:51:55.541584 [debug] [Thread-1  ]: Writing runtime sql for node "test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__0__1.95c6a4ff4f"
[0m01:51:55.542986 [debug] [Thread-4  ]: Writing runtime sql for node "test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f"
[0m01:51:55.544511 [debug] [Thread-3  ]: Writing runtime sql for node "test.ggchallengejoao.not_null_stg_referrals_id.f511791502"
[0m01:51:55.544828 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m01:51:55.545011 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:51:55.545124 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m01:51:55.545284 [debug] [Thread-2  ]: On test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from `dynamic-point-367801`.`getgroundjoao`.`stg_referrals`
    group by status

)

select *
from all_values
where value_field not in (
    'disinterested','pending','successful'
)



      
    ) dbt_internal_test
[0m01:51:55.545395 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m01:51:55.545484 [debug] [Thread-1  ]: On test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__0__1.95c6a4ff4f: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__0__1.95c6a4ff4f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        is_outbound as value_field,
        count(*) as n_records

    from `dynamic-point-367801`.`getgroundjoao`.`stg_referrals`
    group by is_outbound

)

select *
from all_values
where value_field not in (
    '0','1'
)



      
    ) dbt_internal_test
[0m01:51:55.545573 [debug] [Thread-4  ]: On test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `dynamic-point-367801`.`getgroundjoao`.`stg_referrals`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m01:51:55.545806 [debug] [Thread-3  ]: On test.ggchallengejoao.not_null_stg_referrals_id.f511791502: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "test.ggchallengejoao.not_null_stg_referrals_id.f511791502"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `dynamic-point-367801`.`getgroundjoao`.`stg_referrals`
where id is null



      
    ) dbt_internal_test
[0m01:51:56.346511 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for operator IN for argument types INT64 and {STRING} at [24:23]')
[0m01:51:57.455243 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:5e64b0d9-8a0f-430c-8878-ce5b4bb79656:EU&page=queryresults
[0m01:51:57.456289 [debug] [Thread-4  ]: finished collecting timing info
[0m01:51:57.456751 [info ] [Thread-4  ]: 4 of 4 PASS unique_stg_referrals_id ............................................ [[32mPASS[0m in 1.98s]
[0m01:51:57.457069 [debug] [Thread-4  ]: Finished running node test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f
[0m01:51:57.470878 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:f257c291-a980-46d1-99ff-05670d8efb62:EU&page=queryresults
[0m01:51:57.471137 [debug] [Thread-2  ]: finished collecting timing info
[0m01:51:57.471428 [info ] [Thread-2  ]: 2 of 4 PASS accepted_values_stg_referrals_status__disinterested__pending__successful  [[32mPASS[0m in 1.99s]
[0m01:51:57.471629 [debug] [Thread-2  ]: Finished running node test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53
[0m01:51:57.492275 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:EU:80d0b726-bb28-42fc-a695-a4ca36f0f10d&page=queryresults
[0m01:51:57.494665 [debug] [Thread-1  ]: finished collecting timing info
[0m01:51:57.495455 [debug] [Thread-1  ]: Database Error in test accepted_values_stg_referrals_is_outbound__0__1 (models/schema.yml)
  No matching signature for operator IN for argument types INT64 and {STRING} at [24:23]
  compiled Code at target/run/ggchallengejoao/models/schema.yml/accepted_values_stg_referrals_is_outbound__0__1.sql
[0m01:51:57.495707 [error] [Thread-1  ]: 1 of 4 ERROR accepted_values_stg_referrals_is_outbound__0__1 ................... [[31mERROR[0m in 2.02s]
[0m01:51:57.495954 [debug] [Thread-1  ]: Finished running node test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__0__1.95c6a4ff4f
[0m01:51:57.807988 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:286e86b0-4731-4757-8d86-9119ce831987:EU&page=queryresults
[0m01:51:57.808313 [debug] [Thread-3  ]: finished collecting timing info
[0m01:51:57.808638 [info ] [Thread-3  ]: 3 of 4 PASS not_null_stg_referrals_id .......................................... [[32mPASS[0m in 2.33s]
[0m01:51:57.808858 [debug] [Thread-3  ]: Finished running node test.ggchallengejoao.not_null_stg_referrals_id.f511791502
[0m01:51:57.809850 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m01:51:57.810193 [info ] [MainThread]: 
[0m01:51:57.810354 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 4.69 seconds (4.69s).
[0m01:51:57.810495 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:51:57.810570 [debug] [MainThread]: Connection 'test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__0__1.95c6a4ff4f' was properly closed.
[0m01:51:57.810638 [debug] [MainThread]: Connection 'test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53' was properly closed.
[0m01:51:57.810708 [debug] [MainThread]: Connection 'test.ggchallengejoao.not_null_stg_referrals_id.f511791502' was properly closed.
[0m01:51:57.810776 [debug] [MainThread]: Connection 'test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f' was properly closed.
[0m01:51:57.819601 [info ] [MainThread]: 
[0m01:51:57.819799 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:51:57.819958 [info ] [MainThread]: 
[0m01:51:57.820073 [error] [MainThread]: [33mDatabase Error in test accepted_values_stg_referrals_is_outbound__0__1 (models/schema.yml)[0m
[0m01:51:57.820187 [error] [MainThread]:   No matching signature for operator IN for argument types INT64 and {STRING} at [24:23]
[0m01:51:57.820302 [error] [MainThread]:   compiled Code at target/run/ggchallengejoao/models/schema.yml/accepted_values_stg_referrals_is_outbound__0__1.sql
[0m01:51:57.820417 [info ] [MainThread]: 
[0m01:51:57.820541 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m01:51:57.820795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102373040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fe8e040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fe8e3d0>]}
[0m01:51:57.820988 [debug] [MainThread]: Flushing usage events


============================== 2023-01-06 01:52:35.416645 | b04b9179-5d55-47d1-8f6e-869f4638009e ==============================
[0m01:52:35.416660 [info ] [MainThread]: Running with dbt=1.3.2
[0m01:52:35.417155 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joaopaulomedeiroscecilio/dev/dbt-data-analysis', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m01:52:35.417256 [debug] [MainThread]: Tracking: tracking
[0m01:52:35.427859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127f3ed90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127f3eeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127f3eee0>]}
[0m01:52:35.474800 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:52:35.475160 [debug] [MainThread]: Partial parsing: update schema file: ggchallengejoao://models/schema.yml
[0m01:52:35.484083 [debug] [MainThread]: 1699: static parser successfully parsed stage/stg_referrals.sql
[0m01:52:35.519730 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ggchallengejoao.example

[0m01:52:35.522691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b04b9179-5d55-47d1-8f6e-869f4638009e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15023f0d0>]}
[0m01:52:35.528407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b04b9179-5d55-47d1-8f6e-869f4638009e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150059820>]}
[0m01:52:35.528626 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 431 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m01:52:35.528771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b04b9179-5d55-47d1-8f6e-869f4638009e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150059700>]}
[0m01:52:35.529548 [info ] [MainThread]: 
[0m01:52:35.529900 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m01:52:35.530470 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801_getgroundjoao"
[0m01:52:35.530609 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:52:36.912210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b04b9179-5d55-47d1-8f6e-869f4638009e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1500594c0>]}
[0m01:52:36.913508 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:52:36.913948 [info ] [MainThread]: 
[0m01:52:36.919684 [debug] [Thread-1  ]: Began running node test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__0__1.95c6a4ff4f
[0m01:52:36.919919 [debug] [Thread-2  ]: Began running node test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53
[0m01:52:36.920129 [debug] [Thread-3  ]: Began running node test.ggchallengejoao.not_null_stg_referrals_id.f511791502
[0m01:52:36.920344 [debug] [Thread-4  ]: Began running node test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f
[0m01:52:36.920613 [info ] [Thread-1  ]: 1 of 4 START test accepted_values_stg_referrals_is_outbound__0__1 .............. [RUN]
[0m01:52:36.920906 [info ] [Thread-2  ]: 2 of 4 START test accepted_values_stg_referrals_status__disinterested__pending__successful  [RUN]
[0m01:52:36.921188 [info ] [Thread-3  ]: 3 of 4 START test not_null_stg_referrals_id .................................... [RUN]
[0m01:52:36.921433 [info ] [Thread-4  ]: 4 of 4 START test unique_stg_referrals_id ...................................... [RUN]
[0m01:52:36.922418 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__0__1.95c6a4ff4f"
[0m01:52:36.923212 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53"
[0m01:52:36.923945 [debug] [Thread-3  ]: Acquiring new bigquery connection "test.ggchallengejoao.not_null_stg_referrals_id.f511791502"
[0m01:52:36.924633 [debug] [Thread-4  ]: Acquiring new bigquery connection "test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f"
[0m01:52:36.924851 [debug] [Thread-1  ]: Began compiling node test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__0__1.95c6a4ff4f
[0m01:52:36.925041 [debug] [Thread-2  ]: Began compiling node test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53
[0m01:52:36.925219 [debug] [Thread-3  ]: Began compiling node test.ggchallengejoao.not_null_stg_referrals_id.f511791502
[0m01:52:36.925390 [debug] [Thread-4  ]: Began compiling node test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f
[0m01:52:36.925618 [debug] [Thread-1  ]: Compiling test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__0__1.95c6a4ff4f
[0m01:52:36.925788 [debug] [Thread-2  ]: Compiling test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53
[0m01:52:36.925952 [debug] [Thread-3  ]: Compiling test.ggchallengejoao.not_null_stg_referrals_id.f511791502
[0m01:52:36.926115 [debug] [Thread-4  ]: Compiling test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f
[0m01:52:36.931847 [debug] [Thread-1  ]: Writing injected SQL for node "test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__0__1.95c6a4ff4f"
[0m01:52:36.935489 [debug] [Thread-2  ]: Writing injected SQL for node "test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53"
[0m01:52:36.940266 [debug] [Thread-3  ]: Writing injected SQL for node "test.ggchallengejoao.not_null_stg_referrals_id.f511791502"
[0m01:52:36.947040 [debug] [Thread-4  ]: Writing injected SQL for node "test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f"
[0m01:52:36.947937 [debug] [Thread-3  ]: finished collecting timing info
[0m01:52:36.948085 [debug] [Thread-2  ]: finished collecting timing info
[0m01:52:36.948211 [debug] [Thread-4  ]: finished collecting timing info
[0m01:52:36.948307 [debug] [Thread-1  ]: finished collecting timing info
[0m01:52:36.948455 [debug] [Thread-3  ]: Began executing node test.ggchallengejoao.not_null_stg_referrals_id.f511791502
[0m01:52:36.948608 [debug] [Thread-2  ]: Began executing node test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53
[0m01:52:36.948750 [debug] [Thread-4  ]: Began executing node test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f
[0m01:52:36.948881 [debug] [Thread-1  ]: Began executing node test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__0__1.95c6a4ff4f
[0m01:52:36.965658 [debug] [Thread-3  ]: Writing runtime sql for node "test.ggchallengejoao.not_null_stg_referrals_id.f511791502"
[0m01:52:36.967640 [debug] [Thread-2  ]: Writing runtime sql for node "test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53"
[0m01:52:36.969339 [debug] [Thread-4  ]: Writing runtime sql for node "test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f"
[0m01:52:36.971065 [debug] [Thread-1  ]: Writing runtime sql for node "test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__0__1.95c6a4ff4f"
[0m01:52:36.971461 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m01:52:36.971672 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m01:52:36.971852 [debug] [Thread-3  ]: On test.ggchallengejoao.not_null_stg_referrals_id.f511791502: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "test.ggchallengejoao.not_null_stg_referrals_id.f511791502"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `dynamic-point-367801`.`getgroundjoao`.`stg_referrals`
where id is null



      
    ) dbt_internal_test
[0m01:52:36.971946 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m01:52:36.972039 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:52:36.972154 [debug] [Thread-2  ]: On test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from `dynamic-point-367801`.`getgroundjoao`.`stg_referrals`
    group by status

)

select *
from all_values
where value_field not in (
    'disinterested','pending','successful'
)



      
    ) dbt_internal_test
[0m01:52:36.972986 [debug] [Thread-4  ]: On test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `dynamic-point-367801`.`getgroundjoao`.`stg_referrals`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m01:52:36.973407 [debug] [Thread-1  ]: On test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__0__1.95c6a4ff4f: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__0__1.95c6a4ff4f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        is_outbound as value_field,
        count(*) as n_records

    from `dynamic-point-367801`.`getgroundjoao`.`stg_referrals`
    group by is_outbound

)

select *
from all_values
where value_field not in (
    '0','1'
)



      
    ) dbt_internal_test
[0m01:52:37.787883 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for operator IN for argument types INT64 and {STRING} at [24:23]')
[0m01:52:38.875936 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:b5e54dd6-37d9-4f78-ac4d-7b615ab80c20:EU&page=queryresults
[0m01:52:38.877226 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:EU:b96b8c41-0614-4f7c-ae85-a697694a84bd&page=queryresults
[0m01:52:38.877861 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:fa2b7f05-79b7-454b-8dbf-36118b07641d:EU&page=queryresults
[0m01:52:38.882657 [debug] [Thread-4  ]: finished collecting timing info
[0m01:52:38.883503 [debug] [Thread-1  ]: finished collecting timing info
[0m01:52:38.884088 [debug] [Thread-3  ]: finished collecting timing info
[0m01:52:38.885984 [info ] [Thread-4  ]: 4 of 4 PASS unique_stg_referrals_id ............................................ [[32mPASS[0m in 1.96s]
[0m01:52:38.886876 [debug] [Thread-1  ]: Database Error in test accepted_values_stg_referrals_is_outbound__0__1 (models/schema.yml)
  No matching signature for operator IN for argument types INT64 and {STRING} at [24:23]
  compiled Code at target/run/ggchallengejoao/models/schema.yml/accepted_values_stg_referrals_is_outbound__0__1.sql
[0m01:52:38.887550 [info ] [Thread-3  ]: 3 of 4 PASS not_null_stg_referrals_id .......................................... [[32mPASS[0m in 1.96s]
[0m01:52:38.888752 [debug] [Thread-4  ]: Finished running node test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f
[0m01:52:38.889053 [error] [Thread-1  ]: 1 of 4 ERROR accepted_values_stg_referrals_is_outbound__0__1 ................... [[31mERROR[0m in 1.97s]
[0m01:52:38.889513 [debug] [Thread-3  ]: Finished running node test.ggchallengejoao.not_null_stg_referrals_id.f511791502
[0m01:52:38.890723 [debug] [Thread-1  ]: Finished running node test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__0__1.95c6a4ff4f
[0m01:52:38.892121 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:9eb1ec22-300f-46af-8927-19dfd2ef77c6:EU&page=queryresults
[0m01:52:38.892938 [debug] [Thread-2  ]: finished collecting timing info
[0m01:52:38.893563 [info ] [Thread-2  ]: 2 of 4 PASS accepted_values_stg_referrals_status__disinterested__pending__successful  [[32mPASS[0m in 1.97s]
[0m01:52:38.893992 [debug] [Thread-2  ]: Finished running node test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53
[0m01:52:38.895785 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m01:52:38.896488 [info ] [MainThread]: 
[0m01:52:38.896820 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 3.37 seconds (3.37s).
[0m01:52:38.897126 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:52:38.897276 [debug] [MainThread]: Connection 'test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__0__1.95c6a4ff4f' was properly closed.
[0m01:52:38.897420 [debug] [MainThread]: Connection 'test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53' was properly closed.
[0m01:52:38.897562 [debug] [MainThread]: Connection 'test.ggchallengejoao.not_null_stg_referrals_id.f511791502' was properly closed.
[0m01:52:38.897703 [debug] [MainThread]: Connection 'test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f' was properly closed.
[0m01:52:38.910212 [info ] [MainThread]: 
[0m01:52:38.910569 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:52:38.910872 [info ] [MainThread]: 
[0m01:52:38.911156 [error] [MainThread]: [33mDatabase Error in test accepted_values_stg_referrals_is_outbound__0__1 (models/schema.yml)[0m
[0m01:52:38.911410 [error] [MainThread]:   No matching signature for operator IN for argument types INT64 and {STRING} at [24:23]
[0m01:52:38.911637 [error] [MainThread]:   compiled Code at target/run/ggchallengejoao/models/schema.yml/accepted_values_stg_referrals_is_outbound__0__1.sql
[0m01:52:38.911875 [info ] [MainThread]: 
[0m01:52:38.912117 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m01:52:38.914071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1501f3f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1501f3490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127f3e100>]}
[0m01:52:38.914550 [debug] [MainThread]: Flushing usage events


============================== 2023-01-06 01:55:08.827813 | b03b2fe5-7519-4398-9089-c4e518fa8d24 ==============================
[0m01:55:08.827870 [info ] [MainThread]: Running with dbt=1.3.2
[0m01:55:08.828606 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joaopaulomedeiroscecilio/dev/dbt-data-analysis', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m01:55:08.828731 [debug] [MainThread]: Tracking: tracking
[0m01:55:08.842487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119e06d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119e06eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119e06ee0>]}
[0m01:55:08.892276 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:55:08.892632 [debug] [MainThread]: Partial parsing: update schema file: ggchallengejoao://models/schema.yml
[0m01:55:08.904327 [debug] [MainThread]: 1699: static parser successfully parsed stage/stg_referrals.sql
[0m01:55:08.939141 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ggchallengejoao.example

[0m01:55:08.942192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b03b2fe5-7519-4398-9089-c4e518fa8d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a0c10d0>]}
[0m01:55:08.948240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b03b2fe5-7519-4398-9089-c4e518fa8d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119f1e820>]}
[0m01:55:08.948560 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 431 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m01:55:08.948713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b03b2fe5-7519-4398-9089-c4e518fa8d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119f1e700>]}
[0m01:55:08.949648 [info ] [MainThread]: 
[0m01:55:08.950213 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m01:55:08.950914 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801_getgroundjoao"
[0m01:55:08.951039 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:55:10.648168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b03b2fe5-7519-4398-9089-c4e518fa8d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119f1e4c0>]}
[0m01:55:10.650412 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:55:10.651060 [info ] [MainThread]: 
[0m01:55:10.658513 [debug] [Thread-1  ]: Began running node test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f
[0m01:55:10.658778 [debug] [Thread-2  ]: Began running node test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53
[0m01:55:10.658994 [debug] [Thread-3  ]: Began running node test.ggchallengejoao.not_null_stg_referrals_id.f511791502
[0m01:55:10.659197 [debug] [Thread-4  ]: Began running node test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f
[0m01:55:10.659489 [info ] [Thread-1  ]: 1 of 4 START test accepted_values_stg_referrals_is_outbound__False__0__1 ....... [RUN]
[0m01:55:10.659793 [info ] [Thread-2  ]: 2 of 4 START test accepted_values_stg_referrals_status__disinterested__pending__successful  [RUN]
[0m01:55:10.660062 [info ] [Thread-3  ]: 3 of 4 START test not_null_stg_referrals_id .................................... [RUN]
[0m01:55:10.660319 [info ] [Thread-4  ]: 4 of 4 START test unique_stg_referrals_id ...................................... [RUN]
[0m01:55:10.661254 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f"
[0m01:55:10.662141 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53"
[0m01:55:10.663120 [debug] [Thread-3  ]: Acquiring new bigquery connection "test.ggchallengejoao.not_null_stg_referrals_id.f511791502"
[0m01:55:10.663923 [debug] [Thread-4  ]: Acquiring new bigquery connection "test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f"
[0m01:55:10.664152 [debug] [Thread-1  ]: Began compiling node test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f
[0m01:55:10.664350 [debug] [Thread-2  ]: Began compiling node test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53
[0m01:55:10.664530 [debug] [Thread-3  ]: Began compiling node test.ggchallengejoao.not_null_stg_referrals_id.f511791502
[0m01:55:10.664702 [debug] [Thread-4  ]: Began compiling node test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f
[0m01:55:10.664943 [debug] [Thread-1  ]: Compiling test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f
[0m01:55:10.665118 [debug] [Thread-2  ]: Compiling test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53
[0m01:55:10.665299 [debug] [Thread-3  ]: Compiling test.ggchallengejoao.not_null_stg_referrals_id.f511791502
[0m01:55:10.665468 [debug] [Thread-4  ]: Compiling test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f
[0m01:55:10.670690 [debug] [Thread-1  ]: Writing injected SQL for node "test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f"
[0m01:55:10.674299 [debug] [Thread-2  ]: Writing injected SQL for node "test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53"
[0m01:55:10.678944 [debug] [Thread-3  ]: Writing injected SQL for node "test.ggchallengejoao.not_null_stg_referrals_id.f511791502"
[0m01:55:10.684711 [debug] [Thread-4  ]: Writing injected SQL for node "test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f"
[0m01:55:10.685449 [debug] [Thread-1  ]: finished collecting timing info
[0m01:55:10.685580 [debug] [Thread-2  ]: finished collecting timing info
[0m01:55:10.685853 [debug] [Thread-3  ]: finished collecting timing info
[0m01:55:10.685993 [debug] [Thread-1  ]: Began executing node test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f
[0m01:55:10.686171 [debug] [Thread-2  ]: Began executing node test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53
[0m01:55:10.686298 [debug] [Thread-4  ]: finished collecting timing info
[0m01:55:10.686449 [debug] [Thread-3  ]: Began executing node test.ggchallengejoao.not_null_stg_referrals_id.f511791502
[0m01:55:10.704020 [debug] [Thread-1  ]: Writing runtime sql for node "test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f"
[0m01:55:10.706077 [debug] [Thread-2  ]: Writing runtime sql for node "test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53"
[0m01:55:10.706294 [debug] [Thread-4  ]: Began executing node test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f
[0m01:55:10.708074 [debug] [Thread-3  ]: Writing runtime sql for node "test.ggchallengejoao.not_null_stg_referrals_id.f511791502"
[0m01:55:10.710284 [debug] [Thread-4  ]: Writing runtime sql for node "test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f"
[0m01:55:10.710526 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:55:10.710700 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m01:55:10.710923 [debug] [Thread-1  ]: On test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        is_outbound as value_field,
        count(*) as n_records

    from `dynamic-point-367801`.`getgroundjoao`.`stg_referrals`
    group by is_outbound

)

select *
from all_values
where value_field not in (
    0,1
)



      
    ) dbt_internal_test
[0m01:55:10.711062 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m01:55:10.711191 [debug] [Thread-2  ]: On test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from `dynamic-point-367801`.`getgroundjoao`.`stg_referrals`
    group by status

)

select *
from all_values
where value_field not in (
    'disinterested','pending','successful'
)



      
    ) dbt_internal_test
[0m01:55:10.711290 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m01:55:10.712006 [debug] [Thread-3  ]: On test.ggchallengejoao.not_null_stg_referrals_id.f511791502: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "test.ggchallengejoao.not_null_stg_referrals_id.f511791502"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `dynamic-point-367801`.`getgroundjoao`.`stg_referrals`
where id is null



      
    ) dbt_internal_test
[0m01:55:10.713340 [debug] [Thread-4  ]: On test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `dynamic-point-367801`.`getgroundjoao`.`stg_referrals`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m01:55:12.732609 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:07c19bfc-00ec-4436-a98c-f215f04500ae:EU&page=queryresults
[0m01:55:12.734594 [debug] [Thread-4  ]: finished collecting timing info
[0m01:55:12.735420 [info ] [Thread-4  ]: 4 of 4 PASS unique_stg_referrals_id ............................................ [[32mPASS[0m in 2.07s]
[0m01:55:12.736020 [debug] [Thread-4  ]: Finished running node test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f
[0m01:55:12.838869 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:51b8342e-8773-4dab-9a8b-33ad04ded3f5:EU&page=queryresults
[0m01:55:12.839220 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:5af790c5-dc47-4a41-ba13-3e59228351d1:EU&page=queryresults
[0m01:55:12.839518 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:1b55c033-17e5-4036-b48b-d3fa11566576:EU&page=queryresults
[0m01:55:12.840086 [debug] [Thread-2  ]: finished collecting timing info
[0m01:55:12.840439 [debug] [Thread-1  ]: finished collecting timing info
[0m01:55:12.840754 [debug] [Thread-3  ]: finished collecting timing info
[0m01:55:12.841377 [info ] [Thread-2  ]: 2 of 4 PASS accepted_values_stg_referrals_status__disinterested__pending__successful  [[32mPASS[0m in 2.18s]
[0m01:55:12.841874 [info ] [Thread-1  ]: 1 of 4 PASS accepted_values_stg_referrals_is_outbound__False__0__1 ............. [[32mPASS[0m in 2.18s]
[0m01:55:12.842340 [info ] [Thread-3  ]: 3 of 4 PASS not_null_stg_referrals_id .......................................... [[32mPASS[0m in 2.18s]
[0m01:55:12.842790 [debug] [Thread-2  ]: Finished running node test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53
[0m01:55:12.843166 [debug] [Thread-1  ]: Finished running node test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f
[0m01:55:12.843508 [debug] [Thread-3  ]: Finished running node test.ggchallengejoao.not_null_stg_referrals_id.f511791502
[0m01:55:12.845618 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m01:55:12.846221 [info ] [MainThread]: 
[0m01:55:12.846476 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 3.90 seconds (3.90s).
[0m01:55:12.846714 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:55:12.846828 [debug] [MainThread]: Connection 'test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f' was properly closed.
[0m01:55:12.846934 [debug] [MainThread]: Connection 'test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53' was properly closed.
[0m01:55:12.847040 [debug] [MainThread]: Connection 'test.ggchallengejoao.not_null_stg_referrals_id.f511791502' was properly closed.
[0m01:55:12.847144 [debug] [MainThread]: Connection 'test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f' was properly closed.
[0m01:55:12.856047 [info ] [MainThread]: 
[0m01:55:12.856332 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:55:12.856568 [info ] [MainThread]: 
[0m01:55:12.856752 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m01:55:12.857099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119e2fee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119e2f790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119e06dc0>]}
[0m01:55:12.857363 [debug] [MainThread]: Flushing usage events


============================== 2023-01-06 01:55:58.852816 | 3180fd04-9108-4fe6-8f81-c94158e7d611 ==============================
[0m01:55:58.852845 [info ] [MainThread]: Running with dbt=1.3.2
[0m01:55:58.853531 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joaopaulomedeiroscecilio/dev/dbt-data-analysis', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m01:55:58.853653 [debug] [MainThread]: Tracking: tracking
[0m01:55:58.865922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e37dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e37de50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e37de80>]}
[0m01:55:58.916864 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:55:58.917007 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:55:58.917271 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ggchallengejoao.example

[0m01:55:58.920660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3180fd04-9108-4fe6-8f81-c94158e7d611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e696f40>]}
[0m01:55:58.927504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3180fd04-9108-4fe6-8f81-c94158e7d611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e49c7f0>]}
[0m01:55:58.927788 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 431 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m01:55:58.927958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3180fd04-9108-4fe6-8f81-c94158e7d611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e49c6d0>]}
[0m01:55:58.929039 [info ] [MainThread]: 
[0m01:55:58.929456 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m01:55:58.930016 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801_getgroundjoao"
[0m01:55:58.930157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:56:00.243053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3180fd04-9108-4fe6-8f81-c94158e7d611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e3b23d0>]}
[0m01:56:00.245175 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:56:00.247456 [info ] [MainThread]: 
[0m01:56:00.255210 [debug] [Thread-1  ]: Began running node seed.ggchallengejoao.partners
[0m01:56:00.255546 [debug] [Thread-2  ]: Began running node seed.ggchallengejoao.referrals
[0m01:56:00.255757 [debug] [Thread-3  ]: Began running node seed.ggchallengejoao.sales_people
[0m01:56:00.256643 [debug] [Thread-1  ]: Acquiring new bigquery connection "seed.ggchallengejoao.partners"
[0m01:56:00.257363 [debug] [Thread-2  ]: Acquiring new bigquery connection "seed.ggchallengejoao.referrals"
[0m01:56:00.258189 [debug] [Thread-3  ]: Acquiring new bigquery connection "seed.ggchallengejoao.sales_people"
[0m01:56:00.258508 [debug] [Thread-1  ]: Began compiling node seed.ggchallengejoao.partners
[0m01:56:00.258767 [debug] [Thread-2  ]: Began compiling node seed.ggchallengejoao.referrals
[0m01:56:00.258997 [debug] [Thread-3  ]: Began compiling node seed.ggchallengejoao.sales_people
[0m01:56:00.259256 [debug] [Thread-1  ]: Compiling seed.ggchallengejoao.partners
[0m01:56:00.259431 [debug] [Thread-2  ]: Compiling seed.ggchallengejoao.referrals
[0m01:56:00.259603 [debug] [Thread-3  ]: Compiling seed.ggchallengejoao.sales_people
[0m01:56:00.262749 [debug] [Thread-1  ]: Writing injected SQL for node "seed.ggchallengejoao.partners"
[0m01:56:00.265200 [debug] [Thread-2  ]: Writing injected SQL for node "seed.ggchallengejoao.referrals"
[0m01:56:00.266425 [debug] [Thread-3  ]: Writing injected SQL for node "seed.ggchallengejoao.sales_people"
[0m01:56:00.266634 [debug] [Thread-1  ]: finished collecting timing info
[0m01:56:00.266759 [debug] [Thread-2  ]: finished collecting timing info
[0m01:56:00.266845 [debug] [Thread-3  ]: finished collecting timing info
[0m01:56:00.266954 [debug] [Thread-1  ]: Began executing node seed.ggchallengejoao.partners
[0m01:56:00.267040 [debug] [Thread-2  ]: Began executing node seed.ggchallengejoao.referrals
[0m01:56:00.267128 [debug] [Thread-3  ]: Began executing node seed.ggchallengejoao.sales_people
[0m01:56:00.267240 [debug] [Thread-1  ]: finished collecting timing info
[0m01:56:00.267322 [debug] [Thread-2  ]: finished collecting timing info
[0m01:56:00.267412 [debug] [Thread-3  ]: finished collecting timing info
[0m01:56:00.267808 [debug] [Thread-1  ]: Finished running node seed.ggchallengejoao.partners
[0m01:56:00.268157 [debug] [Thread-2  ]: Finished running node seed.ggchallengejoao.referrals
[0m01:56:00.268436 [debug] [Thread-3  ]: Finished running node seed.ggchallengejoao.sales_people
[0m01:56:00.268647 [debug] [Thread-4  ]: Began running node model.ggchallengejoao.stg_partners
[0m01:56:00.268802 [debug] [Thread-1  ]: Began running node model.ggchallengejoao.stg_referrals
[0m01:56:00.269081 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_partners"
[0m01:56:00.269358 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_referrals"
[0m01:56:00.269442 [debug] [Thread-4  ]: Began compiling node model.ggchallengejoao.stg_partners
[0m01:56:00.269528 [debug] [Thread-1  ]: Began compiling node model.ggchallengejoao.stg_referrals
[0m01:56:00.269608 [debug] [Thread-4  ]: Compiling model.ggchallengejoao.stg_partners
[0m01:56:00.269686 [debug] [Thread-1  ]: Compiling model.ggchallengejoao.stg_referrals
[0m01:56:00.272196 [debug] [Thread-1  ]: Writing injected SQL for node "model.ggchallengejoao.stg_referrals"
[0m01:56:00.276406 [debug] [Thread-4  ]: Writing injected SQL for node "model.ggchallengejoao.stg_partners"
[0m01:56:00.276978 [debug] [Thread-1  ]: finished collecting timing info
[0m01:56:00.277292 [debug] [Thread-1  ]: Began executing node model.ggchallengejoao.stg_referrals
[0m01:56:00.277477 [debug] [Thread-1  ]: finished collecting timing info
[0m01:56:00.277656 [debug] [Thread-4  ]: finished collecting timing info
[0m01:56:00.278342 [debug] [Thread-1  ]: Finished running node model.ggchallengejoao.stg_referrals
[0m01:56:00.278525 [debug] [Thread-4  ]: Began executing node model.ggchallengejoao.stg_partners
[0m01:56:00.279010 [debug] [Thread-4  ]: finished collecting timing info
[0m01:56:00.279155 [debug] [Thread-3  ]: Began running node test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f
[0m01:56:00.279289 [debug] [Thread-2  ]: Began running node test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53
[0m01:56:00.279423 [debug] [Thread-1  ]: Began running node test.ggchallengejoao.not_null_stg_referrals_id.f511791502
[0m01:56:00.280013 [debug] [Thread-4  ]: Finished running node model.ggchallengejoao.stg_partners
[0m01:56:00.280507 [debug] [Thread-3  ]: Acquiring new bigquery connection "test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f"
[0m01:56:00.280959 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53"
[0m01:56:00.281427 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.ggchallengejoao.not_null_stg_referrals_id.f511791502"
[0m01:56:00.281639 [debug] [Thread-4  ]: Began running node test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f
[0m01:56:00.281843 [debug] [Thread-3  ]: Began compiling node test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f
[0m01:56:00.281990 [debug] [Thread-2  ]: Began compiling node test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53
[0m01:56:00.282135 [debug] [Thread-1  ]: Began compiling node test.ggchallengejoao.not_null_stg_referrals_id.f511791502
[0m01:56:00.282529 [debug] [Thread-4  ]: Acquiring new bigquery connection "test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f"
[0m01:56:00.282681 [debug] [Thread-3  ]: Compiling test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f
[0m01:56:00.282820 [debug] [Thread-2  ]: Compiling test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53
[0m01:56:00.282954 [debug] [Thread-1  ]: Compiling test.ggchallengejoao.not_null_stg_referrals_id.f511791502
[0m01:56:00.283090 [debug] [Thread-4  ]: Began compiling node test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f
[0m01:56:00.294121 [debug] [Thread-3  ]: Writing injected SQL for node "test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f"
[0m01:56:00.299038 [debug] [Thread-2  ]: Writing injected SQL for node "test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53"
[0m01:56:00.305873 [debug] [Thread-1  ]: Writing injected SQL for node "test.ggchallengejoao.not_null_stg_referrals_id.f511791502"
[0m01:56:00.306024 [debug] [Thread-4  ]: Compiling test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f
[0m01:56:00.311088 [debug] [Thread-4  ]: Writing injected SQL for node "test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f"
[0m01:56:00.311209 [debug] [Thread-3  ]: finished collecting timing info
[0m01:56:00.311298 [debug] [Thread-2  ]: finished collecting timing info
[0m01:56:00.311459 [debug] [Thread-1  ]: finished collecting timing info
[0m01:56:00.311573 [debug] [Thread-3  ]: Began executing node test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f
[0m01:56:00.311685 [debug] [Thread-2  ]: Began executing node test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53
[0m01:56:00.311762 [debug] [Thread-4  ]: finished collecting timing info
[0m01:56:00.311862 [debug] [Thread-1  ]: Began executing node test.ggchallengejoao.not_null_stg_referrals_id.f511791502
[0m01:56:00.311971 [debug] [Thread-3  ]: finished collecting timing info
[0m01:56:00.312070 [debug] [Thread-2  ]: finished collecting timing info
[0m01:56:00.312167 [debug] [Thread-4  ]: Began executing node test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f
[0m01:56:00.312263 [debug] [Thread-1  ]: finished collecting timing info
[0m01:56:00.312633 [debug] [Thread-3  ]: Finished running node test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f
[0m01:56:00.312973 [debug] [Thread-2  ]: Finished running node test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53
[0m01:56:00.313079 [debug] [Thread-4  ]: finished collecting timing info
[0m01:56:00.313391 [debug] [Thread-1  ]: Finished running node test.ggchallengejoao.not_null_stg_referrals_id.f511791502
[0m01:56:00.313842 [debug] [Thread-4  ]: Finished running node test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f
[0m01:56:00.314417 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:56:00.314512 [debug] [MainThread]: Connection 'test.ggchallengejoao.not_null_stg_referrals_id.f511791502' was properly closed.
[0m01:56:00.314594 [debug] [MainThread]: Connection 'test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53' was properly closed.
[0m01:56:00.314672 [debug] [MainThread]: Connection 'test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f' was properly closed.
[0m01:56:00.314748 [debug] [MainThread]: Connection 'test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f' was properly closed.
[0m01:56:00.321383 [info ] [MainThread]: Done.
[0m01:56:00.323725 [debug] [MainThread]: Acquiring new bigquery connection "generate_catalog"
[0m01:56:00.323838 [info ] [MainThread]: Building catalog
[0m01:56:00.324255 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:56:00.795982 [debug] [ThreadPool]: Acquiring new bigquery connection "dynamic-point-367801.information_schema"
[0m01:56:00.819690 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:56:00.820180 [debug] [ThreadPool]: On dynamic-point-367801.information_schema: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "connection_name": "dynamic-point-367801.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `dynamic-point-367801`.`getgroundjoao`.__TABLES__
        where (upper(dataset_id) = upper('getgroundjoao'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `dynamic-point-367801`.`getgroundjoao`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `dynamic-point-367801`.`getgroundjoao`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m01:56:03.535648 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:7995752a-b27f-466e-bc2f-3894d7f4f413:EU&page=queryresults
[0m01:56:03.577359 [info ] [MainThread]: Catalog written to /Users/joaopaulomedeiroscecilio/dev/ggchallenge/ggchallengejoao/target/catalog.json
[0m01:56:03.578069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e37dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e773400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e7736a0>]}
[0m01:56:03.578451 [debug] [MainThread]: Flushing usage events
[0m01:56:04.405488 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m01:56:04.406013 [debug] [MainThread]: Connection 'dynamic-point-367801.information_schema' was properly closed.


============================== 2023-01-06 01:56:08.963636 | 38136f35-d6f7-4aa1-929a-eb3c15de4535 ==============================
[0m01:56:08.963670 [info ] [MainThread]: Running with dbt=1.3.2
[0m01:56:08.964043 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joaopaulomedeiroscecilio/dev/dbt-data-analysis', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m01:56:08.964155 [debug] [MainThread]: Tracking: tracking
[0m01:56:08.973250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f1bdd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f1bde80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f1bdeb0>]}
[0m01:56:08.975729 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m01:56:08.975933 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m01:56:08.976128 [info ] [MainThread]: 
[0m01:56:08.976263 [info ] [MainThread]: 
[0m01:56:08.976376 [info ] [MainThread]: Press Ctrl+C to exit.
[0m01:57:12.394023 [debug] [MainThread]: Flushing usage events
[0m01:57:13.369665 [info ] [MainThread]: ctrl-c


============================== 2023-01-06 01:57:18.011812 | f667eb18-7810-4d36-9dec-3feecae9b6dd ==============================
[0m01:57:18.011846 [info ] [MainThread]: Running with dbt=1.3.2
[0m01:57:18.012540 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joaopaulomedeiroscecilio/dev/dbt-data-analysis', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m01:57:18.012655 [debug] [MainThread]: Tracking: tracking
[0m01:57:18.029564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1177bcd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1177bce80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1177bceb0>]}
[0m01:57:18.080394 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:57:18.080757 [debug] [MainThread]: Partial parsing: update schema file: ggchallengejoao://models/schema.yml
[0m01:57:18.089670 [debug] [MainThread]: 1699: static parser successfully parsed stage/stg_referrals.sql
[0m01:57:18.125485 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ggchallengejoao.example

[0m01:57:18.128447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f667eb18-7810-4d36-9dec-3feecae9b6dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117a710d0>]}
[0m01:57:18.134005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f667eb18-7810-4d36-9dec-3feecae9b6dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1178dc820>]}
[0m01:57:18.134176 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 431 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m01:57:18.134322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f667eb18-7810-4d36-9dec-3feecae9b6dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1178dc700>]}
[0m01:57:18.135137 [info ] [MainThread]: 
[0m01:57:18.135516 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m01:57:18.136073 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801_getgroundjoao"
[0m01:57:18.136213 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:57:19.431169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f667eb18-7810-4d36-9dec-3feecae9b6dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1177da5e0>]}
[0m01:57:19.432590 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:57:19.433106 [info ] [MainThread]: 
[0m01:57:19.439829 [debug] [Thread-1  ]: Began running node seed.ggchallengejoao.partners
[0m01:57:19.440072 [debug] [Thread-2  ]: Began running node seed.ggchallengejoao.referrals
[0m01:57:19.440357 [debug] [Thread-3  ]: Began running node seed.ggchallengejoao.sales_people
[0m01:57:19.441148 [debug] [Thread-1  ]: Acquiring new bigquery connection "seed.ggchallengejoao.partners"
[0m01:57:19.442025 [debug] [Thread-2  ]: Acquiring new bigquery connection "seed.ggchallengejoao.referrals"
[0m01:57:19.442769 [debug] [Thread-3  ]: Acquiring new bigquery connection "seed.ggchallengejoao.sales_people"
[0m01:57:19.443037 [debug] [Thread-1  ]: Began compiling node seed.ggchallengejoao.partners
[0m01:57:19.443283 [debug] [Thread-2  ]: Began compiling node seed.ggchallengejoao.referrals
[0m01:57:19.443492 [debug] [Thread-3  ]: Began compiling node seed.ggchallengejoao.sales_people
[0m01:57:19.443704 [debug] [Thread-1  ]: Compiling seed.ggchallengejoao.partners
[0m01:57:19.443866 [debug] [Thread-2  ]: Compiling seed.ggchallengejoao.referrals
[0m01:57:19.444037 [debug] [Thread-3  ]: Compiling seed.ggchallengejoao.sales_people
[0m01:57:19.446645 [debug] [Thread-1  ]: Writing injected SQL for node "seed.ggchallengejoao.partners"
[0m01:57:19.448842 [debug] [Thread-2  ]: Writing injected SQL for node "seed.ggchallengejoao.referrals"
[0m01:57:19.451083 [debug] [Thread-3  ]: Writing injected SQL for node "seed.ggchallengejoao.sales_people"
[0m01:57:19.451310 [debug] [Thread-1  ]: finished collecting timing info
[0m01:57:19.451489 [debug] [Thread-2  ]: finished collecting timing info
[0m01:57:19.451655 [debug] [Thread-3  ]: finished collecting timing info
[0m01:57:19.451925 [debug] [Thread-1  ]: Began executing node seed.ggchallengejoao.partners
[0m01:57:19.452183 [debug] [Thread-2  ]: Began executing node seed.ggchallengejoao.referrals
[0m01:57:19.452367 [debug] [Thread-3  ]: Began executing node seed.ggchallengejoao.sales_people
[0m01:57:19.452583 [debug] [Thread-1  ]: finished collecting timing info
[0m01:57:19.452760 [debug] [Thread-2  ]: finished collecting timing info
[0m01:57:19.452928 [debug] [Thread-3  ]: finished collecting timing info
[0m01:57:19.453740 [debug] [Thread-1  ]: Finished running node seed.ggchallengejoao.partners
[0m01:57:19.454437 [debug] [Thread-2  ]: Finished running node seed.ggchallengejoao.referrals
[0m01:57:19.455069 [debug] [Thread-3  ]: Finished running node seed.ggchallengejoao.sales_people
[0m01:57:19.455546 [debug] [Thread-4  ]: Began running node model.ggchallengejoao.stg_partners
[0m01:57:19.455910 [debug] [Thread-1  ]: Began running node model.ggchallengejoao.stg_referrals
[0m01:57:19.456694 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_partners"
[0m01:57:19.457258 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_referrals"
[0m01:57:19.457457 [debug] [Thread-4  ]: Began compiling node model.ggchallengejoao.stg_partners
[0m01:57:19.457637 [debug] [Thread-1  ]: Began compiling node model.ggchallengejoao.stg_referrals
[0m01:57:19.457819 [debug] [Thread-4  ]: Compiling model.ggchallengejoao.stg_partners
[0m01:57:19.457981 [debug] [Thread-1  ]: Compiling model.ggchallengejoao.stg_referrals
[0m01:57:19.461381 [debug] [Thread-4  ]: Writing injected SQL for node "model.ggchallengejoao.stg_partners"
[0m01:57:19.463396 [debug] [Thread-1  ]: Writing injected SQL for node "model.ggchallengejoao.stg_referrals"
[0m01:57:19.464692 [debug] [Thread-4  ]: finished collecting timing info
[0m01:57:19.464796 [debug] [Thread-1  ]: finished collecting timing info
[0m01:57:19.464870 [debug] [Thread-4  ]: Began executing node model.ggchallengejoao.stg_partners
[0m01:57:19.464953 [debug] [Thread-1  ]: Began executing node model.ggchallengejoao.stg_referrals
[0m01:57:19.465074 [debug] [Thread-4  ]: finished collecting timing info
[0m01:57:19.465150 [debug] [Thread-1  ]: finished collecting timing info
[0m01:57:19.465446 [debug] [Thread-4  ]: Finished running node model.ggchallengejoao.stg_partners
[0m01:57:19.465718 [debug] [Thread-1  ]: Finished running node model.ggchallengejoao.stg_referrals
[0m01:57:19.465988 [debug] [Thread-2  ]: Began running node test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f
[0m01:57:19.466217 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f"
[0m01:57:19.466289 [debug] [Thread-2  ]: Began compiling node test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f
[0m01:57:19.466361 [debug] [Thread-2  ]: Compiling test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f
[0m01:57:19.470822 [debug] [Thread-2  ]: Writing injected SQL for node "test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f"
[0m01:57:19.471036 [debug] [Thread-3  ]: Began running node test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53
[0m01:57:19.471189 [debug] [Thread-4  ]: Began running node test.ggchallengejoao.not_null_stg_referrals_id.f511791502
[0m01:57:19.471395 [debug] [Thread-1  ]: Began running node test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f
[0m01:57:19.472047 [debug] [Thread-3  ]: Acquiring new bigquery connection "test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53"
[0m01:57:19.472711 [debug] [Thread-4  ]: Acquiring new bigquery connection "test.ggchallengejoao.not_null_stg_referrals_id.f511791502"
[0m01:57:19.472843 [debug] [Thread-2  ]: finished collecting timing info
[0m01:57:19.473265 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f"
[0m01:57:19.473418 [debug] [Thread-3  ]: Began compiling node test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53
[0m01:57:19.473573 [debug] [Thread-4  ]: Began compiling node test.ggchallengejoao.not_null_stg_referrals_id.f511791502
[0m01:57:19.473718 [debug] [Thread-2  ]: Began executing node test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f
[0m01:57:19.473850 [debug] [Thread-1  ]: Began compiling node test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f
[0m01:57:19.473980 [debug] [Thread-3  ]: Compiling test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53
[0m01:57:19.474116 [debug] [Thread-4  ]: Compiling test.ggchallengejoao.not_null_stg_referrals_id.f511791502
[0m01:57:19.474266 [debug] [Thread-2  ]: finished collecting timing info
[0m01:57:19.474384 [debug] [Thread-1  ]: Compiling test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f
[0m01:57:19.480024 [debug] [Thread-3  ]: Writing injected SQL for node "test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53"
[0m01:57:19.487660 [debug] [Thread-4  ]: Writing injected SQL for node "test.ggchallengejoao.not_null_stg_referrals_id.f511791502"
[0m01:57:19.488269 [debug] [Thread-2  ]: Finished running node test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f
[0m01:57:19.493249 [debug] [Thread-1  ]: Writing injected SQL for node "test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f"
[0m01:57:19.494881 [debug] [Thread-3  ]: finished collecting timing info
[0m01:57:19.494996 [debug] [Thread-4  ]: finished collecting timing info
[0m01:57:19.495084 [debug] [Thread-1  ]: finished collecting timing info
[0m01:57:19.495207 [debug] [Thread-3  ]: Began executing node test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53
[0m01:57:19.495316 [debug] [Thread-4  ]: Began executing node test.ggchallengejoao.not_null_stg_referrals_id.f511791502
[0m01:57:19.495446 [debug] [Thread-1  ]: Began executing node test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f
[0m01:57:19.495570 [debug] [Thread-3  ]: finished collecting timing info
[0m01:57:19.495682 [debug] [Thread-4  ]: finished collecting timing info
[0m01:57:19.495791 [debug] [Thread-1  ]: finished collecting timing info
[0m01:57:19.496221 [debug] [Thread-3  ]: Finished running node test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53
[0m01:57:19.496587 [debug] [Thread-4  ]: Finished running node test.ggchallengejoao.not_null_stg_referrals_id.f511791502
[0m01:57:19.496985 [debug] [Thread-1  ]: Finished running node test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f
[0m01:57:19.497621 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:57:19.497717 [debug] [MainThread]: Connection 'test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f' was properly closed.
[0m01:57:19.497802 [debug] [MainThread]: Connection 'test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f' was properly closed.
[0m01:57:19.497881 [debug] [MainThread]: Connection 'test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53' was properly closed.
[0m01:57:19.497957 [debug] [MainThread]: Connection 'test.ggchallengejoao.not_null_stg_referrals_id.f511791502' was properly closed.
[0m01:57:19.504630 [info ] [MainThread]: Done.
[0m01:57:19.508391 [debug] [MainThread]: Acquiring new bigquery connection "generate_catalog"
[0m01:57:19.508519 [info ] [MainThread]: Building catalog
[0m01:57:19.508935 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:57:19.979061 [debug] [ThreadPool]: Acquiring new bigquery connection "dynamic-point-367801.information_schema"
[0m01:57:20.001082 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:57:20.001580 [debug] [ThreadPool]: On dynamic-point-367801.information_schema: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "connection_name": "dynamic-point-367801.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `dynamic-point-367801`.`getgroundjoao`.__TABLES__
        where (upper(dataset_id) = upper('getgroundjoao'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `dynamic-point-367801`.`getgroundjoao`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `dynamic-point-367801`.`getgroundjoao`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m01:57:23.408590 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:a69d24cf-cc5b-4bc3-ba4c-3f1af40c0320:EU&page=queryresults
[0m01:57:23.443563 [info ] [MainThread]: Catalog written to /Users/joaopaulomedeiroscecilio/dev/ggchallenge/ggchallengejoao/target/catalog.json
[0m01:57:23.444167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117a79fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117ae3eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117ae3df0>]}
[0m01:57:23.444483 [debug] [MainThread]: Flushing usage events
[0m01:57:24.486068 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m01:57:24.486788 [debug] [MainThread]: Connection 'dynamic-point-367801.information_schema' was properly closed.


============================== 2023-01-06 01:57:28.785952 | 9d4176a8-3ed3-4000-93e1-8565ac446515 ==============================
[0m01:57:28.785992 [info ] [MainThread]: Running with dbt=1.3.2
[0m01:57:28.786383 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joaopaulomedeiroscecilio/dev/dbt-data-analysis', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m01:57:28.786481 [debug] [MainThread]: Tracking: tracking
[0m01:57:28.795516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1223bddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1223bdee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1223bdf10>]}
[0m01:57:28.797656 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m01:57:28.797908 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m01:57:28.798041 [info ] [MainThread]: 
[0m01:57:28.798162 [info ] [MainThread]: 
[0m01:57:28.798275 [info ] [MainThread]: Press Ctrl+C to exit.
[0m02:03:40.009271 [debug] [MainThread]: Flushing usage events
[0m02:03:40.279013 [info ] [MainThread]: ctrl-c


============================== 2023-01-06 02:03:50.847188 | a55ba0d9-75ab-4f7b-ad65-51f272f5ebd6 ==============================
[0m02:03:50.847206 [info ] [MainThread]: Running with dbt=1.3.2
[0m02:03:50.847821 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joaopaulomedeiroscecilio/dev/dbt-data-analysis', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'parse_only': False, 'select': ['stg_partners'], 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m02:03:50.847941 [debug] [MainThread]: Tracking: tracking
[0m02:03:50.864445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cc82d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cc82e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cc82e50>]}
[0m02:03:50.936004 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 3 files added, 0 files changed.
[0m02:03:50.936251 [debug] [MainThread]: Partial parsing: added file: ggchallengejoao://models/stating/stg_referrals.sql
[0m02:03:50.936358 [debug] [MainThread]: Partial parsing: added file: ggchallengejoao://macros/unix_to_timestamp.sql
[0m02:03:50.936455 [debug] [MainThread]: Partial parsing: added file: ggchallengejoao://models/stating/stg_partners.sql
[0m02:03:50.936546 [debug] [MainThread]: Partial parsing: deleted file: ggchallengejoao://models/stage/stg_referrals.sql
[0m02:03:50.936610 [debug] [MainThread]: Partial parsing: deleted file: ggchallengejoao://models/stage/stg_partners.sql
[0m02:03:50.936703 [debug] [MainThread]: Parsing macros/unix_to_timestamp.sql
[0m02:03:50.945240 [debug] [MainThread]: 1699: static parser successfully parsed stating/stg_referrals.sql
[0m02:03:50.951728 [debug] [MainThread]: 1603: static parser failed on stating/stg_partners.sql
[0m02:03:50.954097 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stating/stg_partners.sql
[0m02:03:50.983157 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ggchallengejoao.example

[0m02:03:50.986302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a55ba0d9-75ab-4f7b-ad65-51f272f5ebd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cfa10d0>]}
[0m02:03:50.992392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a55ba0d9-75ab-4f7b-ad65-51f272f5ebd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ce976a0>]}
[0m02:03:50.992572 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 432 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m02:03:50.992711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a55ba0d9-75ab-4f7b-ad65-51f272f5ebd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cecd370>]}
[0m02:03:50.993408 [info ] [MainThread]: 
[0m02:03:50.993794 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m02:03:50.994352 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801_getgroundjoao"
[0m02:03:50.994484 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:03:52.833765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a55ba0d9-75ab-4f7b-ad65-51f272f5ebd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ce3d400>]}
[0m02:03:52.834587 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:03:52.834790 [info ] [MainThread]: 
[0m02:03:52.840349 [debug] [Thread-1  ]: Began running node model.ggchallengejoao.stg_partners
[0m02:03:52.840909 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_partners"
[0m02:03:52.841100 [debug] [Thread-1  ]: Began compiling node model.ggchallengejoao.stg_partners
[0m02:03:52.841367 [debug] [Thread-1  ]: Compiling model.ggchallengejoao.stg_partners
[0m02:03:52.846935 [debug] [Thread-1  ]: finished collecting timing info
[0m02:03:52.847440 [debug] [Thread-1  ]: Compilation Error in model stg_partners (models/stating/stg_partners.sql)
  'unix_to_timestamp' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m02:03:52.847742 [debug] [Thread-1  ]: Finished running node model.ggchallengejoao.stg_partners
[0m02:03:52.848435 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:03:52.848761 [debug] [MainThread]: Connection 'model.ggchallengejoao.stg_partners' was properly closed.
[0m02:03:52.849033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cdcf3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cf3b3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cec4f10>]}
[0m02:03:52.849218 [debug] [MainThread]: Flushing usage events
[0m02:03:53.547931 [error] [MainThread]: Encountered an error:
Runtime Error
  Compilation Error in model stg_partners (models/stating/stg_partners.sql)
    'unix_to_timestamp' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".


============================== 2023-01-06 02:04:46.436095 | fabc7b12-b4bc-44b7-bf61-bfc6229034cf ==============================
[0m02:04:46.436102 [info ] [MainThread]: Running with dbt=1.3.2
[0m02:04:46.436515 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joaopaulomedeiroscecilio/dev/dbt-data-analysis', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m02:04:46.436595 [debug] [MainThread]: Tracking: tracking
[0m02:04:46.449358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045427c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104556dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045561f0>]}
[0m02:04:46.450775 [debug] [MainThread]: Set downloads directory='/var/folders/nr/2t4z4mks1h3fqcd9w6_2ftvr0000gn/T/dbt-downloads-vq90exsc'
[0m02:04:46.451121 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m02:04:47.816910 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m02:04:47.818351 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m02:04:47.974123 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m02:04:48.027622 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m02:04:48.621145 [info ] [MainThread]:   Installed from version 1.0.0
[0m02:04:48.621396 [info ] [MainThread]:   Up to date!
[0m02:04:48.621629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fabc7b12-b4bc-44b7-bf61-bfc6229034cf', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045562b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044adac0>]}
[0m02:04:48.622099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1014b8d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045425b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045425e0>]}
[0m02:04:48.622247 [debug] [MainThread]: Flushing usage events


============================== 2023-01-06 02:04:56.371029 | e5188996-f6c5-4f9c-b1f1-16d8e38624ff ==============================
[0m02:04:56.371050 [info ] [MainThread]: Running with dbt=1.3.2
[0m02:04:56.371426 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joaopaulomedeiroscecilio/dev/dbt-data-analysis', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'parse_only': False, 'select': ['stg_partners'], 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m02:04:56.371523 [debug] [MainThread]: Tracking: tracking
[0m02:04:56.383090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1205c0d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1205c0e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1205c0eb0>]}
[0m02:04:56.429555 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:04:56.429708 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:04:56.429966 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ggchallengejoao.example

[0m02:04:56.433539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5188996-f6c5-4f9c-b1f1-16d8e38624ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1208d80d0>]}
[0m02:04:56.439132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5188996-f6c5-4f9c-b1f1-16d8e38624ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1207cbac0>]}
[0m02:04:56.439290 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 432 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m02:04:56.439429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5188996-f6c5-4f9c-b1f1-16d8e38624ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1207cb9a0>]}
[0m02:04:56.440143 [info ] [MainThread]: 
[0m02:04:56.440518 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m02:04:56.441122 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801_getgroundjoao"
[0m02:04:56.441276 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:04:57.793441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5188996-f6c5-4f9c-b1f1-16d8e38624ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1207cb790>]}
[0m02:04:57.794890 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:04:57.795464 [info ] [MainThread]: 
[0m02:04:57.802907 [debug] [Thread-1  ]: Began running node model.ggchallengejoao.stg_partners
[0m02:04:57.803363 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_partners"
[0m02:04:57.803468 [debug] [Thread-1  ]: Began compiling node model.ggchallengejoao.stg_partners
[0m02:04:57.803578 [debug] [Thread-1  ]: Compiling model.ggchallengejoao.stg_partners
[0m02:04:57.806537 [debug] [Thread-1  ]: finished collecting timing info
[0m02:04:57.806885 [debug] [Thread-1  ]: Compilation Error in model stg_partners (models/stating/stg_partners.sql)
  'unix_to_timestamp' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m02:04:57.807064 [debug] [Thread-1  ]: Finished running node model.ggchallengejoao.stg_partners
[0m02:04:57.807309 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:04:57.807453 [debug] [MainThread]: Connection 'model.ggchallengejoao.stg_partners' was properly closed.
[0m02:04:57.807619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1205e9550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1207cb8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1209f6a30>]}
[0m02:04:57.807771 [debug] [MainThread]: Flushing usage events
[0m02:04:58.605737 [error] [MainThread]: Encountered an error:
Runtime Error
  Compilation Error in model stg_partners (models/stating/stg_partners.sql)
    'unix_to_timestamp' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".


============================== 2023-01-06 02:06:03.109722 | b7886c4c-02c6-48d5-8fd4-e3482093695d ==============================
[0m02:06:03.109758 [info ] [MainThread]: Running with dbt=1.3.2
[0m02:06:03.110303 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joaopaulomedeiroscecilio/dev/dbt-data-analysis', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'parse_only': False, 'select': ['stg_partners'], 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m02:06:03.110421 [debug] [MainThread]: Tracking: tracking
[0m02:06:03.122186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138602d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138602e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138602e50>]}
[0m02:06:03.172138 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:06:03.172402 [debug] [MainThread]: Partial parsing: updated file: ggchallengejoao://macros/unix_to_timestamp.sql
[0m02:06:03.172505 [debug] [MainThread]: Parsing macros/unix_to_timestamp.sql
[0m02:06:03.180931 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ggchallengejoao.example

[0m02:06:03.184078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7886c4c-02c6-48d5-8fd4-e3482093695d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1389049a0>]}
[0m02:06:03.189733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7886c4c-02c6-48d5-8fd4-e3482093695d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13880eb80>]}
[0m02:06:03.189945 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 432 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m02:06:03.190100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7886c4c-02c6-48d5-8fd4-e3482093695d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1388be340>]}
[0m02:06:03.190815 [info ] [MainThread]: 
[0m02:06:03.191174 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m02:06:03.191699 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801_getgroundjoao"
[0m02:06:03.191820 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:06:04.446334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7886c4c-02c6-48d5-8fd4-e3482093695d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138602d30>]}
[0m02:06:04.447522 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:06:04.447969 [info ] [MainThread]: 
[0m02:06:04.453737 [debug] [Thread-1  ]: Began running node model.ggchallengejoao.stg_partners
[0m02:06:04.454700 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_partners"
[0m02:06:04.454997 [debug] [Thread-1  ]: Began compiling node model.ggchallengejoao.stg_partners
[0m02:06:04.455263 [debug] [Thread-1  ]: Compiling model.ggchallengejoao.stg_partners
[0m02:06:04.460351 [debug] [Thread-1  ]: Writing injected SQL for node "model.ggchallengejoao.stg_partners"
[0m02:06:04.461124 [debug] [Thread-1  ]: finished collecting timing info
[0m02:06:04.461275 [debug] [Thread-1  ]: Began executing node model.ggchallengejoao.stg_partners
[0m02:06:04.461389 [debug] [Thread-1  ]: finished collecting timing info
[0m02:06:04.461783 [debug] [Thread-1  ]: Finished running node model.ggchallengejoao.stg_partners
[0m02:06:04.462241 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:06:04.462320 [debug] [MainThread]: Connection 'model.ggchallengejoao.stg_partners' was properly closed.
[0m02:06:04.466951 [info ] [MainThread]: Done.
[0m02:06:04.467283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1388e0f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1388e0df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1388e0fa0>]}
[0m02:06:04.467536 [debug] [MainThread]: Flushing usage events


============================== 2023-01-06 02:08:31.422741 | 49e8d498-f713-4fd0-a358-5e052d14701b ==============================
[0m02:08:31.422782 [info ] [MainThread]: Running with dbt=1.3.2
[0m02:08:31.423546 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joaopaulomedeiroscecilio/dev/dbt-data-analysis', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:08:31.423667 [debug] [MainThread]: Tracking: tracking
[0m02:08:31.438223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12737ed60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12737ee80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12737eeb0>]}
[0m02:08:31.489025 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m02:08:31.489278 [debug] [MainThread]: Partial parsing: updated file: ggchallengejoao://models/stating/stg_partners.sql
[0m02:08:31.489428 [debug] [MainThread]: Partial parsing: updated file: ggchallengejoao://models/stating/stg_referrals.sql
[0m02:08:31.498200 [debug] [MainThread]: 1603: static parser failed on stating/stg_partners.sql
[0m02:08:31.505802 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stating/stg_partners.sql
[0m02:08:31.506558 [debug] [MainThread]: 1603: static parser failed on stating/stg_referrals.sql
[0m02:08:31.508857 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stating/stg_referrals.sql
[0m02:08:31.536128 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ggchallengejoao.example

[0m02:08:31.539150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49e8d498-f713-4fd0-a358-5e052d14701b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12769c0d0>]}
[0m02:08:31.545888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49e8d498-f713-4fd0-a358-5e052d14701b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1275cf580>]}
[0m02:08:31.546123 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 432 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m02:08:31.546273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49e8d498-f713-4fd0-a358-5e052d14701b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1273a7700>]}
[0m02:08:31.547051 [info ] [MainThread]: 
[0m02:08:31.547443 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m02:08:31.547933 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801"
[0m02:08:31.548090 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:08:33.233158 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801_getgroundjoao"
[0m02:08:33.233936 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:08:33.816923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49e8d498-f713-4fd0-a358-5e052d14701b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1275c4e80>]}
[0m02:08:33.818729 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:08:33.819613 [info ] [MainThread]: 
[0m02:08:33.827132 [debug] [Thread-1  ]: Began running node model.ggchallengejoao.stg_partners
[0m02:08:33.827391 [debug] [Thread-2  ]: Began running node model.ggchallengejoao.stg_referrals
[0m02:08:33.827915 [info ] [Thread-1  ]: 1 of 2 START sql table model getgroundjoao.stg_partners ........................ [RUN]
[0m02:08:33.828333 [info ] [Thread-2  ]: 2 of 2 START sql table model getgroundjoao.stg_referrals ....................... [RUN]
[0m02:08:33.829401 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_partners"
[0m02:08:33.830390 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_referrals"
[0m02:08:33.830688 [debug] [Thread-1  ]: Began compiling node model.ggchallengejoao.stg_partners
[0m02:08:33.830968 [debug] [Thread-2  ]: Began compiling node model.ggchallengejoao.stg_referrals
[0m02:08:33.831294 [debug] [Thread-1  ]: Compiling model.ggchallengejoao.stg_partners
[0m02:08:33.831516 [debug] [Thread-2  ]: Compiling model.ggchallengejoao.stg_referrals
[0m02:08:33.837388 [debug] [Thread-1  ]: Writing injected SQL for node "model.ggchallengejoao.stg_partners"
[0m02:08:33.842751 [debug] [Thread-2  ]: Writing injected SQL for node "model.ggchallengejoao.stg_referrals"
[0m02:08:33.843638 [debug] [Thread-2  ]: finished collecting timing info
[0m02:08:33.843819 [debug] [Thread-1  ]: finished collecting timing info
[0m02:08:33.844036 [debug] [Thread-2  ]: Began executing node model.ggchallengejoao.stg_referrals
[0m02:08:33.844246 [debug] [Thread-1  ]: Began executing node model.ggchallengejoao.stg_partners
[0m02:08:33.866268 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:08:33.874349 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m02:08:34.365804 [debug] [Thread-1  ]: Writing runtime sql for node "model.ggchallengejoao.stg_partners"
[0m02:08:34.367041 [debug] [Thread-2  ]: Writing runtime sql for node "model.ggchallengejoao.stg_referrals"
[0m02:08:34.368686 [debug] [Thread-2  ]: On model.ggchallengejoao.stg_referrals: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.stg_referrals"} */

  
    

    create or replace table `dynamic-point-367801`.`getgroundjoao`.`stg_referrals`
    
    
    OPTIONS()
    as (
      

select
    *,
    
timestamp_micros(cast(created_at/ 1000 as int64))
 as referral_created_at_timestamp,
    
timestamp_micros(cast(updated_at/ 1000 as int64))
 as referral_updated_at_timestamp
from `dynamic-point-367801`.`getgroundjoao`.`referrals`
    );
  
[0m02:08:34.368845 [debug] [Thread-1  ]: On model.ggchallengejoao.stg_partners: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.stg_partners"} */

  
    

    create or replace table `dynamic-point-367801`.`getgroundjoao`.`stg_partners`
    
    
    OPTIONS()
    as (
      

select *
except
    (lead_sales_contact),
    if(
        lead_sales_contact = '0', 'No contact', lead_sales_contact
    ) as lead_sales_contact,
    
timestamp_micros(cast(created_at/ 1000 as int64))
 as partner_created_at_timestamp,
    
timestamp_micros(cast(updated_at/ 1000 as int64))
 as partner_updated_at_timestamp
from `dynamic-point-367801`.`getgroundjoao`.`partners`
    );
  
[0m02:08:37.015358 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:05cd1541-57a4-41e4-a56f-4d2f54cde7d3:EU&page=queryresults
[0m02:08:37.026723 [debug] [Thread-1  ]: finished collecting timing info
[0m02:08:37.027367 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49e8d498-f713-4fd0-a358-5e052d14701b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1274964c0>]}
[0m02:08:37.027737 [info ] [Thread-1  ]: 1 of 2 OK created sql table model getgroundjoao.stg_partners ................... [[32mCREATE TABLE (522.0 rows, 19.5 KB processed)[0m in 3.20s]
[0m02:08:37.028214 [debug] [Thread-1  ]: Finished running node model.ggchallengejoao.stg_partners
[0m02:08:38.704305 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:24f612c1-a47f-4844-9b3d-89b32ed39ca0:EU&page=queryresults
[0m02:08:38.708195 [debug] [Thread-2  ]: finished collecting timing info
[0m02:08:38.709690 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49e8d498-f713-4fd0-a358-5e052d14701b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12776d880>]}
[0m02:08:38.710421 [info ] [Thread-2  ]: 2 of 2 OK created sql table model getgroundjoao.stg_referrals .................. [[32mCREATE TABLE (1.5k rows, 96.2 KB processed)[0m in 4.88s]
[0m02:08:38.711301 [debug] [Thread-2  ]: Finished running node model.ggchallengejoao.stg_referrals
[0m02:08:38.713774 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m02:08:38.714667 [info ] [MainThread]: 
[0m02:08:38.715091 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 7.17 seconds (7.17s).
[0m02:08:38.715457 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:08:38.715641 [debug] [MainThread]: Connection 'model.ggchallengejoao.stg_partners' was properly closed.
[0m02:08:38.715820 [debug] [MainThread]: Connection 'model.ggchallengejoao.stg_referrals' was properly closed.
[0m02:08:38.729484 [info ] [MainThread]: 
[0m02:08:38.729950 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:08:38.730288 [info ] [MainThread]: 
[0m02:08:38.730592 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m02:08:38.731150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1275bb4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12755fe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12755fbe0>]}
[0m02:08:38.731560 [debug] [MainThread]: Flushing usage events


============================== 2023-01-06 02:22:01.922291 | d256abba-0d1b-4eb4-b3c1-c6698ed620b4 ==============================
[0m02:22:01.922314 [info ] [MainThread]: Running with dbt=1.3.2
[0m02:22:01.922914 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joaopaulomedeiroscecilio/dev/dbt-data-analysis', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:22:01.923037 [debug] [MainThread]: Tracking: tracking
[0m02:22:01.940054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cf3ed90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cf3eeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cf3eee0>]}
[0m02:22:01.992850 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m02:22:01.993083 [debug] [MainThread]: Partial parsing: added file: ggchallengejoao://models/marts/dim_sales_country.sql
[0m02:22:02.002055 [debug] [MainThread]: 1699: static parser successfully parsed marts/dim_sales_country.sql
[0m02:22:02.015917 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ggchallengejoao.example

[0m02:22:02.019196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd256abba-0d1b-4eb4-b3c1-c6698ed620b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12daa9f10>]}
[0m02:22:02.024947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd256abba-0d1b-4eb4-b3c1-c6698ed620b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12da20e20>]}
[0m02:22:02.025118 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 432 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m02:22:02.025254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd256abba-0d1b-4eb4-b3c1-c6698ed620b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12da20fa0>]}
[0m02:22:02.026002 [info ] [MainThread]: 
[0m02:22:02.026356 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m02:22:02.026865 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801"
[0m02:22:02.026992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:22:04.140682 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801_getgroundjoao"
[0m02:22:04.141141 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:22:04.921937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd256abba-0d1b-4eb4-b3c1-c6698ed620b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cf3ed90>]}
[0m02:22:04.922778 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:22:04.923041 [info ] [MainThread]: 
[0m02:22:04.928269 [debug] [Thread-1  ]: Began running node model.ggchallengejoao.dim_sales_country
[0m02:22:04.928409 [debug] [Thread-2  ]: Began running node model.ggchallengejoao.stg_partners
[0m02:22:04.928518 [debug] [Thread-3  ]: Began running node model.ggchallengejoao.stg_referrals
[0m02:22:04.928770 [info ] [Thread-1  ]: 1 of 3 START sql view model getgroundjoao.dim_sales_country .................... [RUN]
[0m02:22:04.928962 [info ] [Thread-2  ]: 2 of 3 START sql table model getgroundjoao.stg_partners ........................ [RUN]
[0m02:22:04.929122 [info ] [Thread-3  ]: 3 of 3 START sql table model getgroundjoao.stg_referrals ....................... [RUN]
[0m02:22:04.929595 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.ggchallengejoao.dim_sales_country"
[0m02:22:04.930080 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_partners"
[0m02:22:04.930493 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_referrals"
[0m02:22:04.930641 [debug] [Thread-1  ]: Began compiling node model.ggchallengejoao.dim_sales_country
[0m02:22:04.930801 [debug] [Thread-2  ]: Began compiling node model.ggchallengejoao.stg_partners
[0m02:22:04.930920 [debug] [Thread-3  ]: Began compiling node model.ggchallengejoao.stg_referrals
[0m02:22:04.931085 [debug] [Thread-1  ]: Compiling model.ggchallengejoao.dim_sales_country
[0m02:22:04.931339 [debug] [Thread-2  ]: Compiling model.ggchallengejoao.stg_partners
[0m02:22:04.931447 [debug] [Thread-3  ]: Compiling model.ggchallengejoao.stg_referrals
[0m02:22:04.934841 [debug] [Thread-1  ]: Writing injected SQL for node "model.ggchallengejoao.dim_sales_country"
[0m02:22:04.938341 [debug] [Thread-2  ]: Writing injected SQL for node "model.ggchallengejoao.stg_partners"
[0m02:22:04.940562 [debug] [Thread-1  ]: finished collecting timing info
[0m02:22:04.940854 [debug] [Thread-1  ]: Began executing node model.ggchallengejoao.dim_sales_country
[0m02:22:04.943300 [debug] [Thread-3  ]: Writing injected SQL for node "model.ggchallengejoao.stg_referrals"
[0m02:22:04.950053 [debug] [Thread-2  ]: finished collecting timing info
[0m02:22:04.972940 [debug] [Thread-1  ]: Writing runtime sql for node "model.ggchallengejoao.dim_sales_country"
[0m02:22:04.973259 [debug] [Thread-2  ]: Began executing node model.ggchallengejoao.stg_partners
[0m02:22:04.980245 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m02:22:04.980607 [debug] [Thread-3  ]: finished collecting timing info
[0m02:22:04.981220 [debug] [Thread-3  ]: Began executing node model.ggchallengejoao.stg_referrals
[0m02:22:04.981480 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:22:04.983214 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m02:22:04.983413 [debug] [Thread-1  ]: On model.ggchallengejoao.dim_sales_country: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.dim_sales_country"} */


  create or replace view `dynamic-point-367801`.`getgroundjoao`.`dim_sales_country`
  OPTIONS()
  as  select * from `dynamic-point-367801`.`getgroundjoao`.`sales_people`;


[0m02:22:05.454145 [debug] [Thread-2  ]: Writing runtime sql for node "model.ggchallengejoao.stg_partners"
[0m02:22:05.454569 [debug] [Thread-2  ]: On model.ggchallengejoao.stg_partners: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.stg_partners"} */

  
    

    create or replace table `dynamic-point-367801`.`getgroundjoao`.`stg_partners`
    
    
    OPTIONS()
    as (
      

select *
except
    (lead_sales_contact),
    if(
        lead_sales_contact = '0', 'No contact', lead_sales_contact
    ) as lead_sales_contact,
    
timestamp_micros(cast(created_at/ 1000 as int64))
 as partner_created_at_timestamp,
    
timestamp_micros(cast(updated_at/ 1000 as int64))
 as partner_updated_at_timestamp
from `dynamic-point-367801`.`getgroundjoao`.`partners`
    );
  
[0m02:22:05.822119 [debug] [Thread-3  ]: Writing runtime sql for node "model.ggchallengejoao.stg_referrals"
[0m02:22:05.822950 [debug] [Thread-3  ]: On model.ggchallengejoao.stg_referrals: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.stg_referrals"} */

  
    

    create or replace table `dynamic-point-367801`.`getgroundjoao`.`stg_referrals`
    
    
    OPTIONS()
    as (
      

select
    *,
    
timestamp_micros(cast(created_at/ 1000 as int64))
 as referral_created_at_timestamp,
    
timestamp_micros(cast(updated_at/ 1000 as int64))
 as referral_updated_at_timestamp
from `dynamic-point-367801`.`getgroundjoao`.`referrals`
    );
  
[0m02:22:06.315799 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:16a12fd8-8737-4e4a-83ca-5440f7748397:EU&page=queryresults
[0m02:22:06.323484 [debug] [Thread-1  ]: finished collecting timing info
[0m02:22:06.323884 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd256abba-0d1b-4eb4-b3c1-c6698ed620b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12dc1d7f0>]}
[0m02:22:06.324108 [info ] [Thread-1  ]: 1 of 3 OK created sql view model getgroundjoao.dim_sales_country ............... [[32mCREATE VIEW (0 processed)[0m in 1.39s]
[0m02:22:06.324357 [debug] [Thread-1  ]: Finished running node model.ggchallengejoao.dim_sales_country
[0m02:22:08.030726 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:838948ef-d8b0-4ecc-83d7-bde46ed6a883:EU&page=queryresults
[0m02:22:08.034828 [debug] [Thread-2  ]: finished collecting timing info
[0m02:22:08.035389 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd256abba-0d1b-4eb4-b3c1-c6698ed620b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12dc0f610>]}
[0m02:22:08.035757 [info ] [Thread-2  ]: 2 of 3 OK created sql table model getgroundjoao.stg_partners ................... [[32mCREATE TABLE (522.0 rows, 19.5 KB processed)[0m in 3.11s]
[0m02:22:08.036179 [debug] [Thread-2  ]: Finished running node model.ggchallengejoao.stg_partners
[0m02:22:08.504881 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:ab790564-abdb-4783-9efa-000bf2c17634:EU&page=queryresults
[0m02:22:08.506166 [debug] [Thread-3  ]: finished collecting timing info
[0m02:22:08.506560 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd256abba-0d1b-4eb4-b3c1-c6698ed620b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12dca9fd0>]}
[0m02:22:08.506786 [info ] [Thread-3  ]: 3 of 3 OK created sql table model getgroundjoao.stg_referrals .................. [[32mCREATE TABLE (1.5k rows, 96.2 KB processed)[0m in 3.58s]
[0m02:22:08.507131 [debug] [Thread-3  ]: Finished running node model.ggchallengejoao.stg_referrals
[0m02:22:08.508860 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m02:22:08.509685 [info ] [MainThread]: 
[0m02:22:08.509911 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 6.48 seconds (6.48s).
[0m02:22:08.510063 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:22:08.510133 [debug] [MainThread]: Connection 'model.ggchallengejoao.dim_sales_country' was properly closed.
[0m02:22:08.510197 [debug] [MainThread]: Connection 'model.ggchallengejoao.stg_partners' was properly closed.
[0m02:22:08.510259 [debug] [MainThread]: Connection 'model.ggchallengejoao.stg_referrals' was properly closed.
[0m02:22:08.522284 [info ] [MainThread]: 
[0m02:22:08.522550 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:22:08.522714 [info ] [MainThread]: 
[0m02:22:08.522834 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m02:22:08.523113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cf66f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12da20fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12dc87220>]}
[0m02:22:08.523260 [debug] [MainThread]: Flushing usage events


============================== 2023-01-06 02:31:45.074467 | 18d96528-80c6-4064-9af5-466004e399c6 ==============================
[0m02:31:45.074499 [info ] [MainThread]: Running with dbt=1.3.2
[0m02:31:45.075217 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joaopaulomedeiroscecilio/dev/dbt-data-analysis', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:31:45.075335 [debug] [MainThread]: Tracking: tracking
[0m02:31:45.096183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1212fed30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1212fee50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1212fee80>]}
[0m02:31:45.164607 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m02:31:45.164989 [debug] [MainThread]: Partial parsing: update schema file: ggchallengejoao://models/schema.yml
[0m02:31:45.165136 [debug] [MainThread]: Partial parsing: updated file: ggchallengejoao://models/stating/stg_partners.sql
[0m02:31:45.165241 [debug] [MainThread]: Partial parsing: updated file: ggchallengejoao://models/stating/stg_referrals.sql
[0m02:31:45.173259 [debug] [MainThread]: 1603: static parser failed on stating/stg_referrals.sql
[0m02:31:45.180539 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stating/stg_referrals.sql
[0m02:31:45.181218 [debug] [MainThread]: 1603: static parser failed on stating/stg_partners.sql
[0m02:31:45.183544 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stating/stg_partners.sql
[0m02:31:45.211581 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ggchallengejoao.example

[0m02:31:45.214738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18d96528-80c6-4064-9af5-466004e399c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127a1be80>]}
[0m02:31:45.221655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18d96528-80c6-4064-9af5-466004e399c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127810f40>]}
[0m02:31:45.221837 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 432 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m02:31:45.221978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18d96528-80c6-4064-9af5-466004e399c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127810e80>]}
[0m02:31:45.222741 [info ] [MainThread]: 
[0m02:31:45.223099 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m02:31:45.223597 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801"
[0m02:31:45.223727 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:31:47.225496 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801_getgroundjoao"
[0m02:31:47.225801 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:31:48.100589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18d96528-80c6-4064-9af5-466004e399c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127850be0>]}
[0m02:31:48.102381 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:31:48.102995 [info ] [MainThread]: 
[0m02:31:48.114971 [debug] [Thread-1  ]: Began running node model.ggchallengejoao.dim_sales_country
[0m02:31:48.115233 [debug] [Thread-2  ]: Began running node model.ggchallengejoao.stg_partners
[0m02:31:48.115592 [debug] [Thread-3  ]: Began running node model.ggchallengejoao.stg_referrals
[0m02:31:48.116620 [info ] [Thread-1  ]: 1 of 3 START sql view model getgroundjoao.dim_sales_country .................... [RUN]
[0m02:31:48.117086 [info ] [Thread-2  ]: 2 of 3 START sql table model getgroundjoao.stg_partners ........................ [RUN]
[0m02:31:48.117450 [info ] [Thread-3  ]: 3 of 3 START sql table model getgroundjoao.stg_referrals ....................... [RUN]
[0m02:31:48.118511 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.ggchallengejoao.dim_sales_country"
[0m02:31:48.119283 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_partners"
[0m02:31:48.120295 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_referrals"
[0m02:31:48.120640 [debug] [Thread-1  ]: Began compiling node model.ggchallengejoao.dim_sales_country
[0m02:31:48.120934 [debug] [Thread-2  ]: Began compiling node model.ggchallengejoao.stg_partners
[0m02:31:48.121153 [debug] [Thread-3  ]: Began compiling node model.ggchallengejoao.stg_referrals
[0m02:31:48.122669 [debug] [Thread-1  ]: Compiling model.ggchallengejoao.dim_sales_country
[0m02:31:48.123554 [debug] [Thread-2  ]: Compiling model.ggchallengejoao.stg_partners
[0m02:31:48.123818 [debug] [Thread-3  ]: Compiling model.ggchallengejoao.stg_referrals
[0m02:31:48.141604 [debug] [Thread-1  ]: Writing injected SQL for node "model.ggchallengejoao.dim_sales_country"
[0m02:31:48.145306 [debug] [Thread-2  ]: Writing injected SQL for node "model.ggchallengejoao.stg_partners"
[0m02:31:48.150429 [debug] [Thread-3  ]: Writing injected SQL for node "model.ggchallengejoao.stg_referrals"
[0m02:31:48.151610 [debug] [Thread-1  ]: finished collecting timing info
[0m02:31:48.151901 [debug] [Thread-1  ]: Began executing node model.ggchallengejoao.dim_sales_country
[0m02:31:48.152052 [debug] [Thread-2  ]: finished collecting timing info
[0m02:31:48.152170 [debug] [Thread-3  ]: finished collecting timing info
[0m02:31:48.155202 [debug] [Thread-2  ]: Began executing node model.ggchallengejoao.stg_partners
[0m02:31:48.155438 [debug] [Thread-3  ]: Began executing node model.ggchallengejoao.stg_referrals
[0m02:31:48.170212 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m02:31:48.178559 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m02:31:48.197418 [debug] [Thread-1  ]: Writing runtime sql for node "model.ggchallengejoao.dim_sales_country"
[0m02:31:48.200688 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:31:48.201022 [debug] [Thread-1  ]: On model.ggchallengejoao.dim_sales_country: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.dim_sales_country"} */


  create or replace view `dynamic-point-367801`.`getgroundjoao`.`dim_sales_country`
  OPTIONS()
  as  select * from `dynamic-point-367801`.`getgroundjoao`.`sales_people`;


[0m02:31:48.671022 [debug] [Thread-3  ]: Writing runtime sql for node "model.ggchallengejoao.stg_referrals"
[0m02:31:48.672292 [debug] [Thread-3  ]: On model.ggchallengejoao.stg_referrals: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.stg_referrals"} */

  
    

    create or replace table `dynamic-point-367801`.`getgroundjoao`.`stg_referrals`
    
    
    OPTIONS()
    as (
      

select *
except
    (created_at, updated_at),
    
timestamp_micros(cast(created_at/ 1000 as int64))
 as referral_created_at_timestamp,
    
timestamp_micros(cast(updated_at/ 1000 as int64))
 as referral_updated_at_timestamp
from `dynamic-point-367801`.`getgroundjoao`.`referrals`
    );
  
[0m02:31:48.688934 [debug] [Thread-2  ]: Writing runtime sql for node "model.ggchallengejoao.stg_partners"
[0m02:31:48.689744 [debug] [Thread-2  ]: On model.ggchallengejoao.stg_partners: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.stg_partners"} */

  
    

    create or replace table `dynamic-point-367801`.`getgroundjoao`.`stg_partners`
    
    
    OPTIONS()
    as (
      

select *
except
    (lead_sales_contact, created_at, updated_at),
    if(
        lead_sales_contact = '0', 'No contact', lead_sales_contact
    ) as lead_sales_contact,
    
timestamp_micros(cast(created_at/ 1000 as int64))
 as partner_created_at_timestamp,
    
timestamp_micros(cast(updated_at/ 1000 as int64))
 as partner_updated_at_timestamp
from `dynamic-point-367801`.`getgroundjoao`.`partners`
    );
  
[0m02:31:49.721375 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:a2f2793a-4810-43db-a10a-635e92dde21d:EU&page=queryresults
[0m02:31:49.749955 [debug] [Thread-1  ]: finished collecting timing info
[0m02:31:49.751251 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18d96528-80c6-4064-9af5-466004e399c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127b0b1c0>]}
[0m02:31:49.751969 [info ] [Thread-1  ]: 1 of 3 OK created sql view model getgroundjoao.dim_sales_country ............... [[32mCREATE VIEW (0 processed)[0m in 1.63s]
[0m02:31:49.752769 [debug] [Thread-1  ]: Finished running node model.ggchallengejoao.dim_sales_country
[0m02:31:51.447598 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:65f94824-0952-4368-ba28-fa02bbcea486:EU&page=queryresults
[0m02:31:51.449439 [debug] [Thread-3  ]: finished collecting timing info
[0m02:31:51.450112 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18d96528-80c6-4064-9af5-466004e399c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1278b7a30>]}
[0m02:31:51.450469 [info ] [Thread-3  ]: 3 of 3 OK created sql table model getgroundjoao.stg_referrals .................. [[32mCREATE TABLE (1.5k rows, 96.2 KB processed)[0m in 3.33s]
[0m02:31:51.450992 [debug] [Thread-3  ]: Finished running node model.ggchallengejoao.stg_referrals
[0m02:31:51.574899 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:09215f07-8060-4da2-97ce-c30dfa9e77d8:EU&page=queryresults
[0m02:31:51.576144 [debug] [Thread-2  ]: finished collecting timing info
[0m02:31:51.576697 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18d96528-80c6-4064-9af5-466004e399c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127a91fd0>]}
[0m02:31:51.577000 [info ] [Thread-2  ]: 2 of 3 OK created sql table model getgroundjoao.stg_partners ................... [[32mCREATE TABLE (522.0 rows, 19.5 KB processed)[0m in 3.46s]
[0m02:31:51.577358 [debug] [Thread-2  ]: Finished running node model.ggchallengejoao.stg_partners
[0m02:31:51.579286 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m02:31:51.580041 [info ] [MainThread]: 
[0m02:31:51.580456 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 6.36 seconds (6.36s).
[0m02:31:51.580733 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:31:51.580849 [debug] [MainThread]: Connection 'model.ggchallengejoao.dim_sales_country' was properly closed.
[0m02:31:51.580952 [debug] [MainThread]: Connection 'model.ggchallengejoao.stg_partners' was properly closed.
[0m02:31:51.581049 [debug] [MainThread]: Connection 'model.ggchallengejoao.stg_referrals' was properly closed.
[0m02:31:51.589483 [info ] [MainThread]: 
[0m02:31:51.589760 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:31:51.589959 [info ] [MainThread]: 
[0m02:31:51.590135 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m02:31:51.590424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127a91fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127a1b2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1278566a0>]}
[0m02:31:51.590637 [debug] [MainThread]: Flushing usage events


============================== 2023-01-06 14:09:17.931787 | 5860c3dd-f071-4424-8569-7c418dde6f92 ==============================
[0m14:09:17.931808 [info ] [MainThread]: Running with dbt=1.3.2
[0m14:09:17.932484 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joaopaulomedeiroscecilio/dev/ggchallenge/ggchallengejoao', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/Users/joaopaulomedeiroscecilio/dev/ggchallenge/ggchallengejoao', 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m14:09:17.932682 [debug] [MainThread]: Tracking: tracking
[0m14:09:17.945706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c02e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c02190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c02340>]}
[0m14:09:17.974363 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m14:09:17.974661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5860c3dd-f071-4424-8569-7c418dde6f92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c300d0>]}
[0m14:09:18.013064 [debug] [MainThread]: Parsing macros/unix_to_timestamp.sql
[0m14:09:18.013535 [debug] [MainThread]: Parsing macros/etc.sql
[0m14:09:18.014697 [debug] [MainThread]: Parsing macros/catalog.sql
[0m14:09:18.017970 [debug] [MainThread]: Parsing macros/adapters.sql
[0m14:09:18.028547 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m14:09:18.029850 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m14:09:18.031214 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m14:09:18.034741 [debug] [MainThread]: Parsing macros/materializations/copy.sql
[0m14:09:18.035990 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m14:09:18.044639 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m14:09:18.045468 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m14:09:18.045648 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m14:09:18.045950 [debug] [MainThread]: Parsing macros/utils/timestamps.sql
[0m14:09:18.046433 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m14:09:18.046603 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m14:09:18.046864 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m14:09:18.047160 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m14:09:18.047611 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m14:09:18.048172 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m14:09:18.048405 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m14:09:18.048633 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m14:09:18.048878 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m14:09:18.049116 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m14:09:18.049317 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m14:09:18.050032 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m14:09:18.050282 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m14:09:18.050671 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m14:09:18.050955 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m14:09:18.052129 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m14:09:18.053877 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m14:09:18.055038 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m14:09:18.055862 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m14:09:18.064255 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m14:09:18.071226 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m14:09:18.077132 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m14:09:18.079336 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m14:09:18.080215 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m14:09:18.081052 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m14:09:18.084925 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m14:09:18.092799 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m14:09:18.093565 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m14:09:18.096584 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m14:09:18.101436 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m14:09:18.109638 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m14:09:18.112184 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m14:09:18.113774 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m14:09:18.116303 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m14:09:18.116881 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m14:09:18.118419 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m14:09:18.119439 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m14:09:18.122807 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m14:09:18.131591 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m14:09:18.132271 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m14:09:18.133379 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m14:09:18.134081 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m14:09:18.134492 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m14:09:18.134857 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m14:09:18.135170 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m14:09:18.135789 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m14:09:18.138219 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m14:09:18.142107 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m14:09:18.142490 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m14:09:18.143045 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m14:09:18.143481 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m14:09:18.143934 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m14:09:18.144508 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m14:09:18.144885 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m14:09:18.145372 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m14:09:18.145931 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m14:09:18.146991 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m14:09:18.147554 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m14:09:18.148044 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m14:09:18.148520 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m14:09:18.148988 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m14:09:18.149402 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m14:09:18.149888 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m14:09:18.150293 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m14:09:18.153327 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m14:09:18.153804 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m14:09:18.154216 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m14:09:18.155024 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m14:09:18.156027 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m14:09:18.156496 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m14:09:18.157175 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m14:09:18.157656 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m14:09:18.158635 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m14:09:18.160111 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m14:09:18.161360 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m14:09:18.168378 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m14:09:18.169275 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m14:09:18.175527 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m14:09:18.177515 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m14:09:18.180776 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m14:09:18.185319 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m14:09:18.188254 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m14:09:18.189628 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m14:09:18.190589 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m14:09:18.191817 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m14:09:18.192589 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m14:09:18.194703 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m14:09:18.196658 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m14:09:18.197731 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m14:09:18.199525 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m14:09:18.201165 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m14:09:18.202508 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m14:09:18.203662 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m14:09:18.204731 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m14:09:18.206202 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m14:09:18.207208 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m14:09:18.208071 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m14:09:18.209780 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m14:09:18.211679 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m14:09:18.213336 [debug] [MainThread]: Parsing macros/generic_tests/not_empty_string.sql
[0m14:09:18.214187 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m14:09:18.219304 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m14:09:18.219856 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_relation.sql
[0m14:09:18.220379 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m14:09:18.220918 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m14:09:18.221422 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m14:09:18.222105 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_ephemeral.sql
[0m14:09:18.222989 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m14:09:18.224933 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m14:09:18.225661 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m14:09:18.227308 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m14:09:18.229293 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m14:09:18.230855 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m14:09:18.231639 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m14:09:18.234286 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m14:09:18.237252 [debug] [MainThread]: Parsing macros/sql/safe_divide.sql
[0m14:09:18.237744 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m14:09:18.244149 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m14:09:18.244762 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m14:09:18.246489 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m14:09:18.247176 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m14:09:18.248184 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m14:09:18.248916 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m14:09:18.252162 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m14:09:18.254780 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m14:09:18.256708 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m14:09:18.257957 [debug] [MainThread]: Parsing macros/sql/width_bucket.sql
[0m14:09:18.260455 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m14:09:18.261498 [debug] [MainThread]: Parsing macros/sql/generate_surrogate_key.sql
[0m14:09:18.262656 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m14:09:18.263374 [debug] [MainThread]: Parsing macros/sql/get_single_value.sql
[0m14:09:18.264766 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m14:09:18.585324 [debug] [MainThread]: 1603: static parser failed on stating/stg_referrals.sql
[0m14:09:18.593189 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stating/stg_referrals.sql
[0m14:09:18.594005 [debug] [MainThread]: 1603: static parser failed on stating/stg_partners.sql
[0m14:09:18.596412 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stating/stg_partners.sql
[0m14:09:18.597059 [debug] [MainThread]: 1699: static parser successfully parsed marts/dim_sales_country.sql
[0m14:09:18.672702 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ggchallengejoao.example

[0m14:09:18.676069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5860c3dd-f071-4424-8569-7c418dde6f92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e3c250>]}
[0m14:09:18.682084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5860c3dd-f071-4424-8569-7c418dde6f92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f29f70>]}
[0m14:09:18.682290 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 432 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m14:09:18.682436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5860c3dd-f071-4424-8569-7c418dde6f92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ef8610>]}
[0m14:09:18.683128 [info ] [MainThread]: 
[0m14:09:18.683463 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:09:18.683984 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801_getgroundjoao"
[0m14:09:18.684098 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:09:20.163386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5860c3dd-f071-4424-8569-7c418dde6f92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e3c5e0>]}
[0m14:09:20.164897 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:09:20.165343 [info ] [MainThread]: 
[0m14:09:20.174609 [debug] [Thread-1  ]: Began running node seed.ggchallengejoao.partners
[0m14:09:20.174907 [debug] [Thread-2  ]: Began running node seed.ggchallengejoao.referrals
[0m14:09:20.175094 [debug] [Thread-3  ]: Began running node seed.ggchallengejoao.sales_people
[0m14:09:20.176031 [debug] [Thread-1  ]: Acquiring new bigquery connection "seed.ggchallengejoao.partners"
[0m14:09:20.176897 [debug] [Thread-2  ]: Acquiring new bigquery connection "seed.ggchallengejoao.referrals"
[0m14:09:20.177865 [debug] [Thread-3  ]: Acquiring new bigquery connection "seed.ggchallengejoao.sales_people"
[0m14:09:20.178220 [debug] [Thread-1  ]: Began compiling node seed.ggchallengejoao.partners
[0m14:09:20.178461 [debug] [Thread-2  ]: Began compiling node seed.ggchallengejoao.referrals
[0m14:09:20.178685 [debug] [Thread-3  ]: Began compiling node seed.ggchallengejoao.sales_people
[0m14:09:20.179138 [debug] [Thread-1  ]: Compiling seed.ggchallengejoao.partners
[0m14:09:20.179385 [debug] [Thread-2  ]: Compiling seed.ggchallengejoao.referrals
[0m14:09:20.179619 [debug] [Thread-3  ]: Compiling seed.ggchallengejoao.sales_people
[0m14:09:20.185038 [debug] [Thread-1  ]: Writing injected SQL for node "seed.ggchallengejoao.partners"
[0m14:09:20.186856 [debug] [Thread-2  ]: Writing injected SQL for node "seed.ggchallengejoao.referrals"
[0m14:09:20.188070 [debug] [Thread-3  ]: Writing injected SQL for node "seed.ggchallengejoao.sales_people"
[0m14:09:20.188231 [debug] [Thread-1  ]: finished collecting timing info
[0m14:09:20.188340 [debug] [Thread-2  ]: finished collecting timing info
[0m14:09:20.188431 [debug] [Thread-3  ]: finished collecting timing info
[0m14:09:20.188539 [debug] [Thread-1  ]: Began executing node seed.ggchallengejoao.partners
[0m14:09:20.188628 [debug] [Thread-2  ]: Began executing node seed.ggchallengejoao.referrals
[0m14:09:20.188712 [debug] [Thread-3  ]: Began executing node seed.ggchallengejoao.sales_people
[0m14:09:20.188820 [debug] [Thread-1  ]: finished collecting timing info
[0m14:09:20.188902 [debug] [Thread-2  ]: finished collecting timing info
[0m14:09:20.188981 [debug] [Thread-3  ]: finished collecting timing info
[0m14:09:20.189385 [debug] [Thread-1  ]: Finished running node seed.ggchallengejoao.partners
[0m14:09:20.189715 [debug] [Thread-2  ]: Finished running node seed.ggchallengejoao.referrals
[0m14:09:20.190003 [debug] [Thread-3  ]: Finished running node seed.ggchallengejoao.sales_people
[0m14:09:20.190272 [debug] [Thread-4  ]: Began running node model.ggchallengejoao.stg_partners
[0m14:09:20.190437 [debug] [Thread-1  ]: Began running node model.ggchallengejoao.stg_referrals
[0m14:09:20.190585 [debug] [Thread-2  ]: Began running node model.ggchallengejoao.dim_sales_country
[0m14:09:20.190836 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_partners"
[0m14:09:20.191111 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_referrals"
[0m14:09:20.191364 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.ggchallengejoao.dim_sales_country"
[0m14:09:20.191462 [debug] [Thread-4  ]: Began compiling node model.ggchallengejoao.stg_partners
[0m14:09:20.191568 [debug] [Thread-1  ]: Began compiling node model.ggchallengejoao.stg_referrals
[0m14:09:20.191656 [debug] [Thread-2  ]: Began compiling node model.ggchallengejoao.dim_sales_country
[0m14:09:20.191745 [debug] [Thread-4  ]: Compiling model.ggchallengejoao.stg_partners
[0m14:09:20.191827 [debug] [Thread-1  ]: Compiling model.ggchallengejoao.stg_referrals
[0m14:09:20.191902 [debug] [Thread-2  ]: Compiling model.ggchallengejoao.dim_sales_country
[0m14:09:20.194517 [debug] [Thread-4  ]: Writing injected SQL for node "model.ggchallengejoao.stg_partners"
[0m14:09:20.196719 [debug] [Thread-1  ]: Writing injected SQL for node "model.ggchallengejoao.stg_referrals"
[0m14:09:20.198435 [debug] [Thread-2  ]: Writing injected SQL for node "model.ggchallengejoao.dim_sales_country"
[0m14:09:20.200113 [debug] [Thread-1  ]: finished collecting timing info
[0m14:09:20.200202 [debug] [Thread-2  ]: finished collecting timing info
[0m14:09:20.200288 [debug] [Thread-4  ]: finished collecting timing info
[0m14:09:20.200363 [debug] [Thread-1  ]: Began executing node model.ggchallengejoao.stg_referrals
[0m14:09:20.200457 [debug] [Thread-2  ]: Began executing node model.ggchallengejoao.dim_sales_country
[0m14:09:20.200542 [debug] [Thread-4  ]: Began executing node model.ggchallengejoao.stg_partners
[0m14:09:20.200664 [debug] [Thread-1  ]: finished collecting timing info
[0m14:09:20.200787 [debug] [Thread-2  ]: finished collecting timing info
[0m14:09:20.200881 [debug] [Thread-4  ]: finished collecting timing info
[0m14:09:20.201270 [debug] [Thread-1  ]: Finished running node model.ggchallengejoao.stg_referrals
[0m14:09:20.201607 [debug] [Thread-2  ]: Finished running node model.ggchallengejoao.dim_sales_country
[0m14:09:20.201968 [debug] [Thread-4  ]: Finished running node model.ggchallengejoao.stg_partners
[0m14:09:20.202241 [debug] [Thread-3  ]: Began running node test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f
[0m14:09:20.202342 [debug] [Thread-1  ]: Began running node test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53
[0m14:09:20.203283 [debug] [Thread-2  ]: Began running node test.ggchallengejoao.not_null_stg_referrals_id.f511791502
[0m14:09:20.203427 [debug] [Thread-4  ]: Began running node test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f
[0m14:09:20.203745 [debug] [Thread-3  ]: Acquiring new bigquery connection "test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f"
[0m14:09:20.204023 [debug] [Thread-1  ]: Acquiring new bigquery connection "test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53"
[0m14:09:20.204294 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.ggchallengejoao.not_null_stg_referrals_id.f511791502"
[0m14:09:20.204561 [debug] [Thread-4  ]: Acquiring new bigquery connection "test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f"
[0m14:09:20.204660 [debug] [Thread-3  ]: Began compiling node test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f
[0m14:09:20.204753 [debug] [Thread-1  ]: Began compiling node test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53
[0m14:09:20.204842 [debug] [Thread-2  ]: Began compiling node test.ggchallengejoao.not_null_stg_referrals_id.f511791502
[0m14:09:20.204930 [debug] [Thread-4  ]: Began compiling node test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f
[0m14:09:20.205021 [debug] [Thread-3  ]: Compiling test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f
[0m14:09:20.205106 [debug] [Thread-1  ]: Compiling test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53
[0m14:09:20.205192 [debug] [Thread-2  ]: Compiling test.ggchallengejoao.not_null_stg_referrals_id.f511791502
[0m14:09:20.205354 [debug] [Thread-4  ]: Compiling test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f
[0m14:09:20.208654 [debug] [Thread-3  ]: Writing injected SQL for node "test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f"
[0m14:09:20.212312 [debug] [Thread-1  ]: Writing injected SQL for node "test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53"
[0m14:09:20.217977 [debug] [Thread-2  ]: Writing injected SQL for node "test.ggchallengejoao.not_null_stg_referrals_id.f511791502"
[0m14:09:20.222136 [debug] [Thread-4  ]: Writing injected SQL for node "test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f"
[0m14:09:20.223545 [debug] [Thread-2  ]: finished collecting timing info
[0m14:09:20.223653 [debug] [Thread-4  ]: finished collecting timing info
[0m14:09:20.223733 [debug] [Thread-1  ]: finished collecting timing info
[0m14:09:20.223834 [debug] [Thread-3  ]: finished collecting timing info
[0m14:09:20.223921 [debug] [Thread-2  ]: Began executing node test.ggchallengejoao.not_null_stg_referrals_id.f511791502
[0m14:09:20.224025 [debug] [Thread-4  ]: Began executing node test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f
[0m14:09:20.224120 [debug] [Thread-1  ]: Began executing node test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53
[0m14:09:20.224214 [debug] [Thread-3  ]: Began executing node test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f
[0m14:09:20.224311 [debug] [Thread-2  ]: finished collecting timing info
[0m14:09:20.224405 [debug] [Thread-4  ]: finished collecting timing info
[0m14:09:20.224496 [debug] [Thread-1  ]: finished collecting timing info
[0m14:09:20.224590 [debug] [Thread-3  ]: finished collecting timing info
[0m14:09:20.224977 [debug] [Thread-2  ]: Finished running node test.ggchallengejoao.not_null_stg_referrals_id.f511791502
[0m14:09:20.225367 [debug] [Thread-4  ]: Finished running node test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f
[0m14:09:20.225744 [debug] [Thread-1  ]: Finished running node test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53
[0m14:09:20.226157 [debug] [Thread-3  ]: Finished running node test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f
[0m14:09:20.227010 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:09:20.227133 [debug] [MainThread]: Connection 'test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53' was properly closed.
[0m14:09:20.227238 [debug] [MainThread]: Connection 'test.ggchallengejoao.not_null_stg_referrals_id.f511791502' was properly closed.
[0m14:09:20.227333 [debug] [MainThread]: Connection 'test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f' was properly closed.
[0m14:09:20.227425 [debug] [MainThread]: Connection 'test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f' was properly closed.
[0m14:09:20.234720 [info ] [MainThread]: Done.
[0m14:09:20.235085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ccbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141f1550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114254dc0>]}
[0m14:09:20.235263 [debug] [MainThread]: Flushing usage events


============================== 2023-01-06 14:32:28.048680 | ed8417df-fd58-40ef-a009-212bc199778b ==============================
[0m14:32:28.048739 [info ] [MainThread]: Running with dbt=1.3.2
[0m14:32:28.049418 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joaopaulomedeiroscecilio/dev/dbt-data-analysis', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:32:28.049535 [debug] [MainThread]: Tracking: tracking
[0m14:32:28.064702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1333bed30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1333bee50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1333bee80>]}
[0m14:32:28.094746 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m14:32:28.095435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ed8417df-fd58-40ef-a009-212bc199778b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1333bed60>]}
[0m14:32:28.125566 [debug] [MainThread]: Parsing macros/unix_to_timestamp.sql
[0m14:32:28.126046 [debug] [MainThread]: Parsing macros/etc.sql
[0m14:32:28.127290 [debug] [MainThread]: Parsing macros/catalog.sql
[0m14:32:28.130679 [debug] [MainThread]: Parsing macros/adapters.sql
[0m14:32:28.141071 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m14:32:28.142442 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m14:32:28.143890 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m14:32:28.147497 [debug] [MainThread]: Parsing macros/materializations/copy.sql
[0m14:32:28.148799 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m14:32:28.157336 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m14:32:28.158085 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m14:32:28.158263 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m14:32:28.158556 [debug] [MainThread]: Parsing macros/utils/timestamps.sql
[0m14:32:28.159042 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m14:32:28.159215 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m14:32:28.159471 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m14:32:28.159768 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m14:32:28.160222 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m14:32:28.160784 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m14:32:28.161020 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m14:32:28.161249 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m14:32:28.161491 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m14:32:28.161727 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m14:32:28.161924 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m14:32:28.162614 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m14:32:28.162854 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m14:32:28.163255 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m14:32:28.163623 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m14:32:28.164905 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m14:32:28.166700 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m14:32:28.167755 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m14:32:28.168532 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m14:32:28.176131 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m14:32:28.182865 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m14:32:28.189214 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m14:32:28.191476 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m14:32:28.192323 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m14:32:28.193152 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m14:32:28.197003 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m14:32:28.204741 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m14:32:28.205465 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m14:32:28.208561 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m14:32:28.213510 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m14:32:28.221858 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m14:32:28.224469 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m14:32:28.226101 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m14:32:28.228665 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m14:32:28.229258 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m14:32:28.230956 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m14:32:28.232051 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m14:32:28.235662 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m14:32:28.245117 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m14:32:28.245864 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m14:32:28.247007 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m14:32:28.247723 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m14:32:28.248136 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m14:32:28.248504 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m14:32:28.248820 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m14:32:28.249454 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m14:32:28.251947 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m14:32:28.255880 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m14:32:28.256262 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m14:32:28.256820 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m14:32:28.257258 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m14:32:28.257686 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m14:32:28.258248 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m14:32:28.258627 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m14:32:28.259098 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m14:32:28.259652 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m14:32:28.260725 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m14:32:28.261282 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m14:32:28.261777 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m14:32:28.262261 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m14:32:28.262730 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m14:32:28.263150 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m14:32:28.263641 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m14:32:28.264057 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m14:32:28.267240 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m14:32:28.267724 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m14:32:28.268153 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m14:32:28.268984 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m14:32:28.270016 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m14:32:28.270489 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m14:32:28.271181 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m14:32:28.271665 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m14:32:28.272624 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m14:32:28.274129 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m14:32:28.275523 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m14:32:28.282496 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m14:32:28.283422 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m14:32:28.289859 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m14:32:28.291927 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m14:32:28.295303 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m14:32:28.300002 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m14:32:28.302939 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m14:32:28.304318 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m14:32:28.305282 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m14:32:28.306480 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m14:32:28.307189 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m14:32:28.309321 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m14:32:28.311315 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m14:32:28.312369 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m14:32:28.313988 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m14:32:28.314949 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m14:32:28.316076 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m14:32:28.317129 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m14:32:28.318174 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m14:32:28.319512 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m14:32:28.329054 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m14:32:28.330010 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m14:32:28.335184 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m14:32:28.339660 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m14:32:28.342408 [debug] [MainThread]: Parsing macros/generic_tests/not_empty_string.sql
[0m14:32:28.346804 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m14:32:28.355417 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m14:32:28.356051 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_relation.sql
[0m14:32:28.356682 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m14:32:28.357345 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m14:32:28.357965 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m14:32:28.358825 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_ephemeral.sql
[0m14:32:28.359910 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m14:32:28.362142 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m14:32:28.362976 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m14:32:28.364855 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m14:32:28.367116 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m14:32:28.368913 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m14:32:28.369779 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m14:32:28.372620 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m14:32:28.375770 [debug] [MainThread]: Parsing macros/sql/safe_divide.sql
[0m14:32:28.376298 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m14:32:28.383041 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m14:32:28.383673 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m14:32:28.385457 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m14:32:28.386169 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m14:32:28.387179 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m14:32:28.387925 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m14:32:28.391404 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m14:32:28.394059 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m14:32:28.396001 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m14:32:28.397281 [debug] [MainThread]: Parsing macros/sql/width_bucket.sql
[0m14:32:28.399816 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m14:32:28.400867 [debug] [MainThread]: Parsing macros/sql/generate_surrogate_key.sql
[0m14:32:28.402102 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m14:32:28.402864 [debug] [MainThread]: Parsing macros/sql/get_single_value.sql
[0m14:32:28.404277 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m14:32:28.580826 [debug] [MainThread]: 1603: static parser failed on stating/stg_referrals.sql
[0m14:32:28.588327 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stating/stg_referrals.sql
[0m14:32:28.589047 [debug] [MainThread]: 1603: static parser failed on stating/stg_partners.sql
[0m14:32:28.591425 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stating/stg_partners.sql
[0m14:32:28.592081 [debug] [MainThread]: 1699: static parser successfully parsed marts/dim_sales_country.sql
[0m14:32:28.593380 [debug] [MainThread]: 1699: static parser successfully parsed marts/dim_partners.sql
[0m14:32:28.655589 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ggchallengejoao.example

[0m14:32:28.658777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed8417df-fd58-40ef-a009-212bc199778b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1336370d0>]}
[0m14:32:28.664401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed8417df-fd58-40ef-a009-212bc199778b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1333f14c0>]}
[0m14:32:28.664601 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 432 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m14:32:28.664756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed8417df-fd58-40ef-a009-212bc199778b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133424f10>]}
[0m14:32:28.665646 [info ] [MainThread]: 
[0m14:32:28.666026 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:32:28.666594 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801"
[0m14:32:28.666731 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:32:30.754013 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801_getgroundjoao"
[0m14:32:30.755221 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:32:31.184279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed8417df-fd58-40ef-a009-212bc199778b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133637100>]}
[0m14:32:31.186421 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:32:31.187044 [info ] [MainThread]: 
[0m14:32:31.197531 [debug] [Thread-1  ]: Began running node model.ggchallengejoao.dim_partners
[0m14:32:31.197808 [debug] [Thread-2  ]: Began running node model.ggchallengejoao.dim_sales_country
[0m14:32:31.198057 [debug] [Thread-3  ]: Began running node model.ggchallengejoao.stg_partners
[0m14:32:31.198245 [debug] [Thread-4  ]: Began running node model.ggchallengejoao.stg_referrals
[0m14:32:31.198713 [info ] [Thread-1  ]: 1 of 4 START sql view model getgroundjoao.dim_partners ......................... [RUN]
[0m14:32:31.199076 [info ] [Thread-2  ]: 2 of 4 START sql view model getgroundjoao.dim_sales_country .................... [RUN]
[0m14:32:31.199453 [info ] [Thread-3  ]: 3 of 4 START sql table model getgroundjoao.stg_partners ........................ [RUN]
[0m14:32:31.199763 [info ] [Thread-4  ]: 4 of 4 START sql table model getgroundjoao.stg_referrals ....................... [RUN]
[0m14:32:31.200795 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.ggchallengejoao.dim_partners"
[0m14:32:31.202199 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.ggchallengejoao.dim_sales_country"
[0m14:32:31.202912 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_partners"
[0m14:32:31.203645 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_referrals"
[0m14:32:31.203882 [debug] [Thread-1  ]: Began compiling node model.ggchallengejoao.dim_partners
[0m14:32:31.204079 [debug] [Thread-2  ]: Began compiling node model.ggchallengejoao.dim_sales_country
[0m14:32:31.204256 [debug] [Thread-3  ]: Began compiling node model.ggchallengejoao.stg_partners
[0m14:32:31.204429 [debug] [Thread-4  ]: Began compiling node model.ggchallengejoao.stg_referrals
[0m14:32:31.204762 [debug] [Thread-1  ]: Compiling model.ggchallengejoao.dim_partners
[0m14:32:31.204943 [debug] [Thread-2  ]: Compiling model.ggchallengejoao.dim_sales_country
[0m14:32:31.205114 [debug] [Thread-3  ]: Compiling model.ggchallengejoao.stg_partners
[0m14:32:31.205283 [debug] [Thread-4  ]: Compiling model.ggchallengejoao.stg_referrals
[0m14:32:31.213532 [debug] [Thread-2  ]: Writing injected SQL for node "model.ggchallengejoao.dim_sales_country"
[0m14:32:31.226521 [debug] [Thread-3  ]: Writing injected SQL for node "model.ggchallengejoao.stg_partners"
[0m14:32:31.233246 [debug] [Thread-1  ]: Writing injected SQL for node "model.ggchallengejoao.dim_partners"
[0m14:32:31.241843 [debug] [Thread-4  ]: Writing injected SQL for node "model.ggchallengejoao.stg_referrals"
[0m14:32:31.242837 [debug] [Thread-3  ]: finished collecting timing info
[0m14:32:31.243031 [debug] [Thread-2  ]: finished collecting timing info
[0m14:32:31.243802 [debug] [Thread-2  ]: Began executing node model.ggchallengejoao.dim_sales_country
[0m14:32:31.243491 [debug] [Thread-1  ]: finished collecting timing info
[0m14:32:31.243352 [debug] [Thread-3  ]: Began executing node model.ggchallengejoao.stg_partners
[0m14:32:31.243915 [debug] [Thread-4  ]: finished collecting timing info
[0m14:32:31.268232 [debug] [Thread-2  ]: Writing runtime sql for node "model.ggchallengejoao.dim_sales_country"
[0m14:32:31.268378 [debug] [Thread-1  ]: Began executing node model.ggchallengejoao.dim_partners
[0m14:32:31.275865 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:32:31.276070 [debug] [Thread-4  ]: Began executing node model.ggchallengejoao.stg_referrals
[0m14:32:31.278143 [debug] [Thread-1  ]: Writing runtime sql for node "model.ggchallengejoao.dim_partners"
[0m14:32:31.280340 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:32:31.282037 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:32:31.282326 [debug] [Thread-2  ]: On model.ggchallengejoao.dim_sales_country: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.dim_sales_country"} */


  create or replace view `dynamic-point-367801`.`getgroundjoao`.`dim_sales_country`
  OPTIONS()
  as  select * from `dynamic-point-367801`.`getgroundjoao`.`sales_people`;


[0m14:32:31.282712 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:32:31.286483 [debug] [Thread-1  ]: On model.ggchallengejoao.dim_partners: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.dim_partners"} */


  create or replace view `dynamic-point-367801`.`getgroundjoao`.`dim_partners`
  OPTIONS()
  as 
select id, partner_type, lead_sales_contact
from `dynamic-point-367801`.`getgroundjoao`.`sales_people`;


[0m14:32:31.786743 [debug] [Thread-3  ]: Writing runtime sql for node "model.ggchallengejoao.stg_partners"
[0m14:32:31.787178 [debug] [Thread-4  ]: Writing runtime sql for node "model.ggchallengejoao.stg_referrals"
[0m14:32:31.788040 [debug] [Thread-4  ]: On model.ggchallengejoao.stg_referrals: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.stg_referrals"} */

  
    

    create or replace table `dynamic-point-367801`.`getgroundjoao`.`stg_referrals`
    
    
    OPTIONS()
    as (
      

select *
except
    (created_at, updated_at),
    
timestamp_micros(cast(created_at/ 1000 as int64))
 as referral_created_at_timestamp,
    
timestamp_micros(cast(updated_at/ 1000 as int64))
 as referral_updated_at_timestamp
from `dynamic-point-367801`.`getgroundjoao`.`referrals`
    );
  
[0m14:32:31.788122 [debug] [Thread-3  ]: On model.ggchallengejoao.stg_partners: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.stg_partners"} */

  
    

    create or replace table `dynamic-point-367801`.`getgroundjoao`.`stg_partners`
    
    
    OPTIONS()
    as (
      

select *
except
    (lead_sales_contact, created_at, updated_at),
    if(
        lead_sales_contact = '0', 'No contact', lead_sales_contact
    ) as lead_sales_contact,
    
timestamp_micros(cast(created_at/ 1000 as int64))
 as partner_created_at_timestamp,
    
timestamp_micros(cast(updated_at/ 1000 as int64))
 as partner_updated_at_timestamp
from `dynamic-point-367801`.`getgroundjoao`.`partners`
    );
  
[0m14:32:32.469715 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: id at [7:8]')
[0m14:32:32.905999 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:ccc080bd-d27a-4a2f-be14-b8f6111755f9:EU&page=queryresults
[0m14:32:32.926995 [debug] [Thread-2  ]: finished collecting timing info
[0m14:32:32.927690 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed8417df-fd58-40ef-a009-212bc199778b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15011cc40>]}
[0m14:32:32.928064 [info ] [Thread-2  ]: 2 of 4 OK created sql view model getgroundjoao.dim_sales_country ............... [[32mCREATE VIEW (0 processed)[0m in 1.73s]
[0m14:32:32.928461 [debug] [Thread-2  ]: Finished running node model.ggchallengejoao.dim_sales_country
[0m14:32:34.365311 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:f6bd373e-6b84-4c37-9aed-9559c3e32117:EU&page=queryresults
[0m14:32:34.370939 [debug] [Thread-3  ]: finished collecting timing info
[0m14:32:34.372650 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed8417df-fd58-40ef-a009-212bc199778b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15011cca0>]}
[0m14:32:34.376611 [info ] [Thread-3  ]: 3 of 4 OK created sql table model getgroundjoao.stg_partners ................... [[32mCREATE TABLE (522.0 rows, 19.5 KB processed)[0m in 3.17s]
[0m14:32:34.381131 [debug] [Thread-3  ]: Finished running node model.ggchallengejoao.stg_partners
[0m14:32:34.464863 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:f0aa07fd-9b47-4c59-9ccc-7aea655c32d9:EU&page=queryresults
[0m14:32:34.465947 [debug] [Thread-4  ]: finished collecting timing info
[0m14:32:34.466367 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed8417df-fd58-40ef-a009-212bc199778b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15011cd00>]}
[0m14:32:34.466606 [info ] [Thread-4  ]: 4 of 4 OK created sql table model getgroundjoao.stg_referrals .................. [[32mCREATE TABLE (1.5k rows, 96.2 KB processed)[0m in 3.26s]
[0m14:32:34.466916 [debug] [Thread-4  ]: Finished running node model.ggchallengejoao.stg_referrals
[0m14:32:34.654542 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:EU:af8954a4-d9e8-417c-9477-a99f353687bc&page=queryresults
[0m14:32:34.656151 [debug] [Thread-1  ]: finished collecting timing info
[0m14:32:34.657446 [debug] [Thread-1  ]: Database Error in model dim_partners (models/marts/dim_partners.sql)
  Unrecognized name: id at [7:8]
  compiled Code at target/run/ggchallengejoao/models/marts/dim_partners.sql
[0m14:32:34.657952 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed8417df-fd58-40ef-a009-212bc199778b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1501cf250>]}
[0m14:32:34.658453 [error] [Thread-1  ]: 1 of 4 ERROR creating sql view model getgroundjoao.dim_partners ................ [[31mERROR[0m in 3.46s]
[0m14:32:34.659055 [debug] [Thread-1  ]: Finished running node model.ggchallengejoao.dim_partners
[0m14:32:34.662214 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:32:34.663214 [info ] [MainThread]: 
[0m14:32:34.663652 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 6.00 seconds (6.00s).
[0m14:32:34.664015 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:32:34.664207 [debug] [MainThread]: Connection 'model.ggchallengejoao.dim_partners' was properly closed.
[0m14:32:34.664390 [debug] [MainThread]: Connection 'model.ggchallengejoao.dim_sales_country' was properly closed.
[0m14:32:34.664566 [debug] [MainThread]: Connection 'model.ggchallengejoao.stg_partners' was properly closed.
[0m14:32:34.664736 [debug] [MainThread]: Connection 'model.ggchallengejoao.stg_referrals' was properly closed.
[0m14:32:34.684711 [info ] [MainThread]: 
[0m14:32:34.685056 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:32:34.685319 [info ] [MainThread]: 
[0m14:32:34.685548 [error] [MainThread]: [33mDatabase Error in model dim_partners (models/marts/dim_partners.sql)[0m
[0m14:32:34.685766 [error] [MainThread]:   Unrecognized name: id at [7:8]
[0m14:32:34.685974 [error] [MainThread]:   compiled Code at target/run/ggchallengejoao/models/marts/dim_partners.sql
[0m14:32:34.686207 [info ] [MainThread]: 
[0m14:32:34.686444 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m14:32:34.687011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1336f9e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1336373a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13373d9a0>]}
[0m14:32:34.687365 [debug] [MainThread]: Flushing usage events


============================== 2023-01-06 14:32:53.507195 | f1e82a0e-526c-4bab-85f6-17cd4e667925 ==============================
[0m14:32:53.507258 [info ] [MainThread]: Running with dbt=1.3.2
[0m14:32:53.508049 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joaopaulomedeiroscecilio/dev/dbt-data-analysis', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:32:53.508195 [debug] [MainThread]: Tracking: tracking
[0m14:32:53.535500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b6fed60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b6fee80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b6feeb0>]}
[0m14:32:53.592114 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:32:53.592379 [debug] [MainThread]: Partial parsing: updated file: ggchallengejoao://models/marts/dim_partners.sql
[0m14:32:53.602100 [debug] [MainThread]: 1699: static parser successfully parsed marts/dim_partners.sql
[0m14:32:53.617558 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ggchallengejoao.example

[0m14:32:53.621065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1e82a0e-526c-4bab-85f6-17cd4e667925', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bb14f10>]}
[0m14:32:53.628516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1e82a0e-526c-4bab-85f6-17cd4e667925', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ba547c0>]}
[0m14:32:53.628768 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 432 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m14:32:53.628930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1e82a0e-526c-4bab-85f6-17cd4e667925', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bac0c10>]}
[0m14:32:53.629892 [info ] [MainThread]: 
[0m14:32:53.630302 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:32:53.630865 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801"
[0m14:32:53.630994 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:32:55.036523 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801_getgroundjoao"
[0m14:32:55.037711 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:32:55.478863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1e82a0e-526c-4bab-85f6-17cd4e667925', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b6feeb0>]}
[0m14:32:55.480476 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:32:55.480993 [info ] [MainThread]: 
[0m14:32:55.489162 [debug] [Thread-1  ]: Began running node model.ggchallengejoao.dim_partners
[0m14:32:55.489485 [debug] [Thread-2  ]: Began running node model.ggchallengejoao.dim_sales_country
[0m14:32:55.489707 [debug] [Thread-3  ]: Began running node model.ggchallengejoao.stg_partners
[0m14:32:55.489954 [debug] [Thread-4  ]: Began running node model.ggchallengejoao.stg_referrals
[0m14:32:55.490567 [info ] [Thread-1  ]: 1 of 4 START sql view model getgroundjoao.dim_partners ......................... [RUN]
[0m14:32:55.491000 [info ] [Thread-2  ]: 2 of 4 START sql view model getgroundjoao.dim_sales_country .................... [RUN]
[0m14:32:55.491379 [info ] [Thread-3  ]: 3 of 4 START sql table model getgroundjoao.stg_partners ........................ [RUN]
[0m14:32:55.491759 [info ] [Thread-4  ]: 4 of 4 START sql table model getgroundjoao.stg_referrals ....................... [RUN]
[0m14:32:55.492991 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.ggchallengejoao.dim_partners"
[0m14:32:55.494501 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.ggchallengejoao.dim_sales_country"
[0m14:32:55.495606 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_partners"
[0m14:32:55.496687 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_referrals"
[0m14:32:55.497112 [debug] [Thread-1  ]: Began compiling node model.ggchallengejoao.dim_partners
[0m14:32:55.497370 [debug] [Thread-2  ]: Began compiling node model.ggchallengejoao.dim_sales_country
[0m14:32:55.497619 [debug] [Thread-3  ]: Began compiling node model.ggchallengejoao.stg_partners
[0m14:32:55.497860 [debug] [Thread-4  ]: Began compiling node model.ggchallengejoao.stg_referrals
[0m14:32:55.498305 [debug] [Thread-1  ]: Compiling model.ggchallengejoao.dim_partners
[0m14:32:55.498552 [debug] [Thread-2  ]: Compiling model.ggchallengejoao.dim_sales_country
[0m14:32:55.498792 [debug] [Thread-3  ]: Compiling model.ggchallengejoao.stg_partners
[0m14:32:55.499043 [debug] [Thread-4  ]: Compiling model.ggchallengejoao.stg_referrals
[0m14:32:55.505956 [debug] [Thread-1  ]: Writing injected SQL for node "model.ggchallengejoao.dim_partners"
[0m14:32:55.509424 [debug] [Thread-2  ]: Writing injected SQL for node "model.ggchallengejoao.dim_sales_country"
[0m14:32:55.515891 [debug] [Thread-4  ]: Writing injected SQL for node "model.ggchallengejoao.stg_referrals"
[0m14:32:55.521266 [debug] [Thread-3  ]: Writing injected SQL for node "model.ggchallengejoao.stg_partners"
[0m14:32:55.521667 [debug] [Thread-2  ]: finished collecting timing info
[0m14:32:55.521887 [debug] [Thread-1  ]: finished collecting timing info
[0m14:32:55.522249 [debug] [Thread-2  ]: Began executing node model.ggchallengejoao.dim_sales_country
[0m14:32:55.522422 [debug] [Thread-4  ]: finished collecting timing info
[0m14:32:55.522659 [debug] [Thread-1  ]: Began executing node model.ggchallengejoao.dim_partners
[0m14:32:55.522796 [debug] [Thread-3  ]: finished collecting timing info
[0m14:32:55.547772 [debug] [Thread-4  ]: Began executing node model.ggchallengejoao.stg_referrals
[0m14:32:55.552472 [debug] [Thread-2  ]: Writing runtime sql for node "model.ggchallengejoao.dim_sales_country"
[0m14:32:55.554554 [debug] [Thread-1  ]: Writing runtime sql for node "model.ggchallengejoao.dim_partners"
[0m14:32:55.554685 [debug] [Thread-3  ]: Began executing node model.ggchallengejoao.stg_partners
[0m14:32:55.561972 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:32:55.563533 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:32:55.563662 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:32:55.563763 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:32:55.564824 [debug] [Thread-2  ]: On model.ggchallengejoao.dim_sales_country: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.dim_sales_country"} */


  create or replace view `dynamic-point-367801`.`getgroundjoao`.`dim_sales_country`
  OPTIONS()
  as  select * from `dynamic-point-367801`.`getgroundjoao`.`sales_people`;


[0m14:32:55.565308 [debug] [Thread-1  ]: On model.ggchallengejoao.dim_partners: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.dim_partners"} */


  create or replace view `dynamic-point-367801`.`getgroundjoao`.`dim_partners`
  OPTIONS()
  as 
select id, partner_type, lead_sales_contact
from `dynamic-point-367801`.`getgroundjoao`.`partners`;


[0m14:32:56.080346 [debug] [Thread-3  ]: Writing runtime sql for node "model.ggchallengejoao.stg_partners"
[0m14:32:56.081910 [debug] [Thread-4  ]: Writing runtime sql for node "model.ggchallengejoao.stg_referrals"
[0m14:32:56.082694 [debug] [Thread-3  ]: On model.ggchallengejoao.stg_partners: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.stg_partners"} */

  
    

    create or replace table `dynamic-point-367801`.`getgroundjoao`.`stg_partners`
    
    
    OPTIONS()
    as (
      

select *
except
    (lead_sales_contact, created_at, updated_at),
    if(
        lead_sales_contact = '0', 'No contact', lead_sales_contact
    ) as lead_sales_contact,
    
timestamp_micros(cast(created_at/ 1000 as int64))
 as partner_created_at_timestamp,
    
timestamp_micros(cast(updated_at/ 1000 as int64))
 as partner_updated_at_timestamp
from `dynamic-point-367801`.`getgroundjoao`.`partners`
    );
  
[0m14:32:56.082896 [debug] [Thread-4  ]: On model.ggchallengejoao.stg_referrals: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.stg_referrals"} */

  
    

    create or replace table `dynamic-point-367801`.`getgroundjoao`.`stg_referrals`
    
    
    OPTIONS()
    as (
      

select *
except
    (created_at, updated_at),
    
timestamp_micros(cast(created_at/ 1000 as int64))
 as referral_created_at_timestamp,
    
timestamp_micros(cast(updated_at/ 1000 as int64))
 as referral_updated_at_timestamp
from `dynamic-point-367801`.`getgroundjoao`.`referrals`
    );
  
[0m14:32:56.771292 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:cb79f2a3-14d7-414e-b88c-864241ecd654:EU&page=queryresults
[0m14:32:56.783711 [debug] [Thread-1  ]: finished collecting timing info
[0m14:32:56.784867 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1e82a0e-526c-4bab-85f6-17cd4e667925', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bd4ac10>]}
[0m14:32:56.785214 [info ] [Thread-1  ]: 1 of 4 OK created sql view model getgroundjoao.dim_partners .................... [[32mCREATE VIEW (0 processed)[0m in 1.29s]
[0m14:32:56.786288 [debug] [Thread-1  ]: Finished running node model.ggchallengejoao.dim_partners
[0m14:32:57.076380 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:17382a5c-e698-4ea8-ad7f-0747c492d67f:EU&page=queryresults
[0m14:32:57.084191 [debug] [Thread-2  ]: finished collecting timing info
[0m14:32:57.086067 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1e82a0e-526c-4bab-85f6-17cd4e667925', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bbd0df0>]}
[0m14:32:57.086942 [info ] [Thread-2  ]: 2 of 4 OK created sql view model getgroundjoao.dim_sales_country ............... [[32mCREATE VIEW (0 processed)[0m in 1.59s]
[0m14:32:57.088056 [debug] [Thread-2  ]: Finished running node model.ggchallengejoao.dim_sales_country
[0m14:32:58.760717 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:6c355809-a90c-4342-9aee-1b38485adcee:EU&page=queryresults
[0m14:32:58.766743 [debug] [Thread-4  ]: finished collecting timing info
[0m14:32:58.770418 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1e82a0e-526c-4bab-85f6-17cd4e667925', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bbd0eb0>]}
[0m14:32:58.771892 [info ] [Thread-4  ]: 4 of 4 OK created sql table model getgroundjoao.stg_referrals .................. [[32mCREATE TABLE (1.5k rows, 96.2 KB processed)[0m in 3.27s]
[0m14:32:58.773326 [debug] [Thread-4  ]: Finished running node model.ggchallengejoao.stg_referrals
[0m14:32:59.279066 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:0c4b2048-7372-44b9-802d-cc4c7eda9237:EU&page=queryresults
[0m14:32:59.284078 [debug] [Thread-3  ]: finished collecting timing info
[0m14:32:59.285701 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1e82a0e-526c-4bab-85f6-17cd4e667925', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bbd0e50>]}
[0m14:32:59.286720 [info ] [Thread-3  ]: 3 of 4 OK created sql table model getgroundjoao.stg_partners ................... [[32mCREATE TABLE (522.0 rows, 19.5 KB processed)[0m in 3.79s]
[0m14:32:59.287692 [debug] [Thread-3  ]: Finished running node model.ggchallengejoao.stg_partners
[0m14:32:59.290990 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:32:59.292333 [info ] [MainThread]: 
[0m14:32:59.292967 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 5.66 seconds (5.66s).
[0m14:32:59.293601 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:32:59.294011 [debug] [MainThread]: Connection 'model.ggchallengejoao.dim_partners' was properly closed.
[0m14:32:59.294295 [debug] [MainThread]: Connection 'model.ggchallengejoao.dim_sales_country' was properly closed.
[0m14:32:59.294518 [debug] [MainThread]: Connection 'model.ggchallengejoao.stg_partners' was properly closed.
[0m14:32:59.294736 [debug] [MainThread]: Connection 'model.ggchallengejoao.stg_referrals' was properly closed.
[0m14:32:59.313146 [info ] [MainThread]: 
[0m14:32:59.313638 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:32:59.313996 [info ] [MainThread]: 
[0m14:32:59.314296 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m14:32:59.314750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ba54f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bb75970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bb75c10>]}
[0m14:32:59.315038 [debug] [MainThread]: Flushing usage events


============================== 2023-01-06 17:35:40.542546 | 5b455c67-fcd8-4dd3-83ad-d2560be94946 ==============================
[0m17:35:40.542563 [info ] [MainThread]: Running with dbt=1.3.2
[0m17:35:40.543208 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joaopaulomedeiroscecilio/dev/dbt-data-analysis', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:35:40.543329 [debug] [MainThread]: Tracking: tracking
[0m17:35:40.566345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1490f1d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1490f1e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1490f1e50>]}
[0m17:35:40.629926 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 1 files added, 3 files changed.
[0m17:35:40.630164 [debug] [MainThread]: Partial parsing: added file: ggchallengejoao://models/marts/mart_referrals.sql
[0m17:35:40.630422 [debug] [MainThread]: Partial parsing: update schema file: ggchallengejoao://models/schema.yml
[0m17:35:40.630513 [debug] [MainThread]: Partial parsing: deleted file: ggchallengejoao://models/marts/dim_sales_country.sql
[0m17:35:40.630580 [debug] [MainThread]: Partial parsing: deleted file: ggchallengejoao://models/marts/dim_partners.sql
[0m17:35:40.630718 [debug] [MainThread]: Partial parsing: updated file: ggchallengejoao://models/stating/stg_referrals.sql
[0m17:35:40.630839 [debug] [MainThread]: Partial parsing: updated file: ggchallengejoao://models/stating/stg_partners.sql
[0m17:35:40.639843 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_referrals.sql
[0m17:35:40.646406 [debug] [MainThread]: 1603: static parser failed on stating/stg_referrals.sql
[0m17:35:40.649681 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stating/stg_referrals.sql
[0m17:35:40.650422 [debug] [MainThread]: 1603: static parser failed on stating/stg_partners.sql
[0m17:35:40.653044 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stating/stg_partners.sql
[0m17:35:40.689795 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ggchallengejoao.example

[0m17:35:40.692985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b455c67-fcd8-4dd3-83ad-d2560be94946', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1494ecfd0>]}
[0m17:35:40.699402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b455c67-fcd8-4dd3-83ad-d2560be94946', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1492b0910>]}
[0m17:35:40.699657 [info ] [MainThread]: Found 3 models, 6 tests, 0 snapshots, 0 analyses, 432 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:35:40.699814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b455c67-fcd8-4dd3-83ad-d2560be94946', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1492b0940>]}
[0m17:35:40.700746 [info ] [MainThread]: 
[0m17:35:40.701168 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m17:35:40.701744 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801"
[0m17:35:40.701885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:35:43.233533 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801_getgroundjoao"
[0m17:35:43.234436 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:35:43.661819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b455c67-fcd8-4dd3-83ad-d2560be94946', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14946d820>]}
[0m17:35:43.663925 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:35:43.664711 [info ] [MainThread]: 
[0m17:35:43.674132 [debug] [Thread-1  ]: Began running node model.ggchallengejoao.stg_partners
[0m17:35:43.674410 [debug] [Thread-2  ]: Began running node model.ggchallengejoao.stg_referrals
[0m17:35:43.674934 [info ] [Thread-1  ]: 1 of 3 START sql view model getgroundjoao.stg_partners ......................... [RUN]
[0m17:35:43.675373 [info ] [Thread-2  ]: 2 of 3 START sql view model getgroundjoao.stg_referrals ........................ [RUN]
[0m17:35:43.676535 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_partners"
[0m17:35:43.677418 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_referrals"
[0m17:35:43.677733 [debug] [Thread-1  ]: Began compiling node model.ggchallengejoao.stg_partners
[0m17:35:43.677975 [debug] [Thread-2  ]: Began compiling node model.ggchallengejoao.stg_referrals
[0m17:35:43.678348 [debug] [Thread-1  ]: Compiling model.ggchallengejoao.stg_partners
[0m17:35:43.678556 [debug] [Thread-2  ]: Compiling model.ggchallengejoao.stg_referrals
[0m17:35:43.695709 [debug] [Thread-2  ]: Writing injected SQL for node "model.ggchallengejoao.stg_referrals"
[0m17:35:43.702270 [debug] [Thread-1  ]: Writing injected SQL for node "model.ggchallengejoao.stg_partners"
[0m17:35:43.702638 [debug] [Thread-2  ]: finished collecting timing info
[0m17:35:43.702895 [debug] [Thread-2  ]: Began executing node model.ggchallengejoao.stg_referrals
[0m17:35:43.734814 [debug] [Thread-1  ]: finished collecting timing info
[0m17:35:43.736585 [debug] [Thread-2  ]: Writing runtime sql for node "model.ggchallengejoao.stg_referrals"
[0m17:35:43.736794 [debug] [Thread-1  ]: Began executing node model.ggchallengejoao.stg_partners
[0m17:35:43.739006 [debug] [Thread-1  ]: Writing runtime sql for node "model.ggchallengejoao.stg_partners"
[0m17:35:43.739669 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m17:35:43.739868 [debug] [Thread-2  ]: On model.ggchallengejoao.stg_referrals: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.stg_referrals"} */


  create or replace view `dynamic-point-367801`.`getgroundjoao`.`stg_referrals`
  OPTIONS()
  as 

select *
except
    (created_at, updated_at),
    
timestamp_micros(cast(created_at/ 1000 as int64))
 as referral_created_at_timestamp,
    
timestamp_micros(cast(updated_at/ 1000 as int64))
 as referral_updated_at_timestamp
from `dynamic-point-367801`.`getgroundjoao`.`referrals`;


[0m17:35:43.739966 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:35:43.741310 [debug] [Thread-1  ]: On model.ggchallengejoao.stg_partners: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.stg_partners"} */


  create or replace view `dynamic-point-367801`.`getgroundjoao`.`stg_partners`
  OPTIONS()
  as 

select *
except
    (lead_sales_contact, created_at, updated_at),
    if(
        lead_sales_contact = '0', 'No contact', lead_sales_contact
    ) as lead_sales_contact,
    
timestamp_micros(cast(created_at/ 1000 as int64))
 as partner_created_at_timestamp,
    
timestamp_micros(cast(updated_at/ 1000 as int64))
 as partner_updated_at_timestamp
from `dynamic-point-367801`.`getgroundjoao`.`partners`;


[0m17:35:45.093747 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:53f96076-2eb8-4d1a-b5a0-50ff201ecfca:EU&page=queryresults
[0m17:35:45.117512 [debug] [Thread-2  ]: finished collecting timing info
[0m17:35:45.118803 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:dd2ceaac-01b9-4ccb-bc35-874d650203d7:EU&page=queryresults
[0m17:35:45.119747 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b455c67-fcd8-4dd3-83ad-d2560be94946', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14961e7f0>]}
[0m17:35:45.121232 [debug] [Thread-1  ]: finished collecting timing info
[0m17:35:45.121804 [info ] [Thread-2  ]: 2 of 3 OK created sql view model getgroundjoao.stg_referrals ................... [[32mCREATE VIEW (0 processed)[0m in 1.44s]
[0m17:35:45.122389 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b455c67-fcd8-4dd3-83ad-d2560be94946', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1495f6eb0>]}
[0m17:35:45.123792 [debug] [Thread-2  ]: Finished running node model.ggchallengejoao.stg_referrals
[0m17:35:45.124287 [info ] [Thread-1  ]: 1 of 3 OK created sql view model getgroundjoao.stg_partners .................... [[32mCREATE VIEW (0 processed)[0m in 1.45s]
[0m17:35:45.124842 [debug] [Thread-1  ]: Finished running node model.ggchallengejoao.stg_partners
[0m17:35:45.125753 [debug] [Thread-1  ]: Began running node model.ggchallengejoao.mart_referrals
[0m17:35:45.126095 [info ] [Thread-1  ]: 3 of 3 START sql table model getgroundjoao.mart_referrals ...................... [RUN]
[0m17:35:45.126785 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.ggchallengejoao.mart_referrals"
[0m17:35:45.126961 [debug] [Thread-1  ]: Began compiling node model.ggchallengejoao.mart_referrals
[0m17:35:45.127145 [debug] [Thread-1  ]: Compiling model.ggchallengejoao.mart_referrals
[0m17:35:45.132317 [debug] [Thread-1  ]: Writing injected SQL for node "model.ggchallengejoao.mart_referrals"
[0m17:35:45.133373 [debug] [Thread-1  ]: finished collecting timing info
[0m17:35:45.133552 [debug] [Thread-1  ]: Began executing node model.ggchallengejoao.mart_referrals
[0m17:35:45.156668 [debug] [Thread-1  ]: Writing runtime sql for node "model.ggchallengejoao.mart_referrals"
[0m17:35:45.157091 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:35:45.157286 [debug] [Thread-1  ]: On model.ggchallengejoao.mart_referrals: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.mart_referrals"} */

  
    

    create or replace table `dynamic-point-367801`.`getgroundjoao`.`mart_referrals`
    
    
    OPTIONS()
    as (
      

select
    r.company_id as referral_company,
    r.partner_id as referral_partner,
    r.status as referral_status,
    r.is_outbound as referral_outbound,
    r.referral_created_at_timestamp as referral_record_date,
    r.referral_updated_at_timestamp as referral_updated,
    timestamp_diff(
        referral_updated_at_timestamp, referral_created_at_timestamp, day
    ) as referral_days_from_creation,
    p.partner_type as referral_partner_type,
    p.lead_sales_contact as referral_lead_sales_contact,
    coalesce(d.country, 'No country') as referral_country
from `dynamic-point-367801`.`getgroundjoao`.`stg_referrals` r
left join `dynamic-point-367801`.`getgroundjoao`.`partners` p on r.partner_id = p.id
left join `dynamic-point-367801`.`getgroundjoao`.`sales_people` d on p.lead_sales_contact = d.name
    );
  
[0m17:35:47.910786 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:a2bb3f3e-fb33-46df-bfdf-90e3057f414a:EU&page=queryresults
[0m17:35:47.917039 [debug] [Thread-1  ]: finished collecting timing info
[0m17:35:47.919573 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b455c67-fcd8-4dd3-83ad-d2560be94946', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1495de4f0>]}
[0m17:35:47.920862 [info ] [Thread-1  ]: 3 of 3 OK created sql table model getgroundjoao.mart_referrals ................. [[32mCREATE TABLE (1.5k rows, 84.8 KB processed)[0m in 2.79s]
[0m17:35:47.922289 [debug] [Thread-1  ]: Finished running node model.ggchallengejoao.mart_referrals
[0m17:35:47.925680 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m17:35:47.926681 [info ] [MainThread]: 
[0m17:35:47.927082 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 7.23 seconds (7.23s).
[0m17:35:47.927452 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:35:47.927675 [debug] [MainThread]: Connection 'model.ggchallengejoao.mart_referrals' was properly closed.
[0m17:35:47.927877 [debug] [MainThread]: Connection 'model.ggchallengejoao.stg_referrals' was properly closed.
[0m17:35:47.947184 [info ] [MainThread]: 
[0m17:35:47.947624 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:35:47.947919 [info ] [MainThread]: 
[0m17:35:47.948153 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:35:47.948615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1496418b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149606310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1495ef5e0>]}
[0m17:35:47.948867 [debug] [MainThread]: Flushing usage events


============================== 2023-01-06 17:57:33.830970 | ac456d6c-ef67-4600-8fa4-9823acde4746 ==============================
[0m17:57:33.831002 [info ] [MainThread]: Running with dbt=1.3.2
[0m17:57:33.831667 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joaopaulomedeiroscecilio/dev/dbt-data-analysis', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:57:33.831794 [debug] [MainThread]: Tracking: tracking
[0m17:57:33.846328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f9fcf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fb15130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fb150d0>]}
[0m17:57:33.847713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fb150d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fb15100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fb15490>]}
[0m17:57:33.847894 [debug] [MainThread]: Flushing usage events
[0m17:57:34.662358 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 2 package(s) specified in packages.yml, but only 1 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.


============================== 2023-01-06 17:57:38.139563 | 9ce18f1c-1145-4a3c-91ed-76efed640472 ==============================
[0m17:57:38.139571 [info ] [MainThread]: Running with dbt=1.3.2
[0m17:57:38.139789 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joaopaulomedeiroscecilio/dev/dbt-data-analysis', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m17:57:38.139876 [debug] [MainThread]: Tracking: tracking
[0m17:57:38.148959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064054f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106405f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106412280>]}
[0m17:57:38.150322 [debug] [MainThread]: Set downloads directory='/var/folders/nr/2t4z4mks1h3fqcd9w6_2ftvr0000gn/T/dbt-downloads-9564_ur3'
[0m17:57:38.150821 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:57:40.478263 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:57:40.479619 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:57:40.603406 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:57:40.629366 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/metrics.json
[0m17:57:40.879765 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/metrics.json 200
[0m17:57:40.929167 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:57:41.479117 [info ] [MainThread]:   Installed from version 1.0.0
[0m17:57:41.479433 [info ] [MainThread]:   Up to date!
[0m17:57:41.479964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9ce18f1c-1145-4a3c-91ed-76efed640472', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106412730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106412700>]}
[0m17:57:41.481968 [info ] [MainThread]: Installing dbt-labs/metrics
[0m17:57:41.931721 [info ] [MainThread]:   Installed from version 1.3.2
[0m17:57:41.931936 [info ] [MainThread]:   Up to date!
[0m17:57:41.932102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9ce18f1c-1145-4a3c-91ed-76efed640472', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10646e700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10646ea90>]}
[0m17:57:41.934214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064bafa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064057f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106412d60>]}
[0m17:57:41.934369 [debug] [MainThread]: Flushing usage events


============================== 2023-01-06 17:57:48.872541 | d2dcce41-8472-4823-9368-619fa2c2a120 ==============================
[0m17:57:48.872574 [info ] [MainThread]: Running with dbt=1.3.2
[0m17:57:48.872913 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joaopaulomedeiroscecilio/dev/dbt-data-analysis', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:57:48.873007 [debug] [MainThread]: Tracking: tracking
[0m17:57:48.883353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d53af40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d555160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d555100>]}
[0m17:57:48.916833 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m17:57:48.917094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd2dcce41-8472-4823-9368-619fa2c2a120', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d560f10>]}
[0m17:57:48.927813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d7f1fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d7f16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d7f1790>]}
[0m17:57:48.928138 [debug] [MainThread]: Flushing usage events
[0m17:57:49.656514 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading ggchallengejoao: marts/referrals.yml - Runtime Error
    Syntax error near line 4
    ------------------------------
    1  | version: 2
    2  | 
    3  | metrics:
    4  |   - name: referral_total_count:
    5  |     model: ref('mart_referrals')
    6  |     description: 'Total count of referrals'
    7  | 
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 4, column 31


============================== 2023-01-06 17:59:12.172732 | 1f5d641b-4583-49fe-bc83-b7fc7c97b3fb ==============================
[0m17:59:12.172780 [info ] [MainThread]: Running with dbt=1.3.2
[0m17:59:12.173315 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joaopaulomedeiroscecilio/dev/dbt-data-analysis', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:59:12.173422 [debug] [MainThread]: Tracking: tracking
[0m17:59:12.186779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ea7bee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ea95100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ea950a0>]}
[0m17:59:12.222114 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m17:59:12.222367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1f5d641b-4583-49fe-bc83-b7fc7c97b3fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11eab2340>]}
[0m17:59:12.227326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ec31f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ec316a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ec31880>]}
[0m17:59:12.227529 [debug] [MainThread]: Flushing usage events
[0m17:59:13.032784 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading ggchallengejoao: marts/referrals.yml - Runtime Error
    Syntax error near line 21
    ------------------------------
    18 |       - referral_lead_sales_contact
    19 |       - referral_country
    20 | 
    21 |   - name: referral_avg_days_from_creation:
    22 |     model: ref('mart_referrals')
    23 |     description: 'Average days since creation until last status update'
    24 | 
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 21, column 42


============================== 2023-01-06 17:59:26.274785 | 14770fc9-21a4-47dc-bb56-6babb494abab ==============================
[0m17:59:26.274825 [info ] [MainThread]: Running with dbt=1.3.2
[0m17:59:26.275342 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joaopaulomedeiroscecilio/dev/dbt-data-analysis', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:59:26.275442 [debug] [MainThread]: Tracking: tracking
[0m17:59:26.285954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cdfbf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ce15160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ce15100>]}
[0m17:59:26.314145 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m17:59:26.314384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '14770fc9-21a4-47dc-bb56-6babb494abab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cdfbfd0>]}
[0m17:59:26.355625 [debug] [MainThread]: Parsing macros/unix_to_timestamp.sql
[0m17:59:26.356094 [debug] [MainThread]: Parsing macros/etc.sql
[0m17:59:26.357206 [debug] [MainThread]: Parsing macros/catalog.sql
[0m17:59:26.360543 [debug] [MainThread]: Parsing macros/adapters.sql
[0m17:59:26.371436 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m17:59:26.372733 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m17:59:26.374075 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m17:59:26.377744 [debug] [MainThread]: Parsing macros/materializations/copy.sql
[0m17:59:26.379022 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m17:59:26.387426 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m17:59:26.388203 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m17:59:26.388391 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m17:59:26.388691 [debug] [MainThread]: Parsing macros/utils/timestamps.sql
[0m17:59:26.389183 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m17:59:26.389357 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m17:59:26.389621 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m17:59:26.389922 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m17:59:26.390395 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m17:59:26.390961 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m17:59:26.391198 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m17:59:26.391435 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m17:59:26.391684 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m17:59:26.391921 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m17:59:26.392120 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m17:59:26.392811 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m17:59:26.393056 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m17:59:26.393434 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m17:59:26.393712 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m17:59:26.394907 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m17:59:26.396662 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m17:59:26.397716 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m17:59:26.398471 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m17:59:26.406050 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m17:59:26.412513 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m17:59:26.418453 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m17:59:26.420634 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m17:59:26.421496 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m17:59:26.422342 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m17:59:26.426083 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m17:59:26.433919 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m17:59:26.434667 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m17:59:26.437986 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m17:59:26.443281 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m17:59:26.452153 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m17:59:26.455099 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m17:59:26.456870 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m17:59:26.459564 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m17:59:26.460277 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m17:59:26.461930 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m17:59:26.463011 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m17:59:26.466558 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m17:59:26.476004 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m17:59:26.476767 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m17:59:26.477954 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m17:59:26.478693 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m17:59:26.479115 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m17:59:26.479500 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m17:59:26.479832 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m17:59:26.480460 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m17:59:26.482973 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m17:59:26.487111 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m17:59:26.487552 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m17:59:26.488136 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m17:59:26.488602 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m17:59:26.489042 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m17:59:26.489625 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m17:59:26.490014 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m17:59:26.490536 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m17:59:26.491160 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m17:59:26.492279 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m17:59:26.492848 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m17:59:26.493345 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m17:59:26.493831 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m17:59:26.494298 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m17:59:26.494720 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m17:59:26.495211 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m17:59:26.495622 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m17:59:26.498858 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m17:59:26.499414 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m17:59:26.499879 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m17:59:26.500719 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m17:59:26.501775 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m17:59:26.502264 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m17:59:26.502961 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m17:59:26.503454 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m17:59:26.504423 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m17:59:26.505935 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m17:59:26.507219 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m17:59:26.514259 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m17:59:26.515227 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m17:59:26.521697 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m17:59:26.523736 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m17:59:26.527041 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m17:59:26.531648 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m17:59:26.534617 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m17:59:26.536015 [debug] [MainThread]: Parsing macros/develop.sql
[0m17:59:26.541176 [debug] [MainThread]: Parsing macros/calculate.sql
[0m17:59:26.544250 [debug] [MainThread]: Parsing macros/get_metric_sql.sql
[0m17:59:26.546609 [debug] [MainThread]: Parsing macros/misc/metrics__date_spine.sql
[0m17:59:26.550581 [debug] [MainThread]: Parsing macros/misc/metrics__equality.sql
[0m17:59:26.553848 [debug] [MainThread]: Parsing macros/graph_parsing/get_metric_relation.sql
[0m17:59:26.554343 [debug] [MainThread]: Parsing macros/graph_parsing/get_model_relation.sql
[0m17:59:26.555409 [debug] [MainThread]: Parsing macros/secondary_calculations/secondary_calculation_rolling.sql
[0m17:59:26.556271 [debug] [MainThread]: Parsing macros/secondary_calculations/secondary_calculation_period_to_date.sql
[0m17:59:26.556966 [debug] [MainThread]: Parsing macros/secondary_calculations/secondary_calculation_period_over_period.sql
[0m17:59:26.559432 [debug] [MainThread]: Parsing macros/secondary_calculations/secondary_calculation_prior.sql
[0m17:59:26.560019 [debug] [MainThread]: Parsing macros/secondary_calculations/generate_secondary_calculation_alias.sql
[0m17:59:26.564162 [debug] [MainThread]: Parsing macros/secondary_calculations/perform_secondary_calculation.sql
[0m17:59:26.565942 [debug] [MainThread]: Parsing macros/variables/get_faux_metric_tree.sql
[0m17:59:26.568072 [debug] [MainThread]: Parsing macros/variables/get_metrics_dictionary.sql
[0m17:59:26.569282 [debug] [MainThread]: Parsing macros/variables/get_calendar_dimensions.sql
[0m17:59:26.569905 [debug] [MainThread]: Parsing macros/variables/get_non_calendar_dimension_list.sql
[0m17:59:26.570496 [debug] [MainThread]: Parsing macros/variables/update_metric_tree.sql
[0m17:59:26.572982 [debug] [MainThread]: Parsing macros/variables/get_metric_tree.sql
[0m17:59:26.576190 [debug] [MainThread]: Parsing macros/variables/update_faux_metric_tree.sql
[0m17:59:26.578979 [debug] [MainThread]: Parsing macros/variables/get_metric_model_name.sql
[0m17:59:26.579398 [debug] [MainThread]: Parsing macros/variables/get_grain_order.sql
[0m17:59:26.579919 [debug] [MainThread]: Parsing macros/variables/get_relevent_periods.sql
[0m17:59:26.580456 [debug] [MainThread]: Parsing macros/variables/get_develop_unique_metric_id_list.sql
[0m17:59:26.581222 [debug] [MainThread]: Parsing macros/variables/get_metric_list.sql
[0m17:59:26.582107 [debug] [MainThread]: Parsing macros/variables/get_metric_definition.sql
[0m17:59:26.584641 [debug] [MainThread]: Parsing macros/variables/get_metric_unique_id_list.sql
[0m17:59:26.585542 [debug] [MainThread]: Parsing macros/variables/get_metric_allowlist.sql
[0m17:59:26.586608 [debug] [MainThread]: Parsing macros/variables/get_base_metrics.sql
[0m17:59:26.587807 [debug] [MainThread]: Parsing macros/sql_gen/gen_final_cte.sql
[0m17:59:26.591161 [debug] [MainThread]: Parsing macros/sql_gen/build_metric_sql.sql
[0m17:59:26.592722 [debug] [MainThread]: Parsing macros/sql_gen/gen_dimensions_cte.sql
[0m17:59:26.593424 [debug] [MainThread]: Parsing macros/sql_gen/gen_filters.sql
[0m17:59:26.594853 [debug] [MainThread]: Parsing macros/sql_gen/gen_order_by.sql
[0m17:59:26.596004 [debug] [MainThread]: Parsing macros/sql_gen/gen_spine_time_cte.sql
[0m17:59:26.597619 [debug] [MainThread]: Parsing macros/sql_gen/gen_secondary_calculations_cte.sql
[0m17:59:26.599700 [debug] [MainThread]: Parsing macros/sql_gen/gen_calendar_cte.sql
[0m17:59:26.600677 [debug] [MainThread]: Parsing macros/sql_gen/gen_metric_cte.sql
[0m17:59:26.605538 [debug] [MainThread]: Parsing macros/sql_gen/gen_group_by.sql
[0m17:59:26.607088 [debug] [MainThread]: Parsing macros/sql_gen/gen_base_query.sql
[0m17:59:26.609265 [debug] [MainThread]: Parsing macros/sql_gen/gen_calendar_table_join.sql
[0m17:59:26.612451 [debug] [MainThread]: Parsing macros/sql_gen/gen_aggregate_cte.sql
[0m17:59:26.614790 [debug] [MainThread]: Parsing macros/sql_gen/gen_primary_metric_aggregate.sql
[0m17:59:26.618130 [debug] [MainThread]: Parsing macros/sql_gen/gen_joined_metrics_cte.sql
[0m17:59:26.629350 [debug] [MainThread]: Parsing macros/secondary_calculations_configuration/period_over_period.sql
[0m17:59:26.630641 [debug] [MainThread]: Parsing macros/secondary_calculations_configuration/prior.sql
[0m17:59:26.631671 [debug] [MainThread]: Parsing macros/secondary_calculations_configuration/period_to_date.sql
[0m17:59:26.632915 [debug] [MainThread]: Parsing macros/secondary_calculations_configuration/rolling.sql
[0m17:59:26.633977 [debug] [MainThread]: Parsing macros/validation/is_valid_dimension.sql
[0m17:59:26.634388 [debug] [MainThread]: Parsing macros/validation/validate_aggregate_coherence.sql
[0m17:59:26.634945 [debug] [MainThread]: Parsing macros/validation/validate_develop_grain.sql
[0m17:59:26.635736 [debug] [MainThread]: Parsing macros/validation/validate_derived_metrics.sql
[0m17:59:26.636538 [debug] [MainThread]: Parsing macros/validation/validate_grain_order.sql
[0m17:59:26.637685 [debug] [MainThread]: Parsing macros/validation/validate_dimension_list.sql
[0m17:59:26.638882 [debug] [MainThread]: Parsing macros/validation/validate_metric_config.sql
[0m17:59:26.640306 [debug] [MainThread]: Parsing macros/validation/validate_grain.sql
[0m17:59:26.641848 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m17:59:26.642745 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m17:59:26.643995 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m17:59:26.644694 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m17:59:26.646803 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m17:59:26.648793 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m17:59:26.649852 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m17:59:26.651460 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m17:59:26.652439 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m17:59:26.653636 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m17:59:26.654665 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m17:59:26.655754 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m17:59:26.657081 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m17:59:26.658045 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m17:59:26.658876 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m17:59:26.660419 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m17:59:26.662277 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m17:59:26.663976 [debug] [MainThread]: Parsing macros/generic_tests/not_empty_string.sql
[0m17:59:26.664843 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m17:59:26.669660 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m17:59:26.670184 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_relation.sql
[0m17:59:26.670704 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m17:59:26.671262 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m17:59:26.671760 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m17:59:26.672444 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_ephemeral.sql
[0m17:59:26.673329 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m17:59:26.675255 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m17:59:26.675986 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m17:59:26.677617 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m17:59:26.679605 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m17:59:26.681175 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m17:59:26.681932 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m17:59:26.684602 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m17:59:26.687566 [debug] [MainThread]: Parsing macros/sql/safe_divide.sql
[0m17:59:26.688066 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m17:59:26.694499 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m17:59:26.695136 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m17:59:26.696899 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m17:59:26.697589 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m17:59:26.698575 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m17:59:26.699321 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m17:59:26.702717 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m17:59:26.705355 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m17:59:26.707308 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m17:59:26.708566 [debug] [MainThread]: Parsing macros/sql/width_bucket.sql
[0m17:59:26.711088 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m17:59:26.712138 [debug] [MainThread]: Parsing macros/sql/generate_surrogate_key.sql
[0m17:59:26.713306 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m17:59:26.714027 [debug] [MainThread]: Parsing macros/sql/get_single_value.sql
[0m17:59:26.715422 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m17:59:26.960682 [debug] [MainThread]: 1603: static parser failed on stating/stg_referrals.sql
[0m17:59:26.968126 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stating/stg_referrals.sql
[0m17:59:26.968896 [debug] [MainThread]: 1603: static parser failed on stating/stg_partners.sql
[0m17:59:26.971378 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stating/stg_partners.sql
[0m17:59:26.972062 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_referrals.sql
[0m17:59:26.994209 [debug] [MainThread]: 1603: static parser failed on dbt_metrics_default_calendar.sql
[0m17:59:27.011040 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dbt_metrics_default_calendar.sql
[0m17:59:27.047538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d186490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d1c1f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d1c1d60>]}
[0m17:59:27.047741 [debug] [MainThread]: Flushing usage events
[0m17:59:27.766826 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid metrics config given in FilePath(searched_path='models', relative_path='marts/referrals.yml', modification_time=1673027962.565051, project_root='/Users/joaopaulomedeiroscecilio/dev/ggchallenge/ggchallengejoao') @ metrics: {'name': 'referral_total_count', 'model': "ref('mart_referrals')", 'description': 'Total count of referrals', 'calculation_method': 'count_distinct', 'expression': 'id', 'timestamp': 'referral_record_date', 'time_grains': ['day', 'month', 'week', 'quarter', 'year'], 'dimensions': ['status', 'partner', 'company', 'referral_lead_sales_contact', 'referral_country']} - at path []: 'label' is a required property


============================== 2023-01-06 18:00:17.132227 | 29394eae-87d3-498a-975e-61a40a5fa444 ==============================
[0m18:00:17.132244 [info ] [MainThread]: Running with dbt=1.3.2
[0m18:00:17.132878 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joaopaulomedeiroscecilio/dev/dbt-data-analysis', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:00:17.132984 [debug] [MainThread]: Tracking: tracking
[0m18:00:17.143804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f33af10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f353130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f3530d0>]}
[0m18:00:17.177962 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m18:00:17.178264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '29394eae-87d3-498a-975e-61a40a5fa444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f19d370>]}
[0m18:00:17.227265 [debug] [MainThread]: Parsing macros/unix_to_timestamp.sql
[0m18:00:17.227831 [debug] [MainThread]: Parsing macros/etc.sql
[0m18:00:17.228939 [debug] [MainThread]: Parsing macros/catalog.sql
[0m18:00:17.232691 [debug] [MainThread]: Parsing macros/adapters.sql
[0m18:00:17.243040 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m18:00:17.244235 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m18:00:17.245548 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m18:00:17.249152 [debug] [MainThread]: Parsing macros/materializations/copy.sql
[0m18:00:17.250422 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m18:00:17.258969 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m18:00:17.259791 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m18:00:17.259992 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m18:00:17.260295 [debug] [MainThread]: Parsing macros/utils/timestamps.sql
[0m18:00:17.260792 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m18:00:17.260982 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m18:00:17.261260 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m18:00:17.261573 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m18:00:17.262064 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m18:00:17.262669 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m18:00:17.262924 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m18:00:17.263154 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m18:00:17.263402 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m18:00:17.263648 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m18:00:17.263849 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m18:00:17.264545 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m18:00:17.264801 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m18:00:17.265187 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m18:00:17.265467 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m18:00:17.266667 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m18:00:17.268497 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m18:00:17.269552 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m18:00:17.270329 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m18:00:17.277980 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m18:00:17.284694 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m18:00:17.290597 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m18:00:17.292680 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m18:00:17.293496 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m18:00:17.294322 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m18:00:17.298054 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m18:00:17.305719 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m18:00:17.306431 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m18:00:17.309645 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m18:00:17.314624 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m18:00:17.323120 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m18:00:17.325724 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m18:00:17.327328 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m18:00:17.329890 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m18:00:17.330481 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m18:00:17.332067 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m18:00:17.333129 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m18:00:17.336404 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m18:00:17.345453 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m18:00:17.346156 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m18:00:17.347299 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m18:00:17.348008 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m18:00:17.348430 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m18:00:17.348805 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m18:00:17.349124 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m18:00:17.349842 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m18:00:17.352411 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m18:00:17.356468 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m18:00:17.356869 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m18:00:17.357452 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m18:00:17.357913 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m18:00:17.358379 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m18:00:17.358969 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m18:00:17.359352 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m18:00:17.359835 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m18:00:17.360414 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m18:00:17.361505 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m18:00:17.362251 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m18:00:17.362792 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m18:00:17.363281 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m18:00:17.363759 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m18:00:17.364196 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m18:00:17.364708 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m18:00:17.365159 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m18:00:17.368349 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m18:00:17.368859 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m18:00:17.369283 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m18:00:17.370157 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m18:00:17.371209 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m18:00:17.371695 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m18:00:17.372403 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m18:00:17.372902 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m18:00:17.373882 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m18:00:17.375392 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m18:00:17.376688 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m18:00:17.383651 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m18:00:17.384564 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m18:00:17.390912 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m18:00:17.392986 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m18:00:17.396307 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m18:00:17.400902 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m18:00:17.403767 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m18:00:17.405139 [debug] [MainThread]: Parsing macros/develop.sql
[0m18:00:17.410317 [debug] [MainThread]: Parsing macros/calculate.sql
[0m18:00:17.413456 [debug] [MainThread]: Parsing macros/get_metric_sql.sql
[0m18:00:17.415865 [debug] [MainThread]: Parsing macros/misc/metrics__date_spine.sql
[0m18:00:17.419985 [debug] [MainThread]: Parsing macros/misc/metrics__equality.sql
[0m18:00:17.423303 [debug] [MainThread]: Parsing macros/graph_parsing/get_metric_relation.sql
[0m18:00:17.423812 [debug] [MainThread]: Parsing macros/graph_parsing/get_model_relation.sql
[0m18:00:17.424925 [debug] [MainThread]: Parsing macros/secondary_calculations/secondary_calculation_rolling.sql
[0m18:00:17.425822 [debug] [MainThread]: Parsing macros/secondary_calculations/secondary_calculation_period_to_date.sql
[0m18:00:17.426551 [debug] [MainThread]: Parsing macros/secondary_calculations/secondary_calculation_period_over_period.sql
[0m18:00:17.429046 [debug] [MainThread]: Parsing macros/secondary_calculations/secondary_calculation_prior.sql
[0m18:00:17.429634 [debug] [MainThread]: Parsing macros/secondary_calculations/generate_secondary_calculation_alias.sql
[0m18:00:17.433782 [debug] [MainThread]: Parsing macros/secondary_calculations/perform_secondary_calculation.sql
[0m18:00:17.435569 [debug] [MainThread]: Parsing macros/variables/get_faux_metric_tree.sql
[0m18:00:17.437671 [debug] [MainThread]: Parsing macros/variables/get_metrics_dictionary.sql
[0m18:00:17.438866 [debug] [MainThread]: Parsing macros/variables/get_calendar_dimensions.sql
[0m18:00:17.439492 [debug] [MainThread]: Parsing macros/variables/get_non_calendar_dimension_list.sql
[0m18:00:17.440084 [debug] [MainThread]: Parsing macros/variables/update_metric_tree.sql
[0m18:00:17.442497 [debug] [MainThread]: Parsing macros/variables/get_metric_tree.sql
[0m18:00:17.445635 [debug] [MainThread]: Parsing macros/variables/update_faux_metric_tree.sql
[0m18:00:17.448483 [debug] [MainThread]: Parsing macros/variables/get_metric_model_name.sql
[0m18:00:17.448932 [debug] [MainThread]: Parsing macros/variables/get_grain_order.sql
[0m18:00:17.449476 [debug] [MainThread]: Parsing macros/variables/get_relevent_periods.sql
[0m18:00:17.450027 [debug] [MainThread]: Parsing macros/variables/get_develop_unique_metric_id_list.sql
[0m18:00:17.450839 [debug] [MainThread]: Parsing macros/variables/get_metric_list.sql
[0m18:00:17.451726 [debug] [MainThread]: Parsing macros/variables/get_metric_definition.sql
[0m18:00:17.454239 [debug] [MainThread]: Parsing macros/variables/get_metric_unique_id_list.sql
[0m18:00:17.455129 [debug] [MainThread]: Parsing macros/variables/get_metric_allowlist.sql
[0m18:00:17.456199 [debug] [MainThread]: Parsing macros/variables/get_base_metrics.sql
[0m18:00:17.457401 [debug] [MainThread]: Parsing macros/sql_gen/gen_final_cte.sql
[0m18:00:17.460852 [debug] [MainThread]: Parsing macros/sql_gen/build_metric_sql.sql
[0m18:00:17.462551 [debug] [MainThread]: Parsing macros/sql_gen/gen_dimensions_cte.sql
[0m18:00:17.463273 [debug] [MainThread]: Parsing macros/sql_gen/gen_filters.sql
[0m18:00:17.464713 [debug] [MainThread]: Parsing macros/sql_gen/gen_order_by.sql
[0m18:00:17.465901 [debug] [MainThread]: Parsing macros/sql_gen/gen_spine_time_cte.sql
[0m18:00:17.467624 [debug] [MainThread]: Parsing macros/sql_gen/gen_secondary_calculations_cte.sql
[0m18:00:17.469764 [debug] [MainThread]: Parsing macros/sql_gen/gen_calendar_cte.sql
[0m18:00:17.470747 [debug] [MainThread]: Parsing macros/sql_gen/gen_metric_cte.sql
[0m18:00:17.475657 [debug] [MainThread]: Parsing macros/sql_gen/gen_group_by.sql
[0m18:00:17.477229 [debug] [MainThread]: Parsing macros/sql_gen/gen_base_query.sql
[0m18:00:17.479421 [debug] [MainThread]: Parsing macros/sql_gen/gen_calendar_table_join.sql
[0m18:00:17.482578 [debug] [MainThread]: Parsing macros/sql_gen/gen_aggregate_cte.sql
[0m18:00:17.484901 [debug] [MainThread]: Parsing macros/sql_gen/gen_primary_metric_aggregate.sql
[0m18:00:17.488271 [debug] [MainThread]: Parsing macros/sql_gen/gen_joined_metrics_cte.sql
[0m18:00:17.499461 [debug] [MainThread]: Parsing macros/secondary_calculations_configuration/period_over_period.sql
[0m18:00:17.500730 [debug] [MainThread]: Parsing macros/secondary_calculations_configuration/prior.sql
[0m18:00:17.501755 [debug] [MainThread]: Parsing macros/secondary_calculations_configuration/period_to_date.sql
[0m18:00:17.503000 [debug] [MainThread]: Parsing macros/secondary_calculations_configuration/rolling.sql
[0m18:00:17.504064 [debug] [MainThread]: Parsing macros/validation/is_valid_dimension.sql
[0m18:00:17.504477 [debug] [MainThread]: Parsing macros/validation/validate_aggregate_coherence.sql
[0m18:00:17.505004 [debug] [MainThread]: Parsing macros/validation/validate_develop_grain.sql
[0m18:00:17.505752 [debug] [MainThread]: Parsing macros/validation/validate_derived_metrics.sql
[0m18:00:17.506518 [debug] [MainThread]: Parsing macros/validation/validate_grain_order.sql
[0m18:00:17.507624 [debug] [MainThread]: Parsing macros/validation/validate_dimension_list.sql
[0m18:00:17.508823 [debug] [MainThread]: Parsing macros/validation/validate_metric_config.sql
[0m18:00:17.510235 [debug] [MainThread]: Parsing macros/validation/validate_grain.sql
[0m18:00:17.511772 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m18:00:17.512667 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m18:00:17.513949 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m18:00:17.514659 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m18:00:17.516843 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m18:00:17.518825 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m18:00:17.519891 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m18:00:17.521549 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m18:00:17.522594 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m18:00:17.523754 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m18:00:17.524752 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m18:00:17.525826 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m18:00:17.527140 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m18:00:17.528108 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m18:00:17.528942 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m18:00:17.530445 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m18:00:17.532338 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m18:00:17.534079 [debug] [MainThread]: Parsing macros/generic_tests/not_empty_string.sql
[0m18:00:17.534972 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m18:00:17.539757 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m18:00:17.540290 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_relation.sql
[0m18:00:17.540813 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m18:00:17.541374 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m18:00:17.541876 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m18:00:17.542585 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_ephemeral.sql
[0m18:00:17.543502 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m18:00:17.545456 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m18:00:17.546183 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m18:00:17.547822 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m18:00:17.549812 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m18:00:17.551385 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m18:00:17.552141 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m18:00:17.554810 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m18:00:17.557832 [debug] [MainThread]: Parsing macros/sql/safe_divide.sql
[0m18:00:17.558356 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m18:00:17.564780 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m18:00:17.565404 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m18:00:17.567169 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m18:00:17.567868 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m18:00:17.568856 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m18:00:17.569599 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m18:00:17.572980 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m18:00:17.575628 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m18:00:17.577558 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m18:00:17.578827 [debug] [MainThread]: Parsing macros/sql/width_bucket.sql
[0m18:00:17.581375 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m18:00:17.582426 [debug] [MainThread]: Parsing macros/sql/generate_surrogate_key.sql
[0m18:00:17.583606 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m18:00:17.584342 [debug] [MainThread]: Parsing macros/sql/get_single_value.sql
[0m18:00:17.585715 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m18:00:17.832003 [debug] [MainThread]: 1603: static parser failed on stating/stg_referrals.sql
[0m18:00:17.839408 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stating/stg_referrals.sql
[0m18:00:17.840085 [debug] [MainThread]: 1603: static parser failed on stating/stg_partners.sql
[0m18:00:17.842573 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stating/stg_partners.sql
[0m18:00:17.843281 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_referrals.sql
[0m18:00:17.865676 [debug] [MainThread]: 1603: static parser failed on dbt_metrics_default_calendar.sql
[0m18:00:17.882441 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dbt_metrics_default_calendar.sql
[0m18:00:17.946149 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ggchallengejoao.example

[0m18:00:17.949590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29394eae-87d3-498a-975e-61a40a5fa444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f83e0d0>]}
[0m18:00:17.958947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29394eae-87d3-498a-975e-61a40a5fa444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f33af10>]}
[0m18:00:17.959339 [info ] [MainThread]: Found 4 models, 6 tests, 0 snapshots, 0 analyses, 533 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 2 metrics
[0m18:00:17.959519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29394eae-87d3-498a-975e-61a40a5fa444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f7014c0>]}
[0m18:00:17.960809 [info ] [MainThread]: 
[0m18:00:17.961214 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m18:00:17.961829 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801"
[0m18:00:17.961981 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:20.241133 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801_getgroundjoao"
[0m18:00:20.241720 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:20.672727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29394eae-87d3-498a-975e-61a40a5fa444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f366c10>]}
[0m18:00:20.674209 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:00:20.674690 [info ] [MainThread]: 
[0m18:00:20.682193 [debug] [Thread-1  ]: Began running node model.ggchallengejoao.stg_partners
[0m18:00:20.682438 [debug] [Thread-2  ]: Began running node model.ggchallengejoao.stg_referrals
[0m18:00:20.682662 [debug] [Thread-3  ]: Began running node model.metrics.dbt_metrics_default_calendar
[0m18:00:20.683193 [info ] [Thread-1  ]: 1 of 4 START sql view model getgroundjoao.stg_partners ......................... [RUN]
[0m18:00:20.683598 [info ] [Thread-2  ]: 2 of 4 START sql view model getgroundjoao.stg_referrals ........................ [RUN]
[0m18:00:20.684153 [info ] [Thread-3  ]: 3 of 4 START sql table model getgroundjoao.dbt_metrics_default_calendar ........ [RUN]
[0m18:00:20.685302 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_partners"
[0m18:00:20.686566 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_referrals"
[0m18:00:20.687707 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.metrics.dbt_metrics_default_calendar"
[0m18:00:20.688038 [debug] [Thread-1  ]: Began compiling node model.ggchallengejoao.stg_partners
[0m18:00:20.688302 [debug] [Thread-2  ]: Began compiling node model.ggchallengejoao.stg_referrals
[0m18:00:20.688535 [debug] [Thread-3  ]: Began compiling node model.metrics.dbt_metrics_default_calendar
[0m18:00:20.689211 [debug] [Thread-1  ]: Compiling model.ggchallengejoao.stg_partners
[0m18:00:20.689447 [debug] [Thread-2  ]: Compiling model.ggchallengejoao.stg_referrals
[0m18:00:20.689678 [debug] [Thread-3  ]: Compiling model.metrics.dbt_metrics_default_calendar
[0m18:00:20.697344 [debug] [Thread-1  ]: Writing injected SQL for node "model.ggchallengejoao.stg_partners"
[0m18:00:20.702382 [debug] [Thread-2  ]: Writing injected SQL for node "model.ggchallengejoao.stg_referrals"
[0m18:00:20.712149 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:00:20.712739 [debug] [Thread-3  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */


        select 

    datetime_diff(
        cast(cast('2030-01-01' as date) as datetime),
        cast(cast('1990-01-01' as date) as datetime),
        day
    )

  
[0m18:00:20.714395 [debug] [Thread-2  ]: finished collecting timing info
[0m18:00:20.714567 [debug] [Thread-1  ]: finished collecting timing info
[0m18:00:20.715589 [debug] [Thread-2  ]: Began executing node model.ggchallengejoao.stg_referrals
[0m18:00:20.715911 [debug] [Thread-1  ]: Began executing node model.ggchallengejoao.stg_partners
[0m18:00:20.741656 [debug] [Thread-1  ]: Writing runtime sql for node "model.ggchallengejoao.stg_partners"
[0m18:00:20.743744 [debug] [Thread-2  ]: Writing runtime sql for node "model.ggchallengejoao.stg_referrals"
[0m18:00:20.743872 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:00:20.744095 [debug] [Thread-1  ]: On model.ggchallengejoao.stg_partners: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.stg_partners"} */


  create or replace view `dynamic-point-367801`.`getgroundjoao`.`stg_partners`
  OPTIONS()
  as 

select *
except
    (lead_sales_contact, created_at, updated_at),
    if(
        lead_sales_contact = '0', 'No contact', lead_sales_contact
    ) as lead_sales_contact,
    
timestamp_micros(cast(created_at/ 1000 as int64))
 as partner_created_at_timestamp,
    
timestamp_micros(cast(updated_at/ 1000 as int64))
 as partner_updated_at_timestamp
from `dynamic-point-367801`.`getgroundjoao`.`partners`;


[0m18:00:20.744580 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m18:00:20.744715 [debug] [Thread-2  ]: On model.ggchallengejoao.stg_referrals: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.stg_referrals"} */


  create or replace view `dynamic-point-367801`.`getgroundjoao`.`stg_referrals`
  OPTIONS()
  as 

select *
except
    (created_at, updated_at),
    
timestamp_micros(cast(created_at/ 1000 as int64))
 as referral_created_at_timestamp,
    
timestamp_micros(cast(updated_at/ 1000 as int64))
 as referral_updated_at_timestamp
from `dynamic-point-367801`.`getgroundjoao`.`referrals`;


[0m18:00:21.939415 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:7e508201-240b-4445-bee5-4736d75548de:EU&page=queryresults
[0m18:00:21.961288 [debug] [Thread-1  ]: finished collecting timing info
[0m18:00:21.962960 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:092231c7-01d0-45f5-bed2-d91277d2b82a:EU&page=queryresults
[0m18:00:21.963615 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29394eae-87d3-498a-975e-61a40a5fa444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f9230d0>]}
[0m18:00:21.964808 [debug] [Thread-2  ]: finished collecting timing info
[0m18:00:21.965184 [info ] [Thread-1  ]: 1 of 4 OK created sql view model getgroundjoao.stg_partners .................... [[32mCREATE VIEW (0 processed)[0m in 1.28s]
[0m18:00:21.965688 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29394eae-87d3-498a-975e-61a40a5fa444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f919d90>]}
[0m18:00:21.966125 [debug] [Thread-1  ]: Finished running node model.ggchallengejoao.stg_partners
[0m18:00:21.966412 [info ] [Thread-2  ]: 2 of 4 OK created sql view model getgroundjoao.stg_referrals ................... [[32mCREATE VIEW (0 processed)[0m in 1.28s]
[0m18:00:21.966978 [debug] [Thread-2  ]: Finished running node model.ggchallengejoao.stg_referrals
[0m18:00:21.967301 [debug] [Thread-4  ]: Began running node model.ggchallengejoao.mart_referrals
[0m18:00:21.967563 [info ] [Thread-4  ]: 4 of 4 START sql table model getgroundjoao.mart_referrals ...................... [RUN]
[0m18:00:21.968200 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.ggchallengejoao.mart_referrals"
[0m18:00:21.968353 [debug] [Thread-4  ]: Began compiling node model.ggchallengejoao.mart_referrals
[0m18:00:21.968490 [debug] [Thread-4  ]: Compiling model.ggchallengejoao.mart_referrals
[0m18:00:21.972436 [debug] [Thread-4  ]: Writing injected SQL for node "model.ggchallengejoao.mart_referrals"
[0m18:00:21.973939 [debug] [Thread-4  ]: finished collecting timing info
[0m18:00:21.974142 [debug] [Thread-4  ]: Began executing node model.ggchallengejoao.mart_referrals
[0m18:00:21.984686 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m18:00:22.467273 [debug] [Thread-4  ]: Writing runtime sql for node "model.ggchallengejoao.mart_referrals"
[0m18:00:22.468907 [debug] [Thread-4  ]: On model.ggchallengejoao.mart_referrals: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.mart_referrals"} */

  
    

    create or replace table `dynamic-point-367801`.`getgroundjoao`.`mart_referrals`
    
    
    OPTIONS()
    as (
      

select
    r.company_id as referral_company,
    r.partner_id as referral_partner,
    r.status as referral_status,
    r.is_outbound as referral_outbound,
    r.referral_created_at_timestamp as referral_record_date,
    r.referral_updated_at_timestamp as referral_updated,
    timestamp_diff(
        referral_updated_at_timestamp, referral_created_at_timestamp, day
    ) as referral_days_from_creation,
    p.partner_type as referral_partner_type,
    p.lead_sales_contact as referral_lead_sales_contact,
    coalesce(d.country, 'No country') as referral_country
from `dynamic-point-367801`.`getgroundjoao`.`stg_referrals` r
left join `dynamic-point-367801`.`getgroundjoao`.`partners` p on r.partner_id = p.id
left join `dynamic-point-367801`.`getgroundjoao`.`sales_people` d on p.lead_sales_contact = d.name
    );
  
[0m18:00:22.574775 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:9a9ee864-b3ba-40cd-8e98-dee5285c9edb:EU&page=queryresults
[0m18:00:22.582048 [debug] [Thread-3  ]: Writing injected SQL for node "model.metrics.dbt_metrics_default_calendar"
[0m18:00:22.583338 [debug] [Thread-3  ]: finished collecting timing info
[0m18:00:22.583591 [debug] [Thread-3  ]: Began executing node model.metrics.dbt_metrics_default_calendar
[0m18:00:22.588412 [debug] [Thread-3  ]: Writing runtime sql for node "model.metrics.dbt_metrics_default_calendar"
[0m18:00:22.589338 [debug] [Thread-3  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */

  
    

    create or replace table `dynamic-point-367801`.`getgroundjoao`.`dbt_metrics_default_calendar`
    
    
    OPTIONS()
    as (
      

with days as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
     + 
    
    p11.generated_number * power(2, 11)
     + 
    
    p12.generated_number * power(2, 12)
     + 
    
    p13.generated_number * power(2, 13)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
     cross join 
    
    p as p11
     cross join 
    
    p as p12
     cross join 
    
    p as p13
    
    

    )

    select *
    from unioned
    where generated_number <= 14610
    order by generated_number



),

all_periods as (

    select (
        

        datetime_add(
            cast( cast('1990-01-01' as date) as datetime),
        interval row_number() over (order by 1) - 1 day
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2030-01-01' as date)

)

select * from filtered


),

final as (
    select 
        cast(date_day as date) as date_day,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        week
    ) as date) as date_week,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        month
    ) as date) as date_month,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        quarter
    ) as date) as date_quarter,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        year
    ) as date) as date_year
    from days
)

select * from final
    );
  
[0m18:00:25.143232 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:81bd8da6-2a11-436e-a73d-697538a3e8db:EU&page=queryresults
[0m18:00:25.150798 [debug] [Thread-4  ]: finished collecting timing info
[0m18:00:25.151437 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29394eae-87d3-498a-975e-61a40a5fa444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f97cd60>]}
[0m18:00:25.151833 [info ] [Thread-4  ]: 4 of 4 OK created sql table model getgroundjoao.mart_referrals ................. [[32mCREATE TABLE (1.5k rows, 84.8 KB processed)[0m in 3.18s]
[0m18:00:25.152329 [debug] [Thread-4  ]: Finished running node model.ggchallengejoao.mart_referrals
[0m18:00:25.659112 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:1bf7f3d3-5c5e-41fe-ba10-12bd7f30b772:EU&page=queryresults
[0m18:00:25.660007 [debug] [Thread-3  ]: finished collecting timing info
[0m18:00:25.660386 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29394eae-87d3-498a-975e-61a40a5fa444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f9e0f70>]}
[0m18:00:25.660595 [info ] [Thread-3  ]: 3 of 4 OK created sql table model getgroundjoao.dbt_metrics_default_calendar ... [[32mCREATE TABLE (14.6k rows, 0 processed)[0m in 4.97s]
[0m18:00:25.660847 [debug] [Thread-3  ]: Finished running node model.metrics.dbt_metrics_default_calendar
[0m18:00:25.662771 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m18:00:25.663215 [info ] [MainThread]: 
[0m18:00:25.663377 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 7.70 seconds (7.70s).
[0m18:00:25.663541 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:00:25.663609 [debug] [MainThread]: Connection 'model.ggchallengejoao.stg_partners' was properly closed.
[0m18:00:25.663673 [debug] [MainThread]: Connection 'model.ggchallengejoao.stg_referrals' was properly closed.
[0m18:00:25.663736 [debug] [MainThread]: Connection 'model.metrics.dbt_metrics_default_calendar' was properly closed.
[0m18:00:25.663800 [debug] [MainThread]: Connection 'model.ggchallengejoao.mart_referrals' was properly closed.
[0m18:00:25.683961 [info ] [MainThread]: 
[0m18:00:25.684528 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:00:25.684786 [info ] [MainThread]: 
[0m18:00:25.685042 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m18:00:25.685798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f80abb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f80aaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f8e58e0>]}
[0m18:00:25.686598 [debug] [MainThread]: Flushing usage events


============================== 2023-01-06 18:07:12.042870 | 9debc2b6-b859-4338-a1c6-3bdab9ca1e54 ==============================
[0m18:07:12.042897 [info ] [MainThread]: Running with dbt=1.3.2
[0m18:07:12.043694 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joaopaulomedeiroscecilio/dev/ggchallenge/ggchallengejoao', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m18:07:12.043818 [debug] [MainThread]: Tracking: tracking
[0m18:07:12.056564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a6cc760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a6cc8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a6cc880>]}
[0m18:07:12.087733 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:07:12.088001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9debc2b6-b859-4338-a1c6-3bdab9ca1e54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1182974f0>]}
[0m18:07:12.142235 [debug] [MainThread]: Parsing macros/unix_to_timestamp.sql
[0m18:07:12.142727 [debug] [MainThread]: Parsing macros/etc.sql
[0m18:07:12.143780 [debug] [MainThread]: Parsing macros/catalog.sql
[0m18:07:12.147432 [debug] [MainThread]: Parsing macros/adapters.sql
[0m18:07:12.158219 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m18:07:12.159531 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m18:07:12.160960 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m18:07:12.164632 [debug] [MainThread]: Parsing macros/materializations/copy.sql
[0m18:07:12.165939 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m18:07:12.174447 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m18:07:12.175213 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m18:07:12.175401 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m18:07:12.175698 [debug] [MainThread]: Parsing macros/utils/timestamps.sql
[0m18:07:12.176187 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m18:07:12.176361 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m18:07:12.176618 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m18:07:12.176932 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m18:07:12.177385 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m18:07:12.177950 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m18:07:12.178187 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m18:07:12.178425 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m18:07:12.178685 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m18:07:12.178929 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m18:07:12.179133 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m18:07:12.179824 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m18:07:12.180071 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m18:07:12.180450 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m18:07:12.180735 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m18:07:12.181918 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m18:07:12.183707 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m18:07:12.184887 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m18:07:12.185699 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m18:07:12.193377 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m18:07:12.200213 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m18:07:12.206336 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m18:07:12.208458 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m18:07:12.209267 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m18:07:12.210079 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m18:07:12.214007 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m18:07:12.222253 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m18:07:12.223757 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m18:07:12.227447 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m18:07:12.232763 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m18:07:12.241334 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m18:07:12.244091 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m18:07:12.245769 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m18:07:12.248308 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m18:07:12.248899 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m18:07:12.250520 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m18:07:12.251584 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m18:07:12.254896 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m18:07:12.264982 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m18:07:12.265885 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m18:07:12.267192 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m18:07:12.268135 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m18:07:12.268624 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m18:07:12.269121 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m18:07:12.269489 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m18:07:12.270173 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m18:07:12.272775 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m18:07:12.277041 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m18:07:12.277532 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m18:07:12.278135 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m18:07:12.278610 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m18:07:12.279062 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m18:07:12.279666 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m18:07:12.280061 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m18:07:12.280572 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m18:07:12.281170 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m18:07:12.282277 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m18:07:12.282849 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m18:07:12.283355 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m18:07:12.283836 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m18:07:12.284316 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m18:07:12.284737 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m18:07:12.285231 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m18:07:12.285643 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m18:07:12.288815 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m18:07:12.289317 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m18:07:12.289736 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m18:07:12.290586 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m18:07:12.291791 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m18:07:12.292293 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m18:07:12.293002 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m18:07:12.293525 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m18:07:12.294492 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m18:07:12.296022 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m18:07:12.297303 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m18:07:12.304578 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m18:07:12.305682 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m18:07:12.312230 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m18:07:12.314298 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m18:07:12.317622 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m18:07:12.322275 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m18:07:12.325283 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m18:07:12.326672 [debug] [MainThread]: Parsing macros/develop.sql
[0m18:07:12.338873 [debug] [MainThread]: Parsing macros/calculate.sql
[0m18:07:12.342770 [debug] [MainThread]: Parsing macros/get_metric_sql.sql
[0m18:07:12.345367 [debug] [MainThread]: Parsing macros/misc/metrics__date_spine.sql
[0m18:07:12.350238 [debug] [MainThread]: Parsing macros/misc/metrics__equality.sql
[0m18:07:12.354102 [debug] [MainThread]: Parsing macros/graph_parsing/get_metric_relation.sql
[0m18:07:12.354791 [debug] [MainThread]: Parsing macros/graph_parsing/get_model_relation.sql
[0m18:07:12.356021 [debug] [MainThread]: Parsing macros/secondary_calculations/secondary_calculation_rolling.sql
[0m18:07:12.356960 [debug] [MainThread]: Parsing macros/secondary_calculations/secondary_calculation_period_to_date.sql
[0m18:07:12.357665 [debug] [MainThread]: Parsing macros/secondary_calculations/secondary_calculation_period_over_period.sql
[0m18:07:12.360230 [debug] [MainThread]: Parsing macros/secondary_calculations/secondary_calculation_prior.sql
[0m18:07:12.360820 [debug] [MainThread]: Parsing macros/secondary_calculations/generate_secondary_calculation_alias.sql
[0m18:07:12.364945 [debug] [MainThread]: Parsing macros/secondary_calculations/perform_secondary_calculation.sql
[0m18:07:12.366741 [debug] [MainThread]: Parsing macros/variables/get_faux_metric_tree.sql
[0m18:07:12.369288 [debug] [MainThread]: Parsing macros/variables/get_metrics_dictionary.sql
[0m18:07:12.370592 [debug] [MainThread]: Parsing macros/variables/get_calendar_dimensions.sql
[0m18:07:12.371275 [debug] [MainThread]: Parsing macros/variables/get_non_calendar_dimension_list.sql
[0m18:07:12.371951 [debug] [MainThread]: Parsing macros/variables/update_metric_tree.sql
[0m18:07:12.374433 [debug] [MainThread]: Parsing macros/variables/get_metric_tree.sql
[0m18:07:12.377515 [debug] [MainThread]: Parsing macros/variables/update_faux_metric_tree.sql
[0m18:07:12.380457 [debug] [MainThread]: Parsing macros/variables/get_metric_model_name.sql
[0m18:07:12.380890 [debug] [MainThread]: Parsing macros/variables/get_grain_order.sql
[0m18:07:12.381412 [debug] [MainThread]: Parsing macros/variables/get_relevent_periods.sql
[0m18:07:12.381943 [debug] [MainThread]: Parsing macros/variables/get_develop_unique_metric_id_list.sql
[0m18:07:12.382762 [debug] [MainThread]: Parsing macros/variables/get_metric_list.sql
[0m18:07:12.383665 [debug] [MainThread]: Parsing macros/variables/get_metric_definition.sql
[0m18:07:12.386183 [debug] [MainThread]: Parsing macros/variables/get_metric_unique_id_list.sql
[0m18:07:12.387069 [debug] [MainThread]: Parsing macros/variables/get_metric_allowlist.sql
[0m18:07:12.388127 [debug] [MainThread]: Parsing macros/variables/get_base_metrics.sql
[0m18:07:12.389337 [debug] [MainThread]: Parsing macros/sql_gen/gen_final_cte.sql
[0m18:07:12.392673 [debug] [MainThread]: Parsing macros/sql_gen/build_metric_sql.sql
[0m18:07:12.394237 [debug] [MainThread]: Parsing macros/sql_gen/gen_dimensions_cte.sql
[0m18:07:12.394933 [debug] [MainThread]: Parsing macros/sql_gen/gen_filters.sql
[0m18:07:12.396457 [debug] [MainThread]: Parsing macros/sql_gen/gen_order_by.sql
[0m18:07:12.397686 [debug] [MainThread]: Parsing macros/sql_gen/gen_spine_time_cte.sql
[0m18:07:12.399392 [debug] [MainThread]: Parsing macros/sql_gen/gen_secondary_calculations_cte.sql
[0m18:07:12.401485 [debug] [MainThread]: Parsing macros/sql_gen/gen_calendar_cte.sql
[0m18:07:12.402517 [debug] [MainThread]: Parsing macros/sql_gen/gen_metric_cte.sql
[0m18:07:12.407343 [debug] [MainThread]: Parsing macros/sql_gen/gen_group_by.sql
[0m18:07:12.408997 [debug] [MainThread]: Parsing macros/sql_gen/gen_base_query.sql
[0m18:07:12.411329 [debug] [MainThread]: Parsing macros/sql_gen/gen_calendar_table_join.sql
[0m18:07:12.414844 [debug] [MainThread]: Parsing macros/sql_gen/gen_aggregate_cte.sql
[0m18:07:12.417519 [debug] [MainThread]: Parsing macros/sql_gen/gen_primary_metric_aggregate.sql
[0m18:07:12.421253 [debug] [MainThread]: Parsing macros/sql_gen/gen_joined_metrics_cte.sql
[0m18:07:12.433146 [debug] [MainThread]: Parsing macros/secondary_calculations_configuration/period_over_period.sql
[0m18:07:12.434525 [debug] [MainThread]: Parsing macros/secondary_calculations_configuration/prior.sql
[0m18:07:12.435555 [debug] [MainThread]: Parsing macros/secondary_calculations_configuration/period_to_date.sql
[0m18:07:12.436804 [debug] [MainThread]: Parsing macros/secondary_calculations_configuration/rolling.sql
[0m18:07:12.437888 [debug] [MainThread]: Parsing macros/validation/is_valid_dimension.sql
[0m18:07:12.438310 [debug] [MainThread]: Parsing macros/validation/validate_aggregate_coherence.sql
[0m18:07:12.438844 [debug] [MainThread]: Parsing macros/validation/validate_develop_grain.sql
[0m18:07:12.439599 [debug] [MainThread]: Parsing macros/validation/validate_derived_metrics.sql
[0m18:07:12.440359 [debug] [MainThread]: Parsing macros/validation/validate_grain_order.sql
[0m18:07:12.441472 [debug] [MainThread]: Parsing macros/validation/validate_dimension_list.sql
[0m18:07:12.442661 [debug] [MainThread]: Parsing macros/validation/validate_metric_config.sql
[0m18:07:12.444105 [debug] [MainThread]: Parsing macros/validation/validate_grain.sql
[0m18:07:12.445767 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m18:07:12.446708 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m18:07:12.447976 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m18:07:12.448760 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m18:07:12.450990 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m18:07:12.453103 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m18:07:12.454180 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m18:07:12.455857 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m18:07:12.456849 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m18:07:12.457981 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m18:07:12.458954 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m18:07:12.460017 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m18:07:12.461320 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m18:07:12.462270 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m18:07:12.463095 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m18:07:12.464586 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m18:07:12.466400 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m18:07:12.468114 [debug] [MainThread]: Parsing macros/generic_tests/not_empty_string.sql
[0m18:07:12.469035 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m18:07:12.474108 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m18:07:12.474627 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_relation.sql
[0m18:07:12.475157 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m18:07:12.475711 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m18:07:12.476215 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m18:07:12.476902 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_ephemeral.sql
[0m18:07:12.477966 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m18:07:12.480076 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m18:07:12.480826 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m18:07:12.482740 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m18:07:12.484878 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m18:07:12.486740 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m18:07:12.487841 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m18:07:12.490624 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m18:07:12.493741 [debug] [MainThread]: Parsing macros/sql/safe_divide.sql
[0m18:07:12.494264 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m18:07:12.500874 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m18:07:12.501666 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m18:07:12.503665 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m18:07:12.504523 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m18:07:12.505602 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m18:07:12.506384 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m18:07:12.509830 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m18:07:12.512693 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m18:07:12.514706 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m18:07:12.516049 [debug] [MainThread]: Parsing macros/sql/width_bucket.sql
[0m18:07:12.518588 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m18:07:12.519632 [debug] [MainThread]: Parsing macros/sql/generate_surrogate_key.sql
[0m18:07:12.520810 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m18:07:12.521536 [debug] [MainThread]: Parsing macros/sql/get_single_value.sql
[0m18:07:12.522972 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m18:07:12.812608 [debug] [MainThread]: 1603: static parser failed on stating/stg_referrals.sql
[0m18:07:12.822151 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stating/stg_referrals.sql
[0m18:07:12.823373 [debug] [MainThread]: 1603: static parser failed on stating/stg_partners.sql
[0m18:07:12.827135 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stating/stg_partners.sql
[0m18:07:12.829279 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_referrals.sql
[0m18:07:12.884996 [debug] [MainThread]: 1603: static parser failed on dbt_metrics_default_calendar.sql
[0m18:07:12.903687 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dbt_metrics_default_calendar.sql
[0m18:07:12.971879 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ggchallengejoao.example

[0m18:07:12.975481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9debc2b6-b859-4338-a1c6-3bdab9ca1e54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aaef0d0>]}
[0m18:07:12.983232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9debc2b6-b859-4338-a1c6-3bdab9ca1e54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aa1c910>]}
[0m18:07:12.983456 [info ] [MainThread]: Found 4 models, 6 tests, 0 snapshots, 0 analyses, 533 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 2 metrics
[0m18:07:12.983606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9debc2b6-b859-4338-a1c6-3bdab9ca1e54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a9798e0>]}
[0m18:07:12.984419 [info ] [MainThread]: 
[0m18:07:12.984810 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m18:07:12.985418 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801_getgroundjoao"
[0m18:07:12.985535 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:07:15.826442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9debc2b6-b859-4338-a1c6-3bdab9ca1e54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a6f7370>]}
[0m18:07:15.828823 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:07:15.829457 [info ] [MainThread]: 
[0m18:07:15.839482 [debug] [Thread-1  ]: Began running node model.metrics.dbt_metrics_default_calendar
[0m18:07:15.839789 [debug] [Thread-2  ]: Began running node seed.ggchallengejoao.partners
[0m18:07:15.839986 [debug] [Thread-3  ]: Began running node seed.ggchallengejoao.referrals
[0m18:07:15.840188 [debug] [Thread-4  ]: Began running node seed.ggchallengejoao.sales_people
[0m18:07:15.841179 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.metrics.dbt_metrics_default_calendar"
[0m18:07:15.841937 [debug] [Thread-2  ]: Acquiring new bigquery connection "seed.ggchallengejoao.partners"
[0m18:07:15.842718 [debug] [Thread-3  ]: Acquiring new bigquery connection "seed.ggchallengejoao.referrals"
[0m18:07:15.843846 [debug] [Thread-4  ]: Acquiring new bigquery connection "seed.ggchallengejoao.sales_people"
[0m18:07:15.844166 [debug] [Thread-1  ]: Began compiling node model.metrics.dbt_metrics_default_calendar
[0m18:07:15.844324 [debug] [Thread-2  ]: Began compiling node seed.ggchallengejoao.partners
[0m18:07:15.844454 [debug] [Thread-3  ]: Began compiling node seed.ggchallengejoao.referrals
[0m18:07:15.844577 [debug] [Thread-4  ]: Began compiling node seed.ggchallengejoao.sales_people
[0m18:07:15.844913 [debug] [Thread-1  ]: Compiling model.metrics.dbt_metrics_default_calendar
[0m18:07:15.845122 [debug] [Thread-2  ]: Compiling seed.ggchallengejoao.partners
[0m18:07:15.845257 [debug] [Thread-3  ]: Compiling seed.ggchallengejoao.referrals
[0m18:07:15.845383 [debug] [Thread-4  ]: Compiling seed.ggchallengejoao.sales_people
[0m18:07:15.860765 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:07:15.877333 [debug] [Thread-3  ]: Writing injected SQL for node "seed.ggchallengejoao.referrals"
[0m18:07:15.879165 [debug] [Thread-4  ]: Writing injected SQL for node "seed.ggchallengejoao.sales_people"
[0m18:07:15.881289 [debug] [Thread-2  ]: Writing injected SQL for node "seed.ggchallengejoao.partners"
[0m18:07:15.881555 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */


        select 

    datetime_diff(
        cast(cast('2030-01-01' as date) as datetime),
        cast(cast('1990-01-01' as date) as datetime),
        day
    )

  
[0m18:07:15.881712 [debug] [Thread-3  ]: finished collecting timing info
[0m18:07:15.881827 [debug] [Thread-4  ]: finished collecting timing info
[0m18:07:15.881947 [debug] [Thread-2  ]: finished collecting timing info
[0m18:07:15.882685 [debug] [Thread-3  ]: Began executing node seed.ggchallengejoao.referrals
[0m18:07:15.883311 [debug] [Thread-4  ]: Began executing node seed.ggchallengejoao.sales_people
[0m18:07:15.883418 [debug] [Thread-2  ]: Began executing node seed.ggchallengejoao.partners
[0m18:07:15.883582 [debug] [Thread-3  ]: finished collecting timing info
[0m18:07:15.883679 [debug] [Thread-4  ]: finished collecting timing info
[0m18:07:15.883761 [debug] [Thread-2  ]: finished collecting timing info
[0m18:07:15.884173 [debug] [Thread-3  ]: Finished running node seed.ggchallengejoao.referrals
[0m18:07:15.884476 [debug] [Thread-4  ]: Finished running node seed.ggchallengejoao.sales_people
[0m18:07:15.884912 [debug] [Thread-2  ]: Finished running node seed.ggchallengejoao.partners
[0m18:07:15.886577 [debug] [Thread-3  ]: Began running node model.ggchallengejoao.stg_referrals
[0m18:07:15.887208 [debug] [Thread-2  ]: Began running node model.ggchallengejoao.stg_partners
[0m18:07:15.887748 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_referrals"
[0m18:07:15.888198 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_partners"
[0m18:07:15.888372 [debug] [Thread-3  ]: Began compiling node model.ggchallengejoao.stg_referrals
[0m18:07:15.888551 [debug] [Thread-2  ]: Began compiling node model.ggchallengejoao.stg_partners
[0m18:07:15.888689 [debug] [Thread-3  ]: Compiling model.ggchallengejoao.stg_referrals
[0m18:07:15.888805 [debug] [Thread-2  ]: Compiling model.ggchallengejoao.stg_partners
[0m18:07:15.892514 [debug] [Thread-3  ]: Writing injected SQL for node "model.ggchallengejoao.stg_referrals"
[0m18:07:15.896912 [debug] [Thread-2  ]: Writing injected SQL for node "model.ggchallengejoao.stg_partners"
[0m18:07:15.898249 [debug] [Thread-2  ]: finished collecting timing info
[0m18:07:15.898386 [debug] [Thread-3  ]: finished collecting timing info
[0m18:07:15.898576 [debug] [Thread-2  ]: Began executing node model.ggchallengejoao.stg_partners
[0m18:07:15.898722 [debug] [Thread-3  ]: Began executing node model.ggchallengejoao.stg_referrals
[0m18:07:15.898882 [debug] [Thread-2  ]: finished collecting timing info
[0m18:07:15.899120 [debug] [Thread-3  ]: finished collecting timing info
[0m18:07:15.899736 [debug] [Thread-2  ]: Finished running node model.ggchallengejoao.stg_partners
[0m18:07:15.900248 [debug] [Thread-3  ]: Finished running node model.ggchallengejoao.stg_referrals
[0m18:07:15.900592 [debug] [Thread-4  ]: Began running node test.ggchallengejoao.not_null_stg_partners_id.625c7b2674
[0m18:07:15.900727 [debug] [Thread-2  ]: Began running node test.ggchallengejoao.unique_stg_partners_id.8b2ef7f041
[0m18:07:15.901013 [debug] [Thread-3  ]: Began running node model.ggchallengejoao.mart_referrals
[0m18:07:15.901353 [debug] [Thread-4  ]: Acquiring new bigquery connection "test.ggchallengejoao.not_null_stg_partners_id.625c7b2674"
[0m18:07:15.901717 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.ggchallengejoao.unique_stg_partners_id.8b2ef7f041"
[0m18:07:15.902120 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.ggchallengejoao.mart_referrals"
[0m18:07:15.902254 [debug] [Thread-4  ]: Began compiling node test.ggchallengejoao.not_null_stg_partners_id.625c7b2674
[0m18:07:15.902385 [debug] [Thread-2  ]: Began compiling node test.ggchallengejoao.unique_stg_partners_id.8b2ef7f041
[0m18:07:15.902505 [debug] [Thread-3  ]: Began compiling node model.ggchallengejoao.mart_referrals
[0m18:07:15.902631 [debug] [Thread-4  ]: Compiling test.ggchallengejoao.not_null_stg_partners_id.625c7b2674
[0m18:07:15.902746 [debug] [Thread-2  ]: Compiling test.ggchallengejoao.unique_stg_partners_id.8b2ef7f041
[0m18:07:15.902862 [debug] [Thread-3  ]: Compiling model.ggchallengejoao.mart_referrals
[0m18:07:15.911318 [debug] [Thread-4  ]: Writing injected SQL for node "test.ggchallengejoao.not_null_stg_partners_id.625c7b2674"
[0m18:07:15.916858 [debug] [Thread-2  ]: Writing injected SQL for node "test.ggchallengejoao.unique_stg_partners_id.8b2ef7f041"
[0m18:07:15.919787 [debug] [Thread-3  ]: Writing injected SQL for node "model.ggchallengejoao.mart_referrals"
[0m18:07:15.920503 [debug] [Thread-4  ]: finished collecting timing info
[0m18:07:15.920588 [debug] [Thread-2  ]: finished collecting timing info
[0m18:07:15.920718 [debug] [Thread-4  ]: Began executing node test.ggchallengejoao.not_null_stg_partners_id.625c7b2674
[0m18:07:15.920816 [debug] [Thread-2  ]: Began executing node test.ggchallengejoao.unique_stg_partners_id.8b2ef7f041
[0m18:07:15.920911 [debug] [Thread-3  ]: finished collecting timing info
[0m18:07:15.921007 [debug] [Thread-4  ]: finished collecting timing info
[0m18:07:15.921111 [debug] [Thread-2  ]: finished collecting timing info
[0m18:07:15.921201 [debug] [Thread-3  ]: Began executing node model.ggchallengejoao.mart_referrals
[0m18:07:15.921603 [debug] [Thread-4  ]: Finished running node test.ggchallengejoao.not_null_stg_partners_id.625c7b2674
[0m18:07:15.922069 [debug] [Thread-2  ]: Finished running node test.ggchallengejoao.unique_stg_partners_id.8b2ef7f041
[0m18:07:15.922180 [debug] [Thread-3  ]: finished collecting timing info
[0m18:07:15.922336 [debug] [Thread-4  ]: Began running node test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f
[0m18:07:15.922525 [debug] [Thread-2  ]: Began running node test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53
[0m18:07:15.922954 [debug] [Thread-3  ]: Finished running node model.ggchallengejoao.mart_referrals
[0m18:07:15.923252 [debug] [Thread-4  ]: Acquiring new bigquery connection "test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f"
[0m18:07:15.923531 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53"
[0m18:07:15.923662 [debug] [Thread-3  ]: Began running node test.ggchallengejoao.not_null_stg_referrals_id.f511791502
[0m18:07:15.923845 [debug] [Thread-4  ]: Began compiling node test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f
[0m18:07:15.923951 [debug] [Thread-2  ]: Began compiling node test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53
[0m18:07:15.924304 [debug] [Thread-3  ]: Acquiring new bigquery connection "test.ggchallengejoao.not_null_stg_referrals_id.f511791502"
[0m18:07:15.924414 [debug] [Thread-4  ]: Compiling test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f
[0m18:07:15.924509 [debug] [Thread-2  ]: Compiling test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53
[0m18:07:15.924599 [debug] [Thread-3  ]: Began compiling node test.ggchallengejoao.not_null_stg_referrals_id.f511791502
[0m18:07:15.927510 [debug] [Thread-4  ]: Writing injected SQL for node "test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f"
[0m18:07:15.931699 [debug] [Thread-2  ]: Writing injected SQL for node "test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53"
[0m18:07:15.932035 [debug] [Thread-3  ]: Compiling test.ggchallengejoao.not_null_stg_referrals_id.f511791502
[0m18:07:15.934943 [debug] [Thread-3  ]: Writing injected SQL for node "test.ggchallengejoao.not_null_stg_referrals_id.f511791502"
[0m18:07:15.935356 [debug] [Thread-2  ]: finished collecting timing info
[0m18:07:15.935504 [debug] [Thread-4  ]: finished collecting timing info
[0m18:07:15.935608 [debug] [Thread-2  ]: Began executing node test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53
[0m18:07:15.935777 [debug] [Thread-4  ]: Began executing node test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f
[0m18:07:15.935883 [debug] [Thread-2  ]: finished collecting timing info
[0m18:07:15.935989 [debug] [Thread-4  ]: finished collecting timing info
[0m18:07:15.936046 [debug] [Thread-3  ]: finished collecting timing info
[0m18:07:15.936383 [debug] [Thread-2  ]: Finished running node test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53
[0m18:07:15.936673 [debug] [Thread-4  ]: Finished running node test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f
[0m18:07:15.936760 [debug] [Thread-3  ]: Began executing node test.ggchallengejoao.not_null_stg_referrals_id.f511791502
[0m18:07:15.936861 [debug] [Thread-2  ]: Began running node test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f
[0m18:07:15.937026 [debug] [Thread-3  ]: finished collecting timing info
[0m18:07:15.937273 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f"
[0m18:07:15.937540 [debug] [Thread-3  ]: Finished running node test.ggchallengejoao.not_null_stg_referrals_id.f511791502
[0m18:07:15.937621 [debug] [Thread-2  ]: Began compiling node test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f
[0m18:07:15.937743 [debug] [Thread-2  ]: Compiling test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f
[0m18:07:15.940459 [debug] [Thread-2  ]: Writing injected SQL for node "test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f"
[0m18:07:15.940805 [debug] [Thread-2  ]: finished collecting timing info
[0m18:07:15.940895 [debug] [Thread-2  ]: Began executing node test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f
[0m18:07:15.940972 [debug] [Thread-2  ]: finished collecting timing info
[0m18:07:15.941253 [debug] [Thread-2  ]: Finished running node test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f
[0m18:07:17.717355 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:db801e3d-7ec3-4431-9156-4460d33cecad:EU&page=queryresults
[0m18:07:17.732457 [debug] [Thread-1  ]: Writing injected SQL for node "model.metrics.dbt_metrics_default_calendar"
[0m18:07:17.735431 [debug] [Thread-1  ]: finished collecting timing info
[0m18:07:17.736524 [debug] [Thread-1  ]: Began executing node model.metrics.dbt_metrics_default_calendar
[0m18:07:17.738243 [debug] [Thread-1  ]: finished collecting timing info
[0m18:07:17.741017 [debug] [Thread-1  ]: Finished running node model.metrics.dbt_metrics_default_calendar
[0m18:07:17.746404 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:07:17.747026 [debug] [MainThread]: Connection 'model.metrics.dbt_metrics_default_calendar' was properly closed.
[0m18:07:17.747259 [debug] [MainThread]: Connection 'test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f' was properly closed.
[0m18:07:17.747647 [debug] [MainThread]: Connection 'test.ggchallengejoao.not_null_stg_referrals_id.f511791502' was properly closed.
[0m18:07:17.748083 [debug] [MainThread]: Connection 'test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f' was properly closed.
[0m18:07:17.767076 [info ] [MainThread]: Done.
[0m18:07:17.771812 [debug] [MainThread]: Acquiring new bigquery connection "generate_catalog"
[0m18:07:17.772087 [info ] [MainThread]: Building catalog
[0m18:07:17.773212 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:07:18.244097 [debug] [ThreadPool]: Acquiring new bigquery connection "dynamic-point-367801.information_schema"
[0m18:07:18.266377 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:07:18.266809 [debug] [ThreadPool]: On dynamic-point-367801.information_schema: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "connection_name": "dynamic-point-367801.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `dynamic-point-367801`.`getgroundjoao`.__TABLES__
        where (upper(dataset_id) = upper('getgroundjoao'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `dynamic-point-367801`.`getgroundjoao`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `dynamic-point-367801`.`getgroundjoao`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m18:07:21.239585 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:692e6384-fa85-4303-9b8d-1ea5693840c2:EU&page=queryresults
[0m18:07:21.302312 [info ] [MainThread]: Catalog written to /Users/joaopaulomedeiroscecilio/dev/ggchallenge/ggchallengejoao/target/catalog.json
[0m18:07:21.303549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aa77040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ac061f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ac06dc0>]}
[0m18:07:21.304279 [debug] [MainThread]: Flushing usage events
[0m18:07:22.145940 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m18:07:22.146473 [debug] [MainThread]: Connection 'dynamic-point-367801.information_schema' was properly closed.


============================== 2023-01-06 18:08:20.124470 | ddbae744-d81d-41d3-9051-dba40c4ce48d ==============================
[0m18:08:20.124487 [info ] [MainThread]: Running with dbt=1.3.2
[0m18:08:20.125138 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joaopaulomedeiroscecilio/dev/ggchallenge/ggchallengejoao', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:08:20.125244 [debug] [MainThread]: Tracking: tracking
[0m18:08:20.136058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c73ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c73c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c73be0>]}
[0m18:08:20.221088 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:08:20.221300 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:08:20.221633 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ggchallengejoao.example

[0m18:08:20.225460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ddbae744-d81d-41d3-9051-dba40c4ce48d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f090d0>]}
[0m18:08:20.233414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ddbae744-d81d-41d3-9051-dba40c4ce48d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112dd8250>]}
[0m18:08:20.233666 [info ] [MainThread]: Found 4 models, 6 tests, 0 snapshots, 0 analyses, 533 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 2 metrics
[0m18:08:20.233819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ddbae744-d81d-41d3-9051-dba40c4ce48d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112dd80d0>]}
[0m18:08:20.234639 [info ] [MainThread]: 
[0m18:08:20.234998 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m18:08:20.235570 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801"
[0m18:08:20.235711 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:21.750759 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801_getgroundjoao"
[0m18:08:21.751481 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:08:22.169874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ddbae744-d81d-41d3-9051-dba40c4ce48d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102c9100>]}
[0m18:08:22.171594 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:08:22.172269 [info ] [MainThread]: 
[0m18:08:22.182501 [debug] [Thread-1  ]: Began running node model.ggchallengejoao.stg_partners
[0m18:08:22.182840 [debug] [Thread-2  ]: Began running node model.ggchallengejoao.stg_referrals
[0m18:08:22.183083 [debug] [Thread-3  ]: Began running node model.metrics.dbt_metrics_default_calendar
[0m18:08:22.183775 [info ] [Thread-1  ]: 1 of 4 START sql view model getgroundjoao.stg_partners ......................... [RUN]
[0m18:08:22.184362 [info ] [Thread-2  ]: 2 of 4 START sql view model getgroundjoao.stg_referrals ........................ [RUN]
[0m18:08:22.184794 [info ] [Thread-3  ]: 3 of 4 START sql table model getgroundjoao.dbt_metrics_default_calendar ........ [RUN]
[0m18:08:22.186184 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_partners"
[0m18:08:22.187819 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_referrals"
[0m18:08:22.189138 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.metrics.dbt_metrics_default_calendar"
[0m18:08:22.189581 [debug] [Thread-1  ]: Began compiling node model.ggchallengejoao.stg_partners
[0m18:08:22.189881 [debug] [Thread-2  ]: Began compiling node model.ggchallengejoao.stg_referrals
[0m18:08:22.190628 [debug] [Thread-3  ]: Began compiling node model.metrics.dbt_metrics_default_calendar
[0m18:08:22.191272 [debug] [Thread-1  ]: Compiling model.ggchallengejoao.stg_partners
[0m18:08:22.191697 [debug] [Thread-2  ]: Compiling model.ggchallengejoao.stg_referrals
[0m18:08:22.192002 [debug] [Thread-3  ]: Compiling model.metrics.dbt_metrics_default_calendar
[0m18:08:22.202365 [debug] [Thread-1  ]: Writing injected SQL for node "model.ggchallengejoao.stg_partners"
[0m18:08:22.231634 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:08:22.232291 [debug] [Thread-3  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */


        select 

    datetime_diff(
        cast(cast('2030-01-01' as date) as datetime),
        cast(cast('1990-01-01' as date) as datetime),
        day
    )

  
[0m18:08:22.236170 [debug] [Thread-2  ]: Writing injected SQL for node "model.ggchallengejoao.stg_referrals"
[0m18:08:22.236933 [debug] [Thread-1  ]: finished collecting timing info
[0m18:08:22.237468 [debug] [Thread-1  ]: Began executing node model.ggchallengejoao.stg_partners
[0m18:08:22.244287 [debug] [Thread-2  ]: finished collecting timing info
[0m18:08:22.256106 [debug] [Thread-1  ]: Writing runtime sql for node "model.ggchallengejoao.stg_partners"
[0m18:08:22.256485 [debug] [Thread-2  ]: Began executing node model.ggchallengejoao.stg_referrals
[0m18:08:22.258784 [debug] [Thread-2  ]: Writing runtime sql for node "model.ggchallengejoao.stg_referrals"
[0m18:08:22.259002 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:08:22.259170 [debug] [Thread-1  ]: On model.ggchallengejoao.stg_partners: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.stg_partners"} */


  create or replace view `dynamic-point-367801`.`getgroundjoao`.`stg_partners`
  OPTIONS()
  as 

select *
except
    (lead_sales_contact, created_at, updated_at),
    if(
        lead_sales_contact = '0', 'No contact', lead_sales_contact
    ) as lead_sales_contact,
    
timestamp_micros(cast(created_at/ 1000 as int64))
 as partner_created_at_timestamp,
    
timestamp_micros(cast(updated_at/ 1000 as int64))
 as partner_updated_at_timestamp
from `dynamic-point-367801`.`getgroundjoao`.`partners`;


[0m18:08:22.260063 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m18:08:22.260182 [debug] [Thread-2  ]: On model.ggchallengejoao.stg_referrals: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.stg_referrals"} */


  create or replace view `dynamic-point-367801`.`getgroundjoao`.`stg_referrals`
  OPTIONS()
  as 

select *
except
    (created_at, updated_at),
    
timestamp_micros(cast(created_at/ 1000 as int64))
 as referral_created_at_timestamp,
    
timestamp_micros(cast(updated_at/ 1000 as int64))
 as referral_updated_at_timestamp
from `dynamic-point-367801`.`getgroundjoao`.`referrals`;


[0m18:08:23.369685 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:3ba09de6-eb07-41ca-88c7-d53f82e31d50:EU&page=queryresults
[0m18:08:23.399694 [debug] [Thread-2  ]: finished collecting timing info
[0m18:08:23.400818 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddbae744-d81d-41d3-9051-dba40c4ce48d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fc4d60>]}
[0m18:08:23.401400 [info ] [Thread-2  ]: 2 of 4 OK created sql view model getgroundjoao.stg_referrals ................... [[32mCREATE VIEW (0 processed)[0m in 1.21s]
[0m18:08:23.402049 [debug] [Thread-2  ]: Finished running node model.ggchallengejoao.stg_referrals
[0m18:08:23.402539 [debug] [Thread-4  ]: Began running node model.ggchallengejoao.mart_referrals
[0m18:08:23.402970 [info ] [Thread-4  ]: 4 of 4 START sql table model getgroundjoao.mart_referrals ...................... [RUN]
[0m18:08:23.403763 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.ggchallengejoao.mart_referrals"
[0m18:08:23.403954 [debug] [Thread-4  ]: Began compiling node model.ggchallengejoao.mart_referrals
[0m18:08:23.404127 [debug] [Thread-4  ]: Compiling model.ggchallengejoao.mart_referrals
[0m18:08:23.409394 [debug] [Thread-4  ]: Writing injected SQL for node "model.ggchallengejoao.mart_referrals"
[0m18:08:23.410592 [debug] [Thread-4  ]: finished collecting timing info
[0m18:08:23.410796 [debug] [Thread-4  ]: Began executing node model.ggchallengejoao.mart_referrals
[0m18:08:23.424900 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m18:08:23.621313 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:cda0aef1-8eea-48fa-8d21-e1f634a400c3:EU&page=queryresults
[0m18:08:23.623664 [debug] [Thread-1  ]: finished collecting timing info
[0m18:08:23.624571 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddbae744-d81d-41d3-9051-dba40c4ce48d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11385ee50>]}
[0m18:08:23.625167 [info ] [Thread-1  ]: 1 of 4 OK created sql view model getgroundjoao.stg_partners .................... [[32mCREATE VIEW (0 processed)[0m in 1.44s]
[0m18:08:23.625908 [debug] [Thread-1  ]: Finished running node model.ggchallengejoao.stg_partners
[0m18:08:23.998054 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:1334b815-8a9c-48ad-a75c-679882d9b4bc:EU&page=queryresults
[0m18:08:24.029657 [debug] [Thread-3  ]: Writing injected SQL for node "model.metrics.dbt_metrics_default_calendar"
[0m18:08:24.030581 [debug] [Thread-3  ]: finished collecting timing info
[0m18:08:24.030854 [debug] [Thread-3  ]: Began executing node model.metrics.dbt_metrics_default_calendar
[0m18:08:24.112159 [debug] [Thread-4  ]: Writing runtime sql for node "model.ggchallengejoao.mart_referrals"
[0m18:08:24.113063 [debug] [Thread-4  ]: On model.ggchallengejoao.mart_referrals: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.mart_referrals"} */

  
    

    create or replace table `dynamic-point-367801`.`getgroundjoao`.`mart_referrals`
    
    
    OPTIONS()
    as (
      

select
    r.company_id as referral_company,
    r.partner_id as referral_partner,
    r.status as referral_status,
    r.is_outbound as referral_outbound,
    r.referral_created_at_timestamp as referral_record_date,
    r.referral_updated_at_timestamp as referral_updated,
    timestamp_diff(
        referral_updated_at_timestamp, referral_created_at_timestamp, day
    ) as referral_days_from_creation,
    p.partner_type as referral_partner_type,
    p.lead_sales_contact as referral_lead_sales_contact,
    coalesce(d.country, 'No country') as referral_country
from `dynamic-point-367801`.`getgroundjoao`.`stg_referrals` r
left join `dynamic-point-367801`.`getgroundjoao`.`partners` p on r.partner_id = p.id
left join `dynamic-point-367801`.`getgroundjoao`.`sales_people` d on p.lead_sales_contact = d.name
    );
  
[0m18:08:24.379325 [debug] [Thread-3  ]: Writing runtime sql for node "model.metrics.dbt_metrics_default_calendar"
[0m18:08:24.380929 [debug] [Thread-3  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */

  
    

    create or replace table `dynamic-point-367801`.`getgroundjoao`.`dbt_metrics_default_calendar`
    
    
    OPTIONS()
    as (
      

with days as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
     + 
    
    p11.generated_number * power(2, 11)
     + 
    
    p12.generated_number * power(2, 12)
     + 
    
    p13.generated_number * power(2, 13)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
     cross join 
    
    p as p11
     cross join 
    
    p as p12
     cross join 
    
    p as p13
    
    

    )

    select *
    from unioned
    where generated_number <= 14610
    order by generated_number



),

all_periods as (

    select (
        

        datetime_add(
            cast( cast('1990-01-01' as date) as datetime),
        interval row_number() over (order by 1) - 1 day
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2030-01-01' as date)

)

select * from filtered


),

final as (
    select 
        cast(date_day as date) as date_day,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        week
    ) as date) as date_week,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        month
    ) as date) as date_month,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        quarter
    ) as date) as date_quarter,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        year
    ) as date) as date_year
    from days
)

select * from final
    );
  
[0m18:08:26.782961 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:9354d4e5-4cc2-40fc-8499-c9d2c7b78a35:EU&page=queryresults
[0m18:08:26.788569 [debug] [Thread-4  ]: finished collecting timing info
[0m18:08:26.791016 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddbae744-d81d-41d3-9051-dba40c4ce48d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fc7100>]}
[0m18:08:26.792144 [info ] [Thread-4  ]: 4 of 4 OK created sql table model getgroundjoao.mart_referrals ................. [[32mCREATE TABLE (1.5k rows, 84.8 KB processed)[0m in 3.39s]
[0m18:08:26.793504 [debug] [Thread-4  ]: Finished running node model.ggchallengejoao.mart_referrals
[0m18:08:27.513618 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:2aec01b3-c4f3-409a-989e-618cc5372a99:EU&page=queryresults
[0m18:08:27.516752 [debug] [Thread-3  ]: finished collecting timing info
[0m18:08:27.518339 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddbae744-d81d-41d3-9051-dba40c4ce48d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11380ed00>]}
[0m18:08:27.519141 [info ] [Thread-3  ]: 3 of 4 OK created sql table model getgroundjoao.dbt_metrics_default_calendar ... [[32mCREATE TABLE (14.6k rows, 0 processed)[0m in 5.33s]
[0m18:08:27.520015 [debug] [Thread-3  ]: Finished running node model.metrics.dbt_metrics_default_calendar
[0m18:08:27.522968 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m18:08:27.524000 [info ] [MainThread]: 
[0m18:08:27.524437 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 7.29 seconds (7.29s).
[0m18:08:27.524804 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:08:27.525055 [debug] [MainThread]: Connection 'model.ggchallengejoao.stg_partners' was properly closed.
[0m18:08:27.525300 [debug] [MainThread]: Connection 'model.ggchallengejoao.stg_referrals' was properly closed.
[0m18:08:27.525528 [debug] [MainThread]: Connection 'model.metrics.dbt_metrics_default_calendar' was properly closed.
[0m18:08:27.525750 [debug] [MainThread]: Connection 'model.ggchallengejoao.mart_referrals' was properly closed.
[0m18:08:27.543309 [info ] [MainThread]: 
[0m18:08:27.543640 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:08:27.543886 [info ] [MainThread]: 
[0m18:08:27.544098 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m18:08:27.544431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c4eac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ecde50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113849520>]}
[0m18:08:27.544646 [debug] [MainThread]: Flushing usage events


============================== 2023-01-06 18:10:34.648971 | 5f354348-d625-47df-bb98-f93f0cd88e01 ==============================
[0m18:10:34.649010 [info ] [MainThread]: Running with dbt=1.3.2
[0m18:10:34.649751 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joaopaulomedeiroscecilio/dev/ggchallenge/ggchallengejoao', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m18:10:34.649859 [debug] [MainThread]: Tracking: tracking
[0m18:10:34.662492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123474a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123474c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123474bb0>]}
[0m18:10:34.737147 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:10:34.737304 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:10:34.737603 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ggchallengejoao.example

[0m18:10:34.741150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f354348-d625-47df-bb98-f93f0cd88e01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1248befd0>]}
[0m18:10:34.748737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f354348-d625-47df-bb98-f93f0cd88e01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1236dd220>]}
[0m18:10:34.748976 [info ] [MainThread]: Found 4 models, 6 tests, 0 snapshots, 0 analyses, 533 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 2 metrics
[0m18:10:34.749133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f354348-d625-47df-bb98-f93f0cd88e01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1236dd070>]}
[0m18:10:34.750042 [info ] [MainThread]: 
[0m18:10:34.750406 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m18:10:34.750989 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801_getgroundjoao"
[0m18:10:34.751134 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:36.046452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f354348-d625-47df-bb98-f93f0cd88e01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12348bb20>]}
[0m18:10:36.049193 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:10:36.050156 [info ] [MainThread]: 
[0m18:10:36.059898 [debug] [Thread-1  ]: Began running node model.metrics.dbt_metrics_default_calendar
[0m18:10:36.060056 [debug] [Thread-2  ]: Began running node seed.ggchallengejoao.partners
[0m18:10:36.060556 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.metrics.dbt_metrics_default_calendar"
[0m18:10:36.060646 [debug] [Thread-3  ]: Began running node seed.ggchallengejoao.referrals
[0m18:10:36.060738 [debug] [Thread-4  ]: Began running node seed.ggchallengejoao.sales_people
[0m18:10:36.061031 [debug] [Thread-2  ]: Acquiring new bigquery connection "seed.ggchallengejoao.partners"
[0m18:10:36.061161 [debug] [Thread-1  ]: Began compiling node model.metrics.dbt_metrics_default_calendar
[0m18:10:36.061433 [debug] [Thread-3  ]: Acquiring new bigquery connection "seed.ggchallengejoao.referrals"
[0m18:10:36.061694 [debug] [Thread-4  ]: Acquiring new bigquery connection "seed.ggchallengejoao.sales_people"
[0m18:10:36.061798 [debug] [Thread-2  ]: Began compiling node seed.ggchallengejoao.partners
[0m18:10:36.061984 [debug] [Thread-1  ]: Compiling model.metrics.dbt_metrics_default_calendar
[0m18:10:36.062069 [debug] [Thread-3  ]: Began compiling node seed.ggchallengejoao.referrals
[0m18:10:36.062155 [debug] [Thread-4  ]: Began compiling node seed.ggchallengejoao.sales_people
[0m18:10:36.062230 [debug] [Thread-2  ]: Compiling seed.ggchallengejoao.partners
[0m18:10:36.086713 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:10:36.086879 [debug] [Thread-3  ]: Compiling seed.ggchallengejoao.referrals
[0m18:10:36.087048 [debug] [Thread-4  ]: Compiling seed.ggchallengejoao.sales_people
[0m18:10:36.088502 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */


        select 

    datetime_diff(
        cast(cast('2030-01-01' as date) as datetime),
        cast(cast('1990-01-01' as date) as datetime),
        day
    )

  
[0m18:10:36.090755 [debug] [Thread-3  ]: Writing injected SQL for node "seed.ggchallengejoao.referrals"
[0m18:10:36.091803 [debug] [Thread-4  ]: Writing injected SQL for node "seed.ggchallengejoao.sales_people"
[0m18:10:36.093954 [debug] [Thread-2  ]: Writing injected SQL for node "seed.ggchallengejoao.partners"
[0m18:10:36.094362 [debug] [Thread-3  ]: finished collecting timing info
[0m18:10:36.094465 [debug] [Thread-4  ]: finished collecting timing info
[0m18:10:36.094579 [debug] [Thread-2  ]: finished collecting timing info
[0m18:10:36.094723 [debug] [Thread-3  ]: Began executing node seed.ggchallengejoao.referrals
[0m18:10:36.094814 [debug] [Thread-4  ]: Began executing node seed.ggchallengejoao.sales_people
[0m18:10:36.094895 [debug] [Thread-2  ]: Began executing node seed.ggchallengejoao.partners
[0m18:10:36.095003 [debug] [Thread-3  ]: finished collecting timing info
[0m18:10:36.095080 [debug] [Thread-4  ]: finished collecting timing info
[0m18:10:36.095236 [debug] [Thread-2  ]: finished collecting timing info
[0m18:10:36.095732 [debug] [Thread-3  ]: Finished running node seed.ggchallengejoao.referrals
[0m18:10:36.096174 [debug] [Thread-4  ]: Finished running node seed.ggchallengejoao.sales_people
[0m18:10:36.096474 [debug] [Thread-2  ]: Finished running node seed.ggchallengejoao.partners
[0m18:10:36.096750 [debug] [Thread-3  ]: Began running node model.ggchallengejoao.stg_referrals
[0m18:10:36.096925 [debug] [Thread-4  ]: Began running node model.ggchallengejoao.stg_partners
[0m18:10:36.097157 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_referrals"
[0m18:10:36.097388 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_partners"
[0m18:10:36.097466 [debug] [Thread-3  ]: Began compiling node model.ggchallengejoao.stg_referrals
[0m18:10:36.097539 [debug] [Thread-4  ]: Began compiling node model.ggchallengejoao.stg_partners
[0m18:10:36.097615 [debug] [Thread-3  ]: Compiling model.ggchallengejoao.stg_referrals
[0m18:10:36.097685 [debug] [Thread-4  ]: Compiling model.ggchallengejoao.stg_partners
[0m18:10:36.100317 [debug] [Thread-3  ]: Writing injected SQL for node "model.ggchallengejoao.stg_referrals"
[0m18:10:36.102253 [debug] [Thread-4  ]: Writing injected SQL for node "model.ggchallengejoao.stg_partners"
[0m18:10:36.103514 [debug] [Thread-3  ]: finished collecting timing info
[0m18:10:36.103604 [debug] [Thread-3  ]: Began executing node model.ggchallengejoao.stg_referrals
[0m18:10:36.103680 [debug] [Thread-3  ]: finished collecting timing info
[0m18:10:36.103975 [debug] [Thread-3  ]: Finished running node model.ggchallengejoao.stg_referrals
[0m18:10:36.104168 [debug] [Thread-4  ]: finished collecting timing info
[0m18:10:36.104257 [debug] [Thread-4  ]: Began executing node model.ggchallengejoao.stg_partners
[0m18:10:36.104325 [debug] [Thread-2  ]: Began running node model.ggchallengejoao.mart_referrals
[0m18:10:36.104401 [debug] [Thread-3  ]: Began running node test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f
[0m18:10:36.104489 [debug] [Thread-4  ]: finished collecting timing info
[0m18:10:36.104751 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.ggchallengejoao.mart_referrals"
[0m18:10:36.105007 [debug] [Thread-3  ]: Acquiring new bigquery connection "test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f"
[0m18:10:36.105288 [debug] [Thread-4  ]: Finished running node model.ggchallengejoao.stg_partners
[0m18:10:36.105366 [debug] [Thread-2  ]: Began compiling node model.ggchallengejoao.mart_referrals
[0m18:10:36.105438 [debug] [Thread-3  ]: Began compiling node test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f
[0m18:10:36.105533 [debug] [Thread-4  ]: Began running node test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53
[0m18:10:36.105690 [debug] [Thread-2  ]: Compiling model.ggchallengejoao.mart_referrals
[0m18:10:36.105770 [debug] [Thread-3  ]: Compiling test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f
[0m18:10:36.105996 [debug] [Thread-4  ]: Acquiring new bigquery connection "test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53"
[0m18:10:36.108154 [debug] [Thread-2  ]: Writing injected SQL for node "model.ggchallengejoao.mart_referrals"
[0m18:10:36.114274 [debug] [Thread-3  ]: Writing injected SQL for node "test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f"
[0m18:10:36.114442 [debug] [Thread-4  ]: Began compiling node test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53
[0m18:10:36.114636 [debug] [Thread-4  ]: Compiling test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53
[0m18:10:36.119082 [debug] [Thread-4  ]: Writing injected SQL for node "test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53"
[0m18:10:36.119639 [debug] [Thread-2  ]: finished collecting timing info
[0m18:10:36.119768 [debug] [Thread-3  ]: finished collecting timing info
[0m18:10:36.119881 [debug] [Thread-2  ]: Began executing node model.ggchallengejoao.mart_referrals
[0m18:10:36.119953 [debug] [Thread-4  ]: finished collecting timing info
[0m18:10:36.120040 [debug] [Thread-3  ]: Began executing node test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f
[0m18:10:36.120139 [debug] [Thread-2  ]: finished collecting timing info
[0m18:10:36.120233 [debug] [Thread-4  ]: Began executing node test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53
[0m18:10:36.120318 [debug] [Thread-3  ]: finished collecting timing info
[0m18:10:36.120729 [debug] [Thread-2  ]: Finished running node model.ggchallengejoao.mart_referrals
[0m18:10:36.120836 [debug] [Thread-4  ]: finished collecting timing info
[0m18:10:36.121123 [debug] [Thread-3  ]: Finished running node test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f
[0m18:10:36.121224 [debug] [Thread-2  ]: Began running node test.ggchallengejoao.not_null_stg_referrals_id.f511791502
[0m18:10:36.121515 [debug] [Thread-4  ]: Finished running node test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53
[0m18:10:36.121607 [debug] [Thread-3  ]: Began running node test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f
[0m18:10:36.121845 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.ggchallengejoao.not_null_stg_referrals_id.f511791502"
[0m18:10:36.121935 [debug] [Thread-4  ]: Began running node test.ggchallengejoao.not_null_stg_partners_id.625c7b2674
[0m18:10:36.122165 [debug] [Thread-3  ]: Acquiring new bigquery connection "test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f"
[0m18:10:36.122242 [debug] [Thread-2  ]: Began compiling node test.ggchallengejoao.not_null_stg_referrals_id.f511791502
[0m18:10:36.122455 [debug] [Thread-4  ]: Acquiring new bigquery connection "test.ggchallengejoao.not_null_stg_partners_id.625c7b2674"
[0m18:10:36.122530 [debug] [Thread-3  ]: Began compiling node test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f
[0m18:10:36.122609 [debug] [Thread-2  ]: Compiling test.ggchallengejoao.not_null_stg_referrals_id.f511791502
[0m18:10:36.122683 [debug] [Thread-4  ]: Began compiling node test.ggchallengejoao.not_null_stg_partners_id.625c7b2674
[0m18:10:36.122768 [debug] [Thread-3  ]: Compiling test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f
[0m18:10:36.128350 [debug] [Thread-2  ]: Writing injected SQL for node "test.ggchallengejoao.not_null_stg_referrals_id.f511791502"
[0m18:10:36.128548 [debug] [Thread-4  ]: Compiling test.ggchallengejoao.not_null_stg_partners_id.625c7b2674
[0m18:10:36.132371 [debug] [Thread-3  ]: Writing injected SQL for node "test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f"
[0m18:10:36.134852 [debug] [Thread-4  ]: Writing injected SQL for node "test.ggchallengejoao.not_null_stg_partners_id.625c7b2674"
[0m18:10:36.135027 [debug] [Thread-2  ]: finished collecting timing info
[0m18:10:36.135158 [debug] [Thread-2  ]: Began executing node test.ggchallengejoao.not_null_stg_referrals_id.f511791502
[0m18:10:36.135246 [debug] [Thread-2  ]: finished collecting timing info
[0m18:10:36.135305 [debug] [Thread-3  ]: finished collecting timing info
[0m18:10:36.135621 [debug] [Thread-2  ]: Finished running node test.ggchallengejoao.not_null_stg_referrals_id.f511791502
[0m18:10:36.135716 [debug] [Thread-3  ]: Began executing node test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f
[0m18:10:36.135818 [debug] [Thread-2  ]: Began running node test.ggchallengejoao.unique_stg_partners_id.8b2ef7f041
[0m18:10:36.135939 [debug] [Thread-3  ]: finished collecting timing info
[0m18:10:36.136177 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.ggchallengejoao.unique_stg_partners_id.8b2ef7f041"
[0m18:10:36.136465 [debug] [Thread-3  ]: Finished running node test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f
[0m18:10:36.136606 [debug] [Thread-2  ]: Began compiling node test.ggchallengejoao.unique_stg_partners_id.8b2ef7f041
[0m18:10:36.136670 [debug] [Thread-4  ]: finished collecting timing info
[0m18:10:36.136808 [debug] [Thread-2  ]: Compiling test.ggchallengejoao.unique_stg_partners_id.8b2ef7f041
[0m18:10:36.136896 [debug] [Thread-4  ]: Began executing node test.ggchallengejoao.not_null_stg_partners_id.625c7b2674
[0m18:10:36.139289 [debug] [Thread-2  ]: Writing injected SQL for node "test.ggchallengejoao.unique_stg_partners_id.8b2ef7f041"
[0m18:10:36.139421 [debug] [Thread-4  ]: finished collecting timing info
[0m18:10:36.139803 [debug] [Thread-4  ]: Finished running node test.ggchallengejoao.not_null_stg_partners_id.625c7b2674
[0m18:10:36.140160 [debug] [Thread-2  ]: finished collecting timing info
[0m18:10:36.140245 [debug] [Thread-2  ]: Began executing node test.ggchallengejoao.unique_stg_partners_id.8b2ef7f041
[0m18:10:36.140319 [debug] [Thread-2  ]: finished collecting timing info
[0m18:10:36.140593 [debug] [Thread-2  ]: Finished running node test.ggchallengejoao.unique_stg_partners_id.8b2ef7f041
[0m18:10:38.856088 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:d82d5976-42a9-4a7a-879a-f6716d82979b:EU&page=queryresults
[0m18:10:38.894259 [debug] [Thread-1  ]: Writing injected SQL for node "model.metrics.dbt_metrics_default_calendar"
[0m18:10:38.895403 [debug] [Thread-1  ]: finished collecting timing info
[0m18:10:38.895652 [debug] [Thread-1  ]: Began executing node model.metrics.dbt_metrics_default_calendar
[0m18:10:38.895843 [debug] [Thread-1  ]: finished collecting timing info
[0m18:10:38.896710 [debug] [Thread-1  ]: Finished running node model.metrics.dbt_metrics_default_calendar
[0m18:10:38.897887 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:10:38.898048 [debug] [MainThread]: Connection 'model.metrics.dbt_metrics_default_calendar' was properly closed.
[0m18:10:38.898147 [debug] [MainThread]: Connection 'test.ggchallengejoao.unique_stg_partners_id.8b2ef7f041' was properly closed.
[0m18:10:38.898232 [debug] [MainThread]: Connection 'test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f' was properly closed.
[0m18:10:38.898312 [debug] [MainThread]: Connection 'test.ggchallengejoao.not_null_stg_partners_id.625c7b2674' was properly closed.
[0m18:10:38.911919 [info ] [MainThread]: Done.
[0m18:10:38.912404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1249e1df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1249e1fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1249e1f70>]}
[0m18:10:38.912715 [debug] [MainThread]: Flushing usage events


============================== 2023-01-06 18:41:11.323850 | c22eb810-594c-4032-acd3-400f6d90a35c ==============================
[0m18:41:11.323888 [info ] [MainThread]: Running with dbt=1.3.2
[0m18:41:11.324513 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joaopaulomedeiroscecilio/dev/dbt-data-analysis', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:41:11.324621 [debug] [MainThread]: Tracking: tracking
[0m18:41:11.338306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cffdeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d0130d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d013070>]}
[0m18:41:11.374090 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:41:11.374523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c22eb810-594c-4032-acd3-400f6d90a35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d01d310>]}
[0m18:41:11.430109 [debug] [MainThread]: Parsing macros/unix_to_timestamp.sql
[0m18:41:11.430602 [debug] [MainThread]: Parsing macros/etc.sql
[0m18:41:11.431629 [debug] [MainThread]: Parsing macros/catalog.sql
[0m18:41:11.435032 [debug] [MainThread]: Parsing macros/adapters.sql
[0m18:41:11.445333 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m18:41:11.446524 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m18:41:11.447896 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m18:41:11.451574 [debug] [MainThread]: Parsing macros/materializations/copy.sql
[0m18:41:11.452862 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m18:41:11.461217 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m18:41:11.461987 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m18:41:11.462171 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m18:41:11.462478 [debug] [MainThread]: Parsing macros/utils/timestamps.sql
[0m18:41:11.462969 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m18:41:11.463148 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m18:41:11.463418 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m18:41:11.463721 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m18:41:11.464174 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m18:41:11.464743 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m18:41:11.464979 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m18:41:11.465221 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m18:41:11.465466 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m18:41:11.465704 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m18:41:11.465915 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m18:41:11.466595 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m18:41:11.466842 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m18:41:11.467225 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m18:41:11.467502 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m18:41:11.468677 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m18:41:11.470427 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m18:41:11.471475 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m18:41:11.472267 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m18:41:11.479933 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m18:41:11.486475 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m18:41:11.492507 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m18:41:11.494568 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m18:41:11.495388 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m18:41:11.496205 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m18:41:11.499898 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m18:41:11.507531 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m18:41:11.508241 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m18:41:11.511344 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m18:41:11.516294 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m18:41:11.524546 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m18:41:11.527209 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m18:41:11.528843 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m18:41:11.531389 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m18:41:11.531998 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m18:41:11.533564 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m18:41:11.534608 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m18:41:11.537873 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m18:41:11.546757 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m18:41:11.547432 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m18:41:11.548551 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m18:41:11.549256 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m18:41:11.549669 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m18:41:11.550044 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m18:41:11.550357 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m18:41:11.550974 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m18:41:11.553433 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m18:41:11.557395 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m18:41:11.557777 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m18:41:11.558348 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m18:41:11.558791 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m18:41:11.559225 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m18:41:11.559788 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m18:41:11.560161 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m18:41:11.560634 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m18:41:11.561193 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m18:41:11.562295 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m18:41:11.562872 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m18:41:11.563363 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m18:41:11.563843 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m18:41:11.564322 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m18:41:11.564746 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m18:41:11.565241 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m18:41:11.565654 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m18:41:11.568839 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m18:41:11.569384 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m18:41:11.569823 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m18:41:11.570651 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m18:41:11.571693 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m18:41:11.572174 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m18:41:11.572873 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m18:41:11.573363 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m18:41:11.574335 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m18:41:11.575870 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m18:41:11.577145 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m18:41:11.584363 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m18:41:11.585347 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m18:41:11.591869 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m18:41:11.593953 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m18:41:11.597306 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m18:41:11.602373 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m18:41:11.605382 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m18:41:11.606769 [debug] [MainThread]: Parsing macros/develop.sql
[0m18:41:11.612178 [debug] [MainThread]: Parsing macros/calculate.sql
[0m18:41:11.615484 [debug] [MainThread]: Parsing macros/get_metric_sql.sql
[0m18:41:11.617896 [debug] [MainThread]: Parsing macros/misc/metrics__date_spine.sql
[0m18:41:11.621882 [debug] [MainThread]: Parsing macros/misc/metrics__equality.sql
[0m18:41:11.625177 [debug] [MainThread]: Parsing macros/graph_parsing/get_metric_relation.sql
[0m18:41:11.625683 [debug] [MainThread]: Parsing macros/graph_parsing/get_model_relation.sql
[0m18:41:11.626755 [debug] [MainThread]: Parsing macros/secondary_calculations/secondary_calculation_rolling.sql
[0m18:41:11.627615 [debug] [MainThread]: Parsing macros/secondary_calculations/secondary_calculation_period_to_date.sql
[0m18:41:11.628307 [debug] [MainThread]: Parsing macros/secondary_calculations/secondary_calculation_period_over_period.sql
[0m18:41:11.630849 [debug] [MainThread]: Parsing macros/secondary_calculations/secondary_calculation_prior.sql
[0m18:41:11.631453 [debug] [MainThread]: Parsing macros/secondary_calculations/generate_secondary_calculation_alias.sql
[0m18:41:11.635620 [debug] [MainThread]: Parsing macros/secondary_calculations/perform_secondary_calculation.sql
[0m18:41:11.637442 [debug] [MainThread]: Parsing macros/variables/get_faux_metric_tree.sql
[0m18:41:11.639563 [debug] [MainThread]: Parsing macros/variables/get_metrics_dictionary.sql
[0m18:41:11.640755 [debug] [MainThread]: Parsing macros/variables/get_calendar_dimensions.sql
[0m18:41:11.641381 [debug] [MainThread]: Parsing macros/variables/get_non_calendar_dimension_list.sql
[0m18:41:11.641966 [debug] [MainThread]: Parsing macros/variables/update_metric_tree.sql
[0m18:41:11.644360 [debug] [MainThread]: Parsing macros/variables/get_metric_tree.sql
[0m18:41:11.647409 [debug] [MainThread]: Parsing macros/variables/update_faux_metric_tree.sql
[0m18:41:11.650241 [debug] [MainThread]: Parsing macros/variables/get_metric_model_name.sql
[0m18:41:11.650648 [debug] [MainThread]: Parsing macros/variables/get_grain_order.sql
[0m18:41:11.651164 [debug] [MainThread]: Parsing macros/variables/get_relevent_periods.sql
[0m18:41:11.651704 [debug] [MainThread]: Parsing macros/variables/get_develop_unique_metric_id_list.sql
[0m18:41:11.652462 [debug] [MainThread]: Parsing macros/variables/get_metric_list.sql
[0m18:41:11.653365 [debug] [MainThread]: Parsing macros/variables/get_metric_definition.sql
[0m18:41:11.655891 [debug] [MainThread]: Parsing macros/variables/get_metric_unique_id_list.sql
[0m18:41:11.656767 [debug] [MainThread]: Parsing macros/variables/get_metric_allowlist.sql
[0m18:41:11.657825 [debug] [MainThread]: Parsing macros/variables/get_base_metrics.sql
[0m18:41:11.659047 [debug] [MainThread]: Parsing macros/sql_gen/gen_final_cte.sql
[0m18:41:11.662434 [debug] [MainThread]: Parsing macros/sql_gen/build_metric_sql.sql
[0m18:41:11.663989 [debug] [MainThread]: Parsing macros/sql_gen/gen_dimensions_cte.sql
[0m18:41:11.664699 [debug] [MainThread]: Parsing macros/sql_gen/gen_filters.sql
[0m18:41:11.666141 [debug] [MainThread]: Parsing macros/sql_gen/gen_order_by.sql
[0m18:41:11.667282 [debug] [MainThread]: Parsing macros/sql_gen/gen_spine_time_cte.sql
[0m18:41:11.668892 [debug] [MainThread]: Parsing macros/sql_gen/gen_secondary_calculations_cte.sql
[0m18:41:11.670952 [debug] [MainThread]: Parsing macros/sql_gen/gen_calendar_cte.sql
[0m18:41:11.671938 [debug] [MainThread]: Parsing macros/sql_gen/gen_metric_cte.sql
[0m18:41:11.676785 [debug] [MainThread]: Parsing macros/sql_gen/gen_group_by.sql
[0m18:41:11.678399 [debug] [MainThread]: Parsing macros/sql_gen/gen_base_query.sql
[0m18:41:11.680594 [debug] [MainThread]: Parsing macros/sql_gen/gen_calendar_table_join.sql
[0m18:41:11.683773 [debug] [MainThread]: Parsing macros/sql_gen/gen_aggregate_cte.sql
[0m18:41:11.686113 [debug] [MainThread]: Parsing macros/sql_gen/gen_primary_metric_aggregate.sql
[0m18:41:11.689411 [debug] [MainThread]: Parsing macros/sql_gen/gen_joined_metrics_cte.sql
[0m18:41:11.700528 [debug] [MainThread]: Parsing macros/secondary_calculations_configuration/period_over_period.sql
[0m18:41:11.701812 [debug] [MainThread]: Parsing macros/secondary_calculations_configuration/prior.sql
[0m18:41:11.702842 [debug] [MainThread]: Parsing macros/secondary_calculations_configuration/period_to_date.sql
[0m18:41:11.704078 [debug] [MainThread]: Parsing macros/secondary_calculations_configuration/rolling.sql
[0m18:41:11.705143 [debug] [MainThread]: Parsing macros/validation/is_valid_dimension.sql
[0m18:41:11.705552 [debug] [MainThread]: Parsing macros/validation/validate_aggregate_coherence.sql
[0m18:41:11.706081 [debug] [MainThread]: Parsing macros/validation/validate_develop_grain.sql
[0m18:41:11.706821 [debug] [MainThread]: Parsing macros/validation/validate_derived_metrics.sql
[0m18:41:11.707595 [debug] [MainThread]: Parsing macros/validation/validate_grain_order.sql
[0m18:41:11.708744 [debug] [MainThread]: Parsing macros/validation/validate_dimension_list.sql
[0m18:41:11.709950 [debug] [MainThread]: Parsing macros/validation/validate_metric_config.sql
[0m18:41:11.711352 [debug] [MainThread]: Parsing macros/validation/validate_grain.sql
[0m18:41:11.712882 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m18:41:11.713782 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m18:41:11.715043 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m18:41:11.715756 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m18:41:11.717843 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m18:41:11.719834 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m18:41:11.720883 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m18:41:11.722504 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m18:41:11.723483 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m18:41:11.724616 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m18:41:11.725598 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m18:41:11.726647 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m18:41:11.727951 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m18:41:11.728919 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m18:41:11.729757 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m18:41:11.731247 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m18:41:11.733064 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m18:41:11.734732 [debug] [MainThread]: Parsing macros/generic_tests/not_empty_string.sql
[0m18:41:11.735592 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m18:41:11.740496 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m18:41:11.741003 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_relation.sql
[0m18:41:11.741533 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m18:41:11.742074 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m18:41:11.742576 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m18:41:11.743276 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_ephemeral.sql
[0m18:41:11.744173 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m18:41:11.746165 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m18:41:11.746912 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m18:41:11.748590 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m18:41:11.750643 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m18:41:11.752250 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m18:41:11.753006 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m18:41:11.755668 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m18:41:11.758650 [debug] [MainThread]: Parsing macros/sql/safe_divide.sql
[0m18:41:11.759145 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m18:41:11.765530 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m18:41:11.766156 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m18:41:11.767908 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m18:41:11.768619 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m18:41:11.769611 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m18:41:11.770345 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m18:41:11.773634 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m18:41:11.776360 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m18:41:11.778353 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m18:41:11.779639 [debug] [MainThread]: Parsing macros/sql/width_bucket.sql
[0m18:41:11.782170 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m18:41:11.783238 [debug] [MainThread]: Parsing macros/sql/generate_surrogate_key.sql
[0m18:41:11.784424 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m18:41:11.785157 [debug] [MainThread]: Parsing macros/sql/get_single_value.sql
[0m18:41:11.786573 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m18:41:12.032678 [debug] [MainThread]: 1603: static parser failed on staging/stg_referrals.sql
[0m18:41:12.040305 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_referrals.sql
[0m18:41:12.041001 [debug] [MainThread]: 1603: static parser failed on staging/stg_partners.sql
[0m18:41:12.043410 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/stg_partners.sql
[0m18:41:12.044150 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_referrals.sql
[0m18:41:12.065703 [debug] [MainThread]: 1603: static parser failed on dbt_metrics_default_calendar.sql
[0m18:41:12.083005 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dbt_metrics_default_calendar.sql
[0m18:41:12.148957 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ggchallengejoao.example

[0m18:41:12.152316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c22eb810-594c-4032-acd3-400f6d90a35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d45f0d0>]}
[0m18:41:12.159539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c22eb810-594c-4032-acd3-400f6d90a35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d2e9460>]}
[0m18:41:12.159797 [info ] [MainThread]: Found 4 models, 6 tests, 0 snapshots, 0 analyses, 533 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 2 metrics
[0m18:41:12.159968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c22eb810-594c-4032-acd3-400f6d90a35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d301820>]}
[0m18:41:12.161439 [info ] [MainThread]: 
[0m18:41:12.161865 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m18:41:12.162504 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801"
[0m18:41:12.162648 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:14.667751 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801_getgroundjoao"
[0m18:41:14.668415 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:15.122089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c22eb810-594c-4032-acd3-400f6d90a35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d0440d0>]}
[0m18:41:15.123635 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:41:15.124148 [info ] [MainThread]: 
[0m18:41:15.133011 [debug] [Thread-1  ]: Began running node model.ggchallengejoao.stg_partners
[0m18:41:15.133321 [debug] [Thread-2  ]: Began running node model.ggchallengejoao.stg_referrals
[0m18:41:15.133572 [debug] [Thread-3  ]: Began running node model.metrics.dbt_metrics_default_calendar
[0m18:41:15.134106 [info ] [Thread-1  ]: 1 of 4 START sql view model getgroundjoao.stg_partners ......................... [RUN]
[0m18:41:15.134523 [info ] [Thread-2  ]: 2 of 4 START sql view model getgroundjoao.stg_referrals ........................ [RUN]
[0m18:41:15.134873 [info ] [Thread-3  ]: 3 of 4 START sql table model getgroundjoao.dbt_metrics_default_calendar ........ [RUN]
[0m18:41:15.135933 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_partners"
[0m18:41:15.136914 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_referrals"
[0m18:41:15.137869 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.metrics.dbt_metrics_default_calendar"
[0m18:41:15.138443 [debug] [Thread-1  ]: Began compiling node model.ggchallengejoao.stg_partners
[0m18:41:15.138722 [debug] [Thread-2  ]: Began compiling node model.ggchallengejoao.stg_referrals
[0m18:41:15.138930 [debug] [Thread-3  ]: Began compiling node model.metrics.dbt_metrics_default_calendar
[0m18:41:15.139303 [debug] [Thread-1  ]: Compiling model.ggchallengejoao.stg_partners
[0m18:41:15.139492 [debug] [Thread-2  ]: Compiling model.ggchallengejoao.stg_referrals
[0m18:41:15.139667 [debug] [Thread-3  ]: Compiling model.metrics.dbt_metrics_default_calendar
[0m18:41:15.147477 [debug] [Thread-1  ]: Writing injected SQL for node "model.ggchallengejoao.stg_partners"
[0m18:41:15.152750 [debug] [Thread-2  ]: Writing injected SQL for node "model.ggchallengejoao.stg_referrals"
[0m18:41:15.167774 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:41:15.169981 [debug] [Thread-3  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */


        select 

    datetime_diff(
        cast(cast('2030-01-01' as date) as datetime),
        cast(cast('1990-01-01' as date) as datetime),
        day
    )

  
[0m18:41:15.172264 [debug] [Thread-2  ]: finished collecting timing info
[0m18:41:15.172823 [debug] [Thread-1  ]: finished collecting timing info
[0m18:41:15.173001 [debug] [Thread-2  ]: Began executing node model.ggchallengejoao.stg_referrals
[0m18:41:15.173213 [debug] [Thread-1  ]: Began executing node model.ggchallengejoao.stg_partners
[0m18:41:15.199504 [debug] [Thread-1  ]: Writing runtime sql for node "model.ggchallengejoao.stg_partners"
[0m18:41:15.260367 [debug] [Thread-2  ]: Writing runtime sql for node "model.ggchallengejoao.stg_referrals"
[0m18:41:15.260782 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m18:41:15.260895 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:41:15.260988 [debug] [Thread-2  ]: On model.ggchallengejoao.stg_referrals: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.stg_referrals"} */


  create or replace view `dynamic-point-367801`.`getgroundjoao`.`stg_referrals`
  OPTIONS()
  as 

select *
except
    (created_at, updated_at),
    
timestamp_micros(cast(created_at/ 1000 as int64))
 as referral_created_at_timestamp,
    
timestamp_micros(cast(updated_at/ 1000 as int64))
 as referral_updated_at_timestamp
from `dynamic-point-367801`.`getgroundjoao`.`referrals`;


[0m18:41:15.261083 [debug] [Thread-1  ]: On model.ggchallengejoao.stg_partners: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.stg_partners"} */


  create or replace view `dynamic-point-367801`.`getgroundjoao`.`stg_partners`
  OPTIONS()
  as 

select *
except
    (lead_sales_contact, created_at, updated_at),
    if(
        lead_sales_contact = '0', 'No contact', lead_sales_contact
    ) as lead_sales_contact,
    
timestamp_micros(cast(created_at/ 1000 as int64))
 as partner_created_at_timestamp,
    
timestamp_micros(cast(updated_at/ 1000 as int64))
 as partner_updated_at_timestamp
from `dynamic-point-367801`.`getgroundjoao`.`partners`;


[0m18:41:16.425949 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:a29dddf8-78f3-4a0a-b0e7-ad3d7cf7ed77:EU&page=queryresults
[0m18:41:16.435719 [debug] [Thread-2  ]: finished collecting timing info
[0m18:41:16.436188 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c22eb810-594c-4032-acd3-400f6d90a35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d40edc0>]}
[0m18:41:16.436438 [info ] [Thread-2  ]: 2 of 4 OK created sql view model getgroundjoao.stg_referrals ................... [[32mCREATE VIEW (0 processed)[0m in 1.30s]
[0m18:41:16.436730 [debug] [Thread-2  ]: Finished running node model.ggchallengejoao.stg_referrals
[0m18:41:16.437050 [debug] [Thread-4  ]: Began running node model.ggchallengejoao.mart_referrals
[0m18:41:16.437241 [info ] [Thread-4  ]: 4 of 4 START sql table model getgroundjoao.mart_referrals ...................... [RUN]
[0m18:41:16.437626 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.ggchallengejoao.mart_referrals"
[0m18:41:16.437726 [debug] [Thread-4  ]: Began compiling node model.ggchallengejoao.mart_referrals
[0m18:41:16.437811 [debug] [Thread-4  ]: Compiling model.ggchallengejoao.mart_referrals
[0m18:41:16.440516 [debug] [Thread-4  ]: Writing injected SQL for node "model.ggchallengejoao.mart_referrals"
[0m18:41:16.441237 [debug] [Thread-4  ]: finished collecting timing info
[0m18:41:16.441335 [debug] [Thread-4  ]: Began executing node model.ggchallengejoao.mart_referrals
[0m18:41:16.448476 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m18:41:16.608855 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:c4121373-20c0-4f95-8ec0-8202fb1356a8:EU&page=queryresults
[0m18:41:16.609766 [debug] [Thread-1  ]: finished collecting timing info
[0m18:41:16.610118 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c22eb810-594c-4032-acd3-400f6d90a35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d40ebb0>]}
[0m18:41:16.610333 [info ] [Thread-1  ]: 1 of 4 OK created sql view model getgroundjoao.stg_partners .................... [[32mCREATE VIEW (0 processed)[0m in 1.47s]
[0m18:41:16.610625 [debug] [Thread-1  ]: Finished running node model.ggchallengejoao.stg_partners
[0m18:41:16.906649 [debug] [Thread-4  ]: Writing runtime sql for node "model.ggchallengejoao.mart_referrals"
[0m18:41:16.907083 [debug] [Thread-4  ]: On model.ggchallengejoao.mart_referrals: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.mart_referrals"} */

  
    

    create or replace table `dynamic-point-367801`.`getgroundjoao`.`mart_referrals`
    
    
    OPTIONS()
    as (
      

select
    r.company_id as referral_company,
    r.partner_id as referral_partner,
    r.status as referral_status,
    r.is_outbound as referral_outbound,
    r.referral_created_at_timestamp as referral_record_date,
    r.referral_updated_at_timestamp as referral_updated,
    timestamp_diff(
        referral_updated_at_timestamp, referral_created_at_timestamp, day
    ) as referral_days_from_creation,
    p.partner_type as referral_partner_type,
    p.lead_sales_contact as referral_lead_sales_contact,
    coalesce(d.country, 'No country') as referral_country
from `dynamic-point-367801`.`getgroundjoao`.`stg_referrals` r
left join `dynamic-point-367801`.`getgroundjoao`.`partners` p on r.partner_id = p.id
left join `dynamic-point-367801`.`getgroundjoao`.`sales_people` d on p.lead_sales_contact = d.name
    );
  
[0m18:41:17.027261 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:fd212bf9-78b1-49ab-93b0-f4185bb5ba70:EU&page=queryresults
[0m18:41:17.028597 [debug] [Thread-3  ]: Writing injected SQL for node "model.metrics.dbt_metrics_default_calendar"
[0m18:41:17.029158 [debug] [Thread-3  ]: finished collecting timing info
[0m18:41:17.029277 [debug] [Thread-3  ]: Began executing node model.metrics.dbt_metrics_default_calendar
[0m18:41:17.366184 [debug] [Thread-3  ]: Writing runtime sql for node "model.metrics.dbt_metrics_default_calendar"
[0m18:41:17.366585 [debug] [Thread-3  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */

  
    

    create or replace table `dynamic-point-367801`.`getgroundjoao`.`dbt_metrics_default_calendar`
    
    
    OPTIONS()
    as (
      

with days as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
     + 
    
    p11.generated_number * power(2, 11)
     + 
    
    p12.generated_number * power(2, 12)
     + 
    
    p13.generated_number * power(2, 13)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
     cross join 
    
    p as p11
     cross join 
    
    p as p12
     cross join 
    
    p as p13
    
    

    )

    select *
    from unioned
    where generated_number <= 14610
    order by generated_number



),

all_periods as (

    select (
        

        datetime_add(
            cast( cast('1990-01-01' as date) as datetime),
        interval row_number() over (order by 1) - 1 day
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2030-01-01' as date)

)

select * from filtered


),

final as (
    select 
        cast(date_day as date) as date_day,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        week
    ) as date) as date_week,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        month
    ) as date) as date_month,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        quarter
    ) as date) as date_quarter,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        year
    ) as date) as date_year
    from days
)

select * from final
    );
  
[0m18:41:19.518213 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:f695b2f3-96e2-4922-9b8e-482c5d2daa79:EU&page=queryresults
[0m18:41:19.520770 [debug] [Thread-4  ]: finished collecting timing info
[0m18:41:19.521587 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c22eb810-594c-4032-acd3-400f6d90a35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d28f250>]}
[0m18:41:19.521972 [info ] [Thread-4  ]: 4 of 4 OK created sql table model getgroundjoao.mart_referrals ................. [[32mCREATE TABLE (1.5k rows, 84.8 KB processed)[0m in 3.08s]
[0m18:41:19.522393 [debug] [Thread-4  ]: Finished running node model.ggchallengejoao.mart_referrals
[0m18:41:20.252424 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:43e3665b-b23d-419e-ac2a-42d984260aa3:EU&page=queryresults
[0m18:41:20.257699 [debug] [Thread-3  ]: finished collecting timing info
[0m18:41:20.258268 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c22eb810-594c-4032-acd3-400f6d90a35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cfc8c40>]}
[0m18:41:20.258551 [info ] [Thread-3  ]: 3 of 4 OK created sql table model getgroundjoao.dbt_metrics_default_calendar ... [[32mCREATE TABLE (14.6k rows, 0 processed)[0m in 5.12s]
[0m18:41:20.258903 [debug] [Thread-3  ]: Finished running node model.metrics.dbt_metrics_default_calendar
[0m18:41:20.261422 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m18:41:20.262354 [info ] [MainThread]: 
[0m18:41:20.262733 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 8.10 seconds (8.10s).
[0m18:41:20.263060 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:41:20.263221 [debug] [MainThread]: Connection 'model.ggchallengejoao.stg_partners' was properly closed.
[0m18:41:20.263368 [debug] [MainThread]: Connection 'model.ggchallengejoao.stg_referrals' was properly closed.
[0m18:41:20.263510 [debug] [MainThread]: Connection 'model.metrics.dbt_metrics_default_calendar' was properly closed.
[0m18:41:20.263654 [debug] [MainThread]: Connection 'model.ggchallengejoao.mart_referrals' was properly closed.
[0m18:41:20.285846 [info ] [MainThread]: 
[0m18:41:20.287089 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:41:20.288056 [info ] [MainThread]: 
[0m18:41:20.288451 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m18:41:20.289212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d136dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d45f190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d1f6430>]}
[0m18:41:20.289662 [debug] [MainThread]: Flushing usage events


============================== 2023-01-06 18:44:09.899049 | c8ad32f8-eb4a-42ca-90f3-6f83e991f180 ==============================
[0m18:44:09.899093 [info ] [MainThread]: Running with dbt=1.3.2
[0m18:44:09.899710 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joaopaulomedeiroscecilio/dev/dbt-data-analysis', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m18:44:09.899843 [debug] [MainThread]: Tracking: tracking
[0m18:44:09.923106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12903be20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12903bf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129056070>]}
[0m18:44:10.031915 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:44:10.032092 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:44:10.032425 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ggchallengejoao.example

[0m18:44:10.036686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8ad32f8-eb4a-42ca-90f3-6f83e991f180', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1292e00d0>]}
[0m18:44:10.045227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8ad32f8-eb4a-42ca-90f3-6f83e991f180', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1291a29a0>]}
[0m18:44:10.045500 [info ] [MainThread]: Found 4 models, 6 tests, 0 snapshots, 0 analyses, 533 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 2 metrics
[0m18:44:10.045656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8ad32f8-eb4a-42ca-90f3-6f83e991f180', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1291a2970>]}
[0m18:44:10.046648 [info ] [MainThread]: 
[0m18:44:10.047059 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m18:44:10.047748 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801_getgroundjoao"
[0m18:44:10.047901 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:44:11.757101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8ad32f8-eb4a-42ca-90f3-6f83e991f180', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1291a26a0>]}
[0m18:44:11.762952 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:44:11.767618 [info ] [MainThread]: 
[0m18:44:11.775383 [debug] [Thread-1  ]: Began running node model.metrics.dbt_metrics_default_calendar
[0m18:44:11.775597 [debug] [Thread-2  ]: Began running node seed.ggchallengejoao.partners
[0m18:44:11.775764 [debug] [Thread-3  ]: Began running node seed.ggchallengejoao.referrals
[0m18:44:11.776193 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.metrics.dbt_metrics_default_calendar"
[0m18:44:11.776406 [debug] [Thread-4  ]: Began running node seed.ggchallengejoao.sales_people
[0m18:44:11.776734 [debug] [Thread-2  ]: Acquiring new bigquery connection "seed.ggchallengejoao.partners"
[0m18:44:11.777031 [debug] [Thread-3  ]: Acquiring new bigquery connection "seed.ggchallengejoao.referrals"
[0m18:44:11.777150 [debug] [Thread-1  ]: Began compiling node model.metrics.dbt_metrics_default_calendar
[0m18:44:11.777550 [debug] [Thread-4  ]: Acquiring new bigquery connection "seed.ggchallengejoao.sales_people"
[0m18:44:11.777854 [debug] [Thread-2  ]: Began compiling node seed.ggchallengejoao.partners
[0m18:44:11.778407 [debug] [Thread-2  ]: Compiling seed.ggchallengejoao.partners
[0m18:44:11.778241 [debug] [Thread-1  ]: Compiling model.metrics.dbt_metrics_default_calendar
[0m18:44:11.778328 [debug] [Thread-4  ]: Began compiling node seed.ggchallengejoao.sales_people
[0m18:44:11.800619 [debug] [Thread-4  ]: Compiling seed.ggchallengejoao.sales_people
[0m18:44:11.778017 [debug] [Thread-3  ]: Began compiling node seed.ggchallengejoao.referrals
[0m18:44:11.802755 [debug] [Thread-4  ]: Writing injected SQL for node "seed.ggchallengejoao.sales_people"
[0m18:44:11.813259 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:44:11.781087 [debug] [Thread-2  ]: Writing injected SQL for node "seed.ggchallengejoao.partners"
[0m18:44:11.813504 [debug] [Thread-3  ]: Compiling seed.ggchallengejoao.referrals
[0m18:44:11.813609 [debug] [Thread-4  ]: finished collecting timing info
[0m18:44:11.813762 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */


        select 

    datetime_diff(
        cast(cast('2030-01-01' as date) as datetime),
        cast(cast('1990-01-01' as date) as datetime),
        day
    )

  
[0m18:44:11.813840 [debug] [Thread-2  ]: finished collecting timing info
[0m18:44:11.815033 [debug] [Thread-4  ]: Began executing node seed.ggchallengejoao.sales_people
[0m18:44:11.816893 [debug] [Thread-2  ]: Began executing node seed.ggchallengejoao.partners
[0m18:44:11.819127 [debug] [Thread-3  ]: Writing injected SQL for node "seed.ggchallengejoao.referrals"
[0m18:44:11.819277 [debug] [Thread-4  ]: finished collecting timing info
[0m18:44:11.819479 [debug] [Thread-2  ]: finished collecting timing info
[0m18:44:11.819625 [debug] [Thread-3  ]: finished collecting timing info
[0m18:44:11.820116 [debug] [Thread-4  ]: Finished running node seed.ggchallengejoao.sales_people
[0m18:44:11.820613 [debug] [Thread-2  ]: Finished running node seed.ggchallengejoao.partners
[0m18:44:11.820917 [debug] [Thread-3  ]: Began executing node seed.ggchallengejoao.referrals
[0m18:44:11.821395 [debug] [Thread-4  ]: Began running node model.ggchallengejoao.stg_partners
[0m18:44:11.821499 [debug] [Thread-3  ]: finished collecting timing info
[0m18:44:11.821810 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_partners"
[0m18:44:11.822205 [debug] [Thread-3  ]: Finished running node seed.ggchallengejoao.referrals
[0m18:44:11.822309 [debug] [Thread-4  ]: Began compiling node model.ggchallengejoao.stg_partners
[0m18:44:11.822533 [debug] [Thread-2  ]: Began running node model.ggchallengejoao.stg_referrals
[0m18:44:11.822624 [debug] [Thread-4  ]: Compiling model.ggchallengejoao.stg_partners
[0m18:44:11.822919 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_referrals"
[0m18:44:11.826400 [debug] [Thread-4  ]: Writing injected SQL for node "model.ggchallengejoao.stg_partners"
[0m18:44:11.826607 [debug] [Thread-2  ]: Began compiling node model.ggchallengejoao.stg_referrals
[0m18:44:11.826823 [debug] [Thread-2  ]: Compiling model.ggchallengejoao.stg_referrals
[0m18:44:11.829656 [debug] [Thread-2  ]: Writing injected SQL for node "model.ggchallengejoao.stg_referrals"
[0m18:44:11.829908 [debug] [Thread-4  ]: finished collecting timing info
[0m18:44:11.830089 [debug] [Thread-4  ]: Began executing node model.ggchallengejoao.stg_partners
[0m18:44:11.830225 [debug] [Thread-4  ]: finished collecting timing info
[0m18:44:11.830653 [debug] [Thread-4  ]: Finished running node model.ggchallengejoao.stg_partners
[0m18:44:11.830737 [debug] [Thread-2  ]: finished collecting timing info
[0m18:44:11.831036 [debug] [Thread-3  ]: Began running node test.ggchallengejoao.not_null_stg_partners_id.625c7b2674
[0m18:44:11.831132 [debug] [Thread-4  ]: Began running node test.ggchallengejoao.unique_stg_partners_id.8b2ef7f041
[0m18:44:11.831217 [debug] [Thread-2  ]: Began executing node model.ggchallengejoao.stg_referrals
[0m18:44:11.831533 [debug] [Thread-3  ]: Acquiring new bigquery connection "test.ggchallengejoao.not_null_stg_partners_id.625c7b2674"
[0m18:44:11.831847 [debug] [Thread-4  ]: Acquiring new bigquery connection "test.ggchallengejoao.unique_stg_partners_id.8b2ef7f041"
[0m18:44:11.831957 [debug] [Thread-2  ]: finished collecting timing info
[0m18:44:11.832054 [debug] [Thread-3  ]: Began compiling node test.ggchallengejoao.not_null_stg_partners_id.625c7b2674
[0m18:44:11.832143 [debug] [Thread-4  ]: Began compiling node test.ggchallengejoao.unique_stg_partners_id.8b2ef7f041
[0m18:44:11.832470 [debug] [Thread-2  ]: Finished running node model.ggchallengejoao.stg_referrals
[0m18:44:11.832568 [debug] [Thread-3  ]: Compiling test.ggchallengejoao.not_null_stg_partners_id.625c7b2674
[0m18:44:11.832659 [debug] [Thread-4  ]: Compiling test.ggchallengejoao.unique_stg_partners_id.8b2ef7f041
[0m18:44:11.832885 [debug] [Thread-2  ]: Began running node model.ggchallengejoao.mart_referrals
[0m18:44:11.841166 [debug] [Thread-3  ]: Writing injected SQL for node "test.ggchallengejoao.not_null_stg_partners_id.625c7b2674"
[0m18:44:11.845568 [debug] [Thread-4  ]: Writing injected SQL for node "test.ggchallengejoao.unique_stg_partners_id.8b2ef7f041"
[0m18:44:11.846016 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.ggchallengejoao.mart_referrals"
[0m18:44:11.846304 [debug] [Thread-2  ]: Began compiling node model.ggchallengejoao.mart_referrals
[0m18:44:11.846431 [debug] [Thread-2  ]: Compiling model.ggchallengejoao.mart_referrals
[0m18:44:11.850036 [debug] [Thread-2  ]: Writing injected SQL for node "model.ggchallengejoao.mart_referrals"
[0m18:44:11.850558 [debug] [Thread-3  ]: finished collecting timing info
[0m18:44:11.850662 [debug] [Thread-3  ]: Began executing node test.ggchallengejoao.not_null_stg_partners_id.625c7b2674
[0m18:44:11.850741 [debug] [Thread-4  ]: finished collecting timing info
[0m18:44:11.850841 [debug] [Thread-3  ]: finished collecting timing info
[0m18:44:11.850910 [debug] [Thread-2  ]: finished collecting timing info
[0m18:44:11.850999 [debug] [Thread-4  ]: Began executing node test.ggchallengejoao.unique_stg_partners_id.8b2ef7f041
[0m18:44:11.851352 [debug] [Thread-3  ]: Finished running node test.ggchallengejoao.not_null_stg_partners_id.625c7b2674
[0m18:44:11.851445 [debug] [Thread-2  ]: Began executing node model.ggchallengejoao.mart_referrals
[0m18:44:11.851529 [debug] [Thread-4  ]: finished collecting timing info
[0m18:44:11.851628 [debug] [Thread-3  ]: Began running node test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f
[0m18:44:11.851740 [debug] [Thread-2  ]: finished collecting timing info
[0m18:44:11.852011 [debug] [Thread-4  ]: Finished running node test.ggchallengejoao.unique_stg_partners_id.8b2ef7f041
[0m18:44:11.852712 [debug] [Thread-4  ]: Began running node test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53
[0m18:44:11.852281 [debug] [Thread-3  ]: Acquiring new bigquery connection "test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f"
[0m18:44:11.853579 [debug] [Thread-3  ]: Began compiling node test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f
[0m18:44:11.853309 [debug] [Thread-4  ]: Acquiring new bigquery connection "test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53"
[0m18:44:11.853704 [debug] [Thread-3  ]: Compiling test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f
[0m18:44:11.852585 [debug] [Thread-2  ]: Finished running node model.ggchallengejoao.mart_referrals
[0m18:44:11.853822 [debug] [Thread-4  ]: Began compiling node test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53
[0m18:44:11.858934 [debug] [Thread-3  ]: Writing injected SQL for node "test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f"
[0m18:44:11.859173 [debug] [Thread-2  ]: Began running node test.ggchallengejoao.not_null_stg_referrals_id.f511791502
[0m18:44:11.859334 [debug] [Thread-4  ]: Compiling test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53
[0m18:44:11.860073 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.ggchallengejoao.not_null_stg_referrals_id.f511791502"
[0m18:44:11.866495 [debug] [Thread-3  ]: finished collecting timing info
[0m18:44:11.867797 [debug] [Thread-2  ]: Began compiling node test.ggchallengejoao.not_null_stg_referrals_id.f511791502
[0m18:44:11.868371 [debug] [Thread-4  ]: Writing injected SQL for node "test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53"
[0m18:44:11.868785 [debug] [Thread-3  ]: Began executing node test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f
[0m18:44:11.868919 [debug] [Thread-2  ]: Compiling test.ggchallengejoao.not_null_stg_referrals_id.f511791502
[0m18:44:11.869081 [debug] [Thread-3  ]: finished collecting timing info
[0m18:44:11.871916 [debug] [Thread-2  ]: Writing injected SQL for node "test.ggchallengejoao.not_null_stg_referrals_id.f511791502"
[0m18:44:11.872377 [debug] [Thread-3  ]: Finished running node test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f
[0m18:44:11.872459 [debug] [Thread-4  ]: finished collecting timing info
[0m18:44:11.872691 [debug] [Thread-3  ]: Began running node test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f
[0m18:44:11.872849 [debug] [Thread-4  ]: Began executing node test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53
[0m18:44:11.872992 [debug] [Thread-2  ]: finished collecting timing info
[0m18:44:11.873259 [debug] [Thread-3  ]: Acquiring new bigquery connection "test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f"
[0m18:44:11.873360 [debug] [Thread-4  ]: finished collecting timing info
[0m18:44:11.873452 [debug] [Thread-2  ]: Began executing node test.ggchallengejoao.not_null_stg_referrals_id.f511791502
[0m18:44:11.873534 [debug] [Thread-3  ]: Began compiling node test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f
[0m18:44:11.873819 [debug] [Thread-4  ]: Finished running node test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53
[0m18:44:11.873902 [debug] [Thread-2  ]: finished collecting timing info
[0m18:44:11.873983 [debug] [Thread-3  ]: Compiling test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f
[0m18:44:11.874322 [debug] [Thread-2  ]: Finished running node test.ggchallengejoao.not_null_stg_referrals_id.f511791502
[0m18:44:11.877291 [debug] [Thread-3  ]: Writing injected SQL for node "test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f"
[0m18:44:11.877772 [debug] [Thread-3  ]: finished collecting timing info
[0m18:44:11.877863 [debug] [Thread-3  ]: Began executing node test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f
[0m18:44:11.877944 [debug] [Thread-3  ]: finished collecting timing info
[0m18:44:11.878313 [debug] [Thread-3  ]: Finished running node test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f
[0m18:44:13.615578 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:32103aad-4437-49db-9094-c1a655e410cc:EU&page=queryresults
[0m18:44:13.640826 [debug] [Thread-1  ]: Writing injected SQL for node "model.metrics.dbt_metrics_default_calendar"
[0m18:44:13.641953 [debug] [Thread-1  ]: finished collecting timing info
[0m18:44:13.642247 [debug] [Thread-1  ]: Began executing node model.metrics.dbt_metrics_default_calendar
[0m18:44:13.642476 [debug] [Thread-1  ]: finished collecting timing info
[0m18:44:13.643345 [debug] [Thread-1  ]: Finished running node model.metrics.dbt_metrics_default_calendar
[0m18:44:13.644541 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:44:13.644779 [debug] [MainThread]: Connection 'model.metrics.dbt_metrics_default_calendar' was properly closed.
[0m18:44:13.644931 [debug] [MainThread]: Connection 'test.ggchallengejoao.not_null_stg_referrals_id.f511791502' was properly closed.
[0m18:44:13.645060 [debug] [MainThread]: Connection 'test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f' was properly closed.
[0m18:44:13.645184 [debug] [MainThread]: Connection 'test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53' was properly closed.
[0m18:44:13.658474 [info ] [MainThread]: Done.
[0m18:44:13.658944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12944c0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12944c190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12944c6d0>]}
[0m18:44:13.659231 [debug] [MainThread]: Flushing usage events


============================== 2023-01-06 19:00:16.646341 | f409c063-2938-40f2-b818-a25ad7113e8d ==============================
[0m19:00:16.646366 [info ] [MainThread]: Running with dbt=1.3.2
[0m19:00:16.647265 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joaopaulomedeiroscecilio/dev/dbt-data-analysis', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:00:16.647403 [debug] [MainThread]: Tracking: tracking
[0m19:00:16.659970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e83be80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e856070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e8560a0>]}
[0m19:00:16.820240 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m19:00:16.820647 [debug] [MainThread]: Partial parsing: deleted metric metric.ggchallengejoao.referral_total_count
[0m19:00:16.820745 [debug] [MainThread]: Partial parsing: deleted metric metric.ggchallengejoao.referral_avg_days_from_creation
[0m19:00:16.820858 [debug] [MainThread]: Partial parsing: update schema file: ggchallengejoao://models/marts/referrals.yml
[0m19:00:16.821161 [debug] [MainThread]: Partial parsing: update schema file: ggchallengejoao://models/schema.yml
[0m19:00:16.821280 [debug] [MainThread]: Partial parsing: updated file: ggchallengejoao://models/marts/mart_referrals.sql
[0m19:00:16.832057 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_referrals.sql
[0m19:00:16.874427 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ggchallengejoao.example

[0m19:00:16.883019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f409c063-2938-40f2-b818-a25ad7113e8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ec760d0>]}
[0m19:00:16.900371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f409c063-2938-40f2-b818-a25ad7113e8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11eb741c0>]}
[0m19:00:16.900648 [info ] [MainThread]: Found 4 models, 6 tests, 0 snapshots, 0 analyses, 533 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 2 metrics
[0m19:00:16.900837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f409c063-2938-40f2-b818-a25ad7113e8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11eb74310>]}
[0m19:00:16.902215 [info ] [MainThread]: 
[0m19:00:16.902738 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m19:00:16.903377 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801"
[0m19:00:16.903533 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:19.040793 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801_getgroundjoao"
[0m19:00:19.041853 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:00:19.483926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f409c063-2938-40f2-b818-a25ad7113e8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ec45070>]}
[0m19:00:19.484729 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:00:19.485052 [info ] [MainThread]: 
[0m19:00:19.491448 [debug] [Thread-1  ]: Began running node model.ggchallengejoao.stg_partners
[0m19:00:19.491593 [debug] [Thread-2  ]: Began running node model.ggchallengejoao.stg_referrals
[0m19:00:19.491712 [debug] [Thread-3  ]: Began running node model.metrics.dbt_metrics_default_calendar
[0m19:00:19.491946 [info ] [Thread-1  ]: 1 of 4 START sql view model getgroundjoao.stg_partners ......................... [RUN]
[0m19:00:19.492118 [info ] [Thread-2  ]: 2 of 4 START sql view model getgroundjoao.stg_referrals ........................ [RUN]
[0m19:00:19.492267 [info ] [Thread-3  ]: 3 of 4 START sql table model getgroundjoao.dbt_metrics_default_calendar ........ [RUN]
[0m19:00:19.492811 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_partners"
[0m19:00:19.493348 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_referrals"
[0m19:00:19.493891 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.metrics.dbt_metrics_default_calendar"
[0m19:00:19.494052 [debug] [Thread-1  ]: Began compiling node model.ggchallengejoao.stg_partners
[0m19:00:19.494174 [debug] [Thread-2  ]: Began compiling node model.ggchallengejoao.stg_referrals
[0m19:00:19.494284 [debug] [Thread-3  ]: Began compiling node model.metrics.dbt_metrics_default_calendar
[0m19:00:19.494550 [debug] [Thread-1  ]: Compiling model.ggchallengejoao.stg_partners
[0m19:00:19.494681 [debug] [Thread-2  ]: Compiling model.ggchallengejoao.stg_referrals
[0m19:00:19.494797 [debug] [Thread-3  ]: Compiling model.metrics.dbt_metrics_default_calendar
[0m19:00:19.500254 [debug] [Thread-1  ]: Writing injected SQL for node "model.ggchallengejoao.stg_partners"
[0m19:00:19.503616 [debug] [Thread-2  ]: Writing injected SQL for node "model.ggchallengejoao.stg_referrals"
[0m19:00:19.518937 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:00:19.519520 [debug] [Thread-3  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */


        select 

    datetime_diff(
        cast(cast('2030-01-01' as date) as datetime),
        cast(cast('1990-01-01' as date) as datetime),
        day
    )

  
[0m19:00:19.520396 [debug] [Thread-1  ]: finished collecting timing info
[0m19:00:19.520481 [debug] [Thread-2  ]: finished collecting timing info
[0m19:00:19.520841 [debug] [Thread-1  ]: Began executing node model.ggchallengejoao.stg_partners
[0m19:00:19.520969 [debug] [Thread-2  ]: Began executing node model.ggchallengejoao.stg_referrals
[0m19:00:19.538638 [debug] [Thread-2  ]: Writing runtime sql for node "model.ggchallengejoao.stg_referrals"
[0m19:00:19.539352 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m19:00:19.539488 [debug] [Thread-2  ]: On model.ggchallengejoao.stg_referrals: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.stg_referrals"} */


  create or replace view `dynamic-point-367801`.`getgroundjoao`.`stg_referrals`
  OPTIONS()
  as 

select *
except
    (created_at, updated_at),
    
timestamp_micros(cast(created_at/ 1000 as int64))
 as referral_created_at_timestamp,
    
timestamp_micros(cast(updated_at/ 1000 as int64))
 as referral_updated_at_timestamp
from `dynamic-point-367801`.`getgroundjoao`.`referrals`;


[0m19:00:19.541883 [debug] [Thread-1  ]: Writing runtime sql for node "model.ggchallengejoao.stg_partners"
[0m19:00:19.542621 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:00:19.542747 [debug] [Thread-1  ]: On model.ggchallengejoao.stg_partners: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.stg_partners"} */


  create or replace view `dynamic-point-367801`.`getgroundjoao`.`stg_partners`
  OPTIONS()
  as 

select *
except
    (lead_sales_contact, created_at, updated_at),
    if(
        lead_sales_contact = '0', 'No contact', lead_sales_contact
    ) as lead_sales_contact,
    
timestamp_micros(cast(created_at/ 1000 as int64))
 as partner_created_at_timestamp,
    
timestamp_micros(cast(updated_at/ 1000 as int64))
 as partner_updated_at_timestamp
from `dynamic-point-367801`.`getgroundjoao`.`partners`;


[0m19:00:20.888188 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:563cee3b-db15-444a-9b8c-29e5922e284c:EU&page=queryresults
[0m19:00:20.910536 [debug] [Thread-2  ]: finished collecting timing info
[0m19:00:20.911561 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f409c063-2938-40f2-b818-a25ad7113e8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ecf4d60>]}
[0m19:00:20.912110 [info ] [Thread-2  ]: 2 of 4 OK created sql view model getgroundjoao.stg_referrals ................... [[32mCREATE VIEW (0 processed)[0m in 1.42s]
[0m19:00:20.912836 [debug] [Thread-2  ]: Finished running node model.ggchallengejoao.stg_referrals
[0m19:00:20.913562 [debug] [Thread-4  ]: Began running node model.ggchallengejoao.mart_referrals
[0m19:00:20.913799 [info ] [Thread-4  ]: 4 of 4 START sql table model getgroundjoao.mart_referrals ...................... [RUN]
[0m19:00:20.914403 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.ggchallengejoao.mart_referrals"
[0m19:00:20.914586 [debug] [Thread-4  ]: Began compiling node model.ggchallengejoao.mart_referrals
[0m19:00:20.914843 [debug] [Thread-4  ]: Compiling model.ggchallengejoao.mart_referrals
[0m19:00:20.920446 [debug] [Thread-4  ]: Writing injected SQL for node "model.ggchallengejoao.mart_referrals"
[0m19:00:20.921670 [debug] [Thread-4  ]: finished collecting timing info
[0m19:00:20.921904 [debug] [Thread-4  ]: Began executing node model.ggchallengejoao.mart_referrals
[0m19:00:20.940637 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m19:00:21.014551 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:2f7900f8-774e-4898-b9fb-9d5b2dc1f369:EU&page=queryresults
[0m19:00:21.015833 [debug] [Thread-1  ]: finished collecting timing info
[0m19:00:21.016317 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f409c063-2938-40f2-b818-a25ad7113e8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ecb0040>]}
[0m19:00:21.016590 [info ] [Thread-1  ]: 1 of 4 OK created sql view model getgroundjoao.stg_partners .................... [[32mCREATE VIEW (0 processed)[0m in 1.52s]
[0m19:00:21.017022 [debug] [Thread-1  ]: Finished running node model.ggchallengejoao.stg_partners
[0m19:00:21.453224 [debug] [Thread-4  ]: Writing runtime sql for node "model.ggchallengejoao.mart_referrals"
[0m19:00:21.454871 [debug] [Thread-4  ]: On model.ggchallengejoao.mart_referrals: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.mart_referrals"} */

  
    

    create or replace table `dynamic-point-367801`.`getgroundjoao`.`mart_referrals`
    
    
    OPTIONS()
    as (
      

select
    r.id as referral_id,
    r.company_id as referral_company,
    r.partner_id as referral_partner,
    r.status as referral_status,
    r.is_outbound as referral_outbound,
    r.referral_created_at_timestamp as referral_record_date,
    r.referral_updated_at_timestamp as referral_updated,
    timestamp_diff(
        referral_updated_at_timestamp, referral_created_at_timestamp, day
    ) as referral_days_from_creation,
    p.partner_type as referral_partner_type,
    p.lead_sales_contact as referral_lead_sales_contact,
    coalesce(d.country, 'No country') as referral_country
from `dynamic-point-367801`.`getgroundjoao`.`stg_referrals` r
left join `dynamic-point-367801`.`getgroundjoao`.`partners` p on r.partner_id = p.id
left join `dynamic-point-367801`.`getgroundjoao`.`sales_people` d on p.lead_sales_contact = d.name
    );
  
[0m19:00:21.820018 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:909fa571-20f9-4c0b-b768-14bb85ba5367:EU&page=queryresults
[0m19:00:21.844780 [debug] [Thread-3  ]: Writing injected SQL for node "model.metrics.dbt_metrics_default_calendar"
[0m19:00:21.845932 [debug] [Thread-3  ]: finished collecting timing info
[0m19:00:21.846219 [debug] [Thread-3  ]: Began executing node model.metrics.dbt_metrics_default_calendar
[0m19:00:22.163218 [debug] [Thread-3  ]: Writing runtime sql for node "model.metrics.dbt_metrics_default_calendar"
[0m19:00:22.164248 [debug] [Thread-3  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */

  
    

    create or replace table `dynamic-point-367801`.`getgroundjoao`.`dbt_metrics_default_calendar`
    
    
    OPTIONS()
    as (
      

with days as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
     + 
    
    p11.generated_number * power(2, 11)
     + 
    
    p12.generated_number * power(2, 12)
     + 
    
    p13.generated_number * power(2, 13)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
     cross join 
    
    p as p11
     cross join 
    
    p as p12
     cross join 
    
    p as p13
    
    

    )

    select *
    from unioned
    where generated_number <= 14610
    order by generated_number



),

all_periods as (

    select (
        

        datetime_add(
            cast( cast('1990-01-01' as date) as datetime),
        interval row_number() over (order by 1) - 1 day
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2030-01-01' as date)

)

select * from filtered


),

final as (
    select 
        cast(date_day as date) as date_day,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        week
    ) as date) as date_week,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        month
    ) as date) as date_month,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        quarter
    ) as date) as date_quarter,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        year
    ) as date) as date_year
    from days
)

select * from final
    );
  
[0m19:00:24.675564 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:39b359b4-19b8-4892-8814-5ee63e520af7:EU&page=queryresults
[0m19:00:24.680843 [debug] [Thread-4  ]: finished collecting timing info
[0m19:00:24.683398 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f409c063-2938-40f2-b818-a25ad7113e8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11eea7670>]}
[0m19:00:24.684731 [info ] [Thread-4  ]: 4 of 4 OK created sql table model getgroundjoao.mart_referrals ................. [[32mCREATE TABLE (1.5k rows, 96.3 KB processed)[0m in 3.77s]
[0m19:00:24.686042 [debug] [Thread-4  ]: Finished running node model.ggchallengejoao.mart_referrals
[0m19:00:25.491494 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:dc73e1f9-01d4-4a5d-aa0c-108a301824be:EU&page=queryresults
[0m19:00:25.494305 [debug] [Thread-3  ]: finished collecting timing info
[0m19:00:25.495379 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f409c063-2938-40f2-b818-a25ad7113e8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ecf4dc0>]}
[0m19:00:25.495921 [info ] [Thread-3  ]: 3 of 4 OK created sql table model getgroundjoao.dbt_metrics_default_calendar ... [[32mCREATE TABLE (14.6k rows, 0 processed)[0m in 6.00s]
[0m19:00:25.496683 [debug] [Thread-3  ]: Finished running node model.metrics.dbt_metrics_default_calendar
[0m19:00:25.499455 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m19:00:25.500566 [info ] [MainThread]: 
[0m19:00:25.501025 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 8.60 seconds (8.60s).
[0m19:00:25.501421 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:00:25.501616 [debug] [MainThread]: Connection 'model.ggchallengejoao.stg_partners' was properly closed.
[0m19:00:25.501799 [debug] [MainThread]: Connection 'model.ggchallengejoao.stg_referrals' was properly closed.
[0m19:00:25.501978 [debug] [MainThread]: Connection 'model.metrics.dbt_metrics_default_calendar' was properly closed.
[0m19:00:25.502157 [debug] [MainThread]: Connection 'model.ggchallengejoao.mart_referrals' was properly closed.
[0m19:00:25.530504 [info ] [MainThread]: 
[0m19:00:25.530878 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:00:25.531143 [info ] [MainThread]: 
[0m19:00:25.531363 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m19:00:25.531739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11eec50d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f047e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f047f70>]}
[0m19:00:25.532125 [debug] [MainThread]: Flushing usage events


============================== 2023-01-06 19:19:25.075566 | 490d2d94-7831-4ed1-b719-76a67f4ca0ed ==============================
[0m19:19:25.075604 [info ] [MainThread]: Running with dbt=1.3.2
[0m19:19:25.076310 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joaopaulomedeiroscecilio/dev/dbt-data-analysis', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'parse_only': False, 'select': ['mart_referrals'], 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m19:19:25.076426 [debug] [MainThread]: Tracking: tracking
[0m19:19:25.091072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1278fbf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127915130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1279150d0>]}
[0m19:19:25.193509 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:19:25.193657 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:19:25.193946 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ggchallengejoao.example

[0m19:19:25.197514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '490d2d94-7831-4ed1-b719-76a67f4ca0ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127baadc0>]}
[0m19:19:25.205682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '490d2d94-7831-4ed1-b719-76a67f4ca0ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127a42c70>]}
[0m19:19:25.205898 [info ] [MainThread]: Found 4 models, 6 tests, 0 snapshots, 0 analyses, 533 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 2 metrics
[0m19:19:25.206038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '490d2d94-7831-4ed1-b719-76a67f4ca0ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127a42b50>]}
[0m19:19:25.206799 [info ] [MainThread]: 
[0m19:19:25.207171 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m19:19:25.207816 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801_getgroundjoao"
[0m19:19:25.207963 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:19:27.284070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '490d2d94-7831-4ed1-b719-76a67f4ca0ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127a42970>]}
[0m19:19:27.285177 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:19:27.285540 [info ] [MainThread]: 
[0m19:19:27.290988 [debug] [Thread-1  ]: Began running node model.ggchallengejoao.mart_referrals
[0m19:19:27.291613 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.ggchallengejoao.mart_referrals"
[0m19:19:27.291784 [debug] [Thread-1  ]: Began compiling node model.ggchallengejoao.mart_referrals
[0m19:19:27.292105 [debug] [Thread-1  ]: Compiling model.ggchallengejoao.mart_referrals
[0m19:19:27.297455 [debug] [Thread-1  ]: Writing injected SQL for node "model.ggchallengejoao.mart_referrals"
[0m19:19:27.298515 [debug] [Thread-1  ]: finished collecting timing info
[0m19:19:27.298741 [debug] [Thread-1  ]: Began executing node model.ggchallengejoao.mart_referrals
[0m19:19:27.299062 [debug] [Thread-1  ]: finished collecting timing info
[0m19:19:27.299904 [debug] [Thread-1  ]: Finished running node model.ggchallengejoao.mart_referrals
[0m19:19:27.301310 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:19:27.301477 [debug] [MainThread]: Connection 'model.ggchallengejoao.mart_referrals' was properly closed.
[0m19:19:27.316000 [info ] [MainThread]: Done.
[0m19:19:27.316818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127a42ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127a42670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127b6a610>]}
[0m19:19:27.317011 [debug] [MainThread]: Flushing usage events


============================== 2023-01-06 19:21:40.823631 | 7dab0350-05c9-4b23-8715-6b00f176ed9d ==============================
[0m19:21:40.823649 [info ] [MainThread]: Running with dbt=1.3.2
[0m19:21:40.824186 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joaopaulomedeiroscecilio/dev/dbt-data-analysis', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:21:40.824284 [debug] [MainThread]: Tracking: tracking
[0m19:21:40.837127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127dfaee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127f13100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127f130a0>]}
[0m19:21:40.912645 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:21:40.912790 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:21:40.913088 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ggchallengejoao.example

[0m19:21:40.916865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7dab0350-05c9-4b23-8715-6b00f176ed9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1379aad90>]}
[0m19:21:40.924928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7dab0350-05c9-4b23-8715-6b00f176ed9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137847c40>]}
[0m19:21:40.925139 [info ] [MainThread]: Found 4 models, 6 tests, 0 snapshots, 0 analyses, 533 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 2 metrics
[0m19:21:40.925283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dab0350-05c9-4b23-8715-6b00f176ed9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137847b20>]}
[0m19:21:40.926156 [info ] [MainThread]: 
[0m19:21:40.926513 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m19:21:40.927050 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801"
[0m19:21:40.927215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:21:42.524644 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801_getgroundjoao"
[0m19:21:42.525381 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:21:42.954919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dab0350-05c9-4b23-8715-6b00f176ed9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127df4670>]}
[0m19:21:42.956656 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:21:42.957243 [info ] [MainThread]: 
[0m19:21:42.979545 [debug] [Thread-1  ]: Began running node model.ggchallengejoao.stg_partners
[0m19:21:42.979832 [debug] [Thread-2  ]: Began running node model.ggchallengejoao.stg_referrals
[0m19:21:42.980086 [debug] [Thread-3  ]: Began running node model.metrics.dbt_metrics_default_calendar
[0m19:21:42.980516 [info ] [Thread-1  ]: 1 of 4 START sql view model getgroundjoao.stg_partners ......................... [RUN]
[0m19:21:42.980845 [info ] [Thread-2  ]: 2 of 4 START sql view model getgroundjoao.stg_referrals ........................ [RUN]
[0m19:21:42.981093 [info ] [Thread-3  ]: 3 of 4 START sql table model getgroundjoao.dbt_metrics_default_calendar ........ [RUN]
[0m19:21:42.981989 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_partners"
[0m19:21:42.982978 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_referrals"
[0m19:21:42.983846 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.metrics.dbt_metrics_default_calendar"
[0m19:21:42.984075 [debug] [Thread-1  ]: Began compiling node model.ggchallengejoao.stg_partners
[0m19:21:42.984251 [debug] [Thread-2  ]: Began compiling node model.ggchallengejoao.stg_referrals
[0m19:21:42.984416 [debug] [Thread-3  ]: Began compiling node model.metrics.dbt_metrics_default_calendar
[0m19:21:42.984701 [debug] [Thread-1  ]: Compiling model.ggchallengejoao.stg_partners
[0m19:21:42.984838 [debug] [Thread-2  ]: Compiling model.ggchallengejoao.stg_referrals
[0m19:21:42.984970 [debug] [Thread-3  ]: Compiling model.metrics.dbt_metrics_default_calendar
[0m19:21:42.992913 [debug] [Thread-1  ]: Writing injected SQL for node "model.ggchallengejoao.stg_partners"
[0m19:21:42.997434 [debug] [Thread-2  ]: Writing injected SQL for node "model.ggchallengejoao.stg_referrals"
[0m19:21:43.021724 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:21:43.024228 [debug] [Thread-3  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */


        select 

    datetime_diff(
        cast(cast('2030-01-01' as date) as datetime),
        cast(cast('1990-01-01' as date) as datetime),
        day
    )

  
[0m19:21:43.029239 [debug] [Thread-1  ]: finished collecting timing info
[0m19:21:43.029379 [debug] [Thread-2  ]: finished collecting timing info
[0m19:21:43.029477 [debug] [Thread-1  ]: Began executing node model.ggchallengejoao.stg_partners
[0m19:21:43.029583 [debug] [Thread-2  ]: Began executing node model.ggchallengejoao.stg_referrals
[0m19:21:43.047353 [debug] [Thread-2  ]: Writing runtime sql for node "model.ggchallengejoao.stg_referrals"
[0m19:21:43.047722 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m19:21:43.047852 [debug] [Thread-2  ]: On model.ggchallengejoao.stg_referrals: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.stg_referrals"} */


  create or replace view `dynamic-point-367801`.`getgroundjoao`.`stg_referrals`
  OPTIONS()
  as 

select *
except
    (created_at, updated_at),
    
timestamp_micros(cast(created_at/ 1000 as int64))
 as referral_created_at_timestamp,
    
timestamp_micros(cast(updated_at/ 1000 as int64))
 as referral_updated_at_timestamp
from `dynamic-point-367801`.`getgroundjoao`.`referrals`;


[0m19:21:43.051931 [debug] [Thread-1  ]: Writing runtime sql for node "model.ggchallengejoao.stg_partners"
[0m19:21:43.052714 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:21:43.052832 [debug] [Thread-1  ]: On model.ggchallengejoao.stg_partners: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.stg_partners"} */


  create or replace view `dynamic-point-367801`.`getgroundjoao`.`stg_partners`
  OPTIONS()
  as 

select *
except
    (lead_sales_contact, created_at, updated_at),
    if(
        lead_sales_contact = '0', 'No contact', lead_sales_contact
    ) as lead_sales_contact,
    
timestamp_micros(cast(created_at/ 1000 as int64))
 as partner_created_at_timestamp,
    
timestamp_micros(cast(updated_at/ 1000 as int64))
 as partner_updated_at_timestamp
from `dynamic-point-367801`.`getgroundjoao`.`partners`;


[0m19:21:44.142729 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:f4f03ec6-eebc-4a9b-8dd2-6aa9500a9512:EU&page=queryresults
[0m19:21:44.168581 [debug] [Thread-1  ]: finished collecting timing info
[0m19:21:44.169771 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:da504d8a-9c19-470f-b7b4-e58c4d223d69:EU&page=queryresults
[0m19:21:44.170432 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dab0350-05c9-4b23-8715-6b00f176ed9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137ab1100>]}
[0m19:21:44.171712 [debug] [Thread-2  ]: finished collecting timing info
[0m19:21:44.172186 [info ] [Thread-1  ]: 1 of 4 OK created sql view model getgroundjoao.stg_partners .................... [[32mCREATE VIEW (0 processed)[0m in 1.19s]
[0m19:21:44.172731 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dab0350-05c9-4b23-8715-6b00f176ed9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137af7cd0>]}
[0m19:21:44.173244 [debug] [Thread-1  ]: Finished running node model.ggchallengejoao.stg_partners
[0m19:21:44.173542 [info ] [Thread-2  ]: 2 of 4 OK created sql view model getgroundjoao.stg_referrals ................... [[32mCREATE VIEW (0 processed)[0m in 1.19s]
[0m19:21:44.174260 [debug] [Thread-2  ]: Finished running node model.ggchallengejoao.stg_referrals
[0m19:21:44.174653 [debug] [Thread-4  ]: Began running node model.ggchallengejoao.mart_referrals
[0m19:21:44.174920 [info ] [Thread-4  ]: 4 of 4 START sql table model getgroundjoao.mart_referrals ...................... [RUN]
[0m19:21:44.175551 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.ggchallengejoao.mart_referrals"
[0m19:21:44.175725 [debug] [Thread-4  ]: Began compiling node model.ggchallengejoao.mart_referrals
[0m19:21:44.175916 [debug] [Thread-4  ]: Compiling model.ggchallengejoao.mart_referrals
[0m19:21:44.180513 [debug] [Thread-4  ]: Writing injected SQL for node "model.ggchallengejoao.mart_referrals"
[0m19:21:44.181035 [debug] [Thread-4  ]: finished collecting timing info
[0m19:21:44.181183 [debug] [Thread-4  ]: Began executing node model.ggchallengejoao.mart_referrals
[0m19:21:44.192162 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m19:21:44.526200 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:1fadc397-fef8-4c45-80b6-0ca94717e503:EU&page=queryresults
[0m19:21:44.542576 [debug] [Thread-3  ]: Writing injected SQL for node "model.metrics.dbt_metrics_default_calendar"
[0m19:21:44.543353 [debug] [Thread-3  ]: finished collecting timing info
[0m19:21:44.543544 [debug] [Thread-3  ]: Began executing node model.metrics.dbt_metrics_default_calendar
[0m19:21:44.650909 [debug] [Thread-4  ]: Writing runtime sql for node "model.ggchallengejoao.mart_referrals"
[0m19:21:44.651696 [debug] [Thread-4  ]: On model.ggchallengejoao.mart_referrals: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.mart_referrals"} */

  
    

    create or replace table `dynamic-point-367801`.`getgroundjoao`.`mart_referrals`
    
    
    OPTIONS()
    as (
      

select
    r.id as referral_id,
    r.company_id as referral_company,
    r.partner_id as referral_partner,
    r.status as referral_status,
    r.is_outbound as referral_outbound,
    r.referral_created_at_timestamp as referral_record_date,
    r.referral_updated_at_timestamp as referral_updated,
    timestamp_diff(
        referral_updated_at_timestamp, referral_created_at_timestamp, day
    ) as referral_days_from_creation,
    p.partner_type as referral_partner_type,
    p.lead_sales_contact as referral_lead_sales_contact,
    coalesce(d.country, 'No country') as referral_country
from `dynamic-point-367801`.`getgroundjoao`.`stg_referrals` r
left join `dynamic-point-367801`.`getgroundjoao`.`partners` p on r.partner_id = p.id
left join `dynamic-point-367801`.`getgroundjoao`.`sales_people` d on p.lead_sales_contact = d.name
    );
  
[0m19:21:44.858019 [debug] [Thread-3  ]: Writing runtime sql for node "model.metrics.dbt_metrics_default_calendar"
[0m19:21:44.858562 [debug] [Thread-3  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */

  
    

    create or replace table `dynamic-point-367801`.`getgroundjoao`.`dbt_metrics_default_calendar`
    
    
    OPTIONS()
    as (
      

with days as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
     + 
    
    p11.generated_number * power(2, 11)
     + 
    
    p12.generated_number * power(2, 12)
     + 
    
    p13.generated_number * power(2, 13)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
     cross join 
    
    p as p11
     cross join 
    
    p as p12
     cross join 
    
    p as p13
    
    

    )

    select *
    from unioned
    where generated_number <= 14610
    order by generated_number



),

all_periods as (

    select (
        

        datetime_add(
            cast( cast('1990-01-01' as date) as datetime),
        interval row_number() over (order by 1) - 1 day
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2030-01-01' as date)

)

select * from filtered


),

final as (
    select 
        cast(date_day as date) as date_day,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        week
    ) as date) as date_week,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        month
    ) as date) as date_month,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        quarter
    ) as date) as date_quarter,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        year
    ) as date) as date_year
    from days
)

select * from final
    );
  
[0m19:21:47.584027 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:87b334e3-2c4a-4f38-aabe-c7e5d78fb2e2:EU&page=queryresults
[0m19:21:47.595443 [debug] [Thread-4  ]: finished collecting timing info
[0m19:21:47.597003 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dab0350-05c9-4b23-8715-6b00f176ed9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137b2bd60>]}
[0m19:21:47.597989 [info ] [Thread-4  ]: 4 of 4 OK created sql table model getgroundjoao.mart_referrals ................. [[32mCREATE TABLE (1.5k rows, 96.3 KB processed)[0m in 3.42s]
[0m19:21:47.599157 [debug] [Thread-4  ]: Finished running node model.ggchallengejoao.mart_referrals
[0m19:21:47.719532 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:c8041560-8ee3-4c1d-9ad0-f47ef3339b8f:EU&page=queryresults
[0m19:21:47.721959 [debug] [Thread-3  ]: finished collecting timing info
[0m19:21:47.722896 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dab0350-05c9-4b23-8715-6b00f176ed9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137b7bdf0>]}
[0m19:21:47.723350 [info ] [Thread-3  ]: 3 of 4 OK created sql table model getgroundjoao.dbt_metrics_default_calendar ... [[32mCREATE TABLE (14.6k rows, 0 processed)[0m in 4.74s]
[0m19:21:47.723809 [debug] [Thread-3  ]: Finished running node model.metrics.dbt_metrics_default_calendar
[0m19:21:47.726155 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m19:21:47.726926 [info ] [MainThread]: 
[0m19:21:47.727261 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 6.80 seconds (6.80s).
[0m19:21:47.727557 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:21:47.727697 [debug] [MainThread]: Connection 'model.ggchallengejoao.stg_partners' was properly closed.
[0m19:21:47.727825 [debug] [MainThread]: Connection 'model.ggchallengejoao.stg_referrals' was properly closed.
[0m19:21:47.728006 [debug] [MainThread]: Connection 'model.metrics.dbt_metrics_default_calendar' was properly closed.
[0m19:21:47.728183 [debug] [MainThread]: Connection 'model.ggchallengejoao.mart_referrals' was properly closed.
[0m19:21:47.742336 [info ] [MainThread]: 
[0m19:21:47.742699 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:21:47.742981 [info ] [MainThread]: 
[0m19:21:47.743232 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m19:21:47.743629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13798d310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13796a8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137b5dfa0>]}
[0m19:21:47.743876 [debug] [MainThread]: Flushing usage events


============================== 2023-01-06 19:34:00.561002 | 7b2e2d13-a1cf-4734-b168-fde599ca0c5a ==============================
[0m19:34:00.561028 [info ] [MainThread]: Running with dbt=1.3.2
[0m19:34:00.561876 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joaopaulomedeiroscecilio/dev/dbt-data-analysis', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m19:34:00.561978 [debug] [MainThread]: Tracking: tracking
[0m19:34:00.580503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f17aee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f190040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f190070>]}
[0m19:34:00.668049 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:34:00.668214 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:34:00.668509 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ggchallengejoao.example

[0m19:34:00.672493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b2e2d13-a1cf-4734-b168-fde599ca0c5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f52ad90>]}
[0m19:34:00.680770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b2e2d13-a1cf-4734-b168-fde599ca0c5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f3c1c40>]}
[0m19:34:00.681003 [info ] [MainThread]: Found 4 models, 6 tests, 0 snapshots, 0 analyses, 533 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 2 metrics
[0m19:34:00.681163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b2e2d13-a1cf-4734-b168-fde599ca0c5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f3c1b20>]}
[0m19:34:00.682236 [info ] [MainThread]: 
[0m19:34:00.682695 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m19:34:00.683839 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801_getgroundjoao"
[0m19:34:00.684175 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:34:02.718081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b2e2d13-a1cf-4734-b168-fde599ca0c5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f4eab50>]}
[0m19:34:02.718898 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:34:02.719115 [info ] [MainThread]: 
[0m19:34:02.724366 [debug] [Thread-1  ]: Began running node model.metrics.dbt_metrics_default_calendar
[0m19:34:02.724481 [debug] [Thread-2  ]: Began running node seed.ggchallengejoao.partners
[0m19:34:02.724572 [debug] [Thread-3  ]: Began running node seed.ggchallengejoao.referrals
[0m19:34:02.724645 [debug] [Thread-4  ]: Began running node seed.ggchallengejoao.sales_people
[0m19:34:02.725031 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.metrics.dbt_metrics_default_calendar"
[0m19:34:02.725304 [debug] [Thread-2  ]: Acquiring new bigquery connection "seed.ggchallengejoao.partners"
[0m19:34:02.725607 [debug] [Thread-3  ]: Acquiring new bigquery connection "seed.ggchallengejoao.referrals"
[0m19:34:02.725864 [debug] [Thread-4  ]: Acquiring new bigquery connection "seed.ggchallengejoao.sales_people"
[0m19:34:02.725989 [debug] [Thread-1  ]: Began compiling node model.metrics.dbt_metrics_default_calendar
[0m19:34:02.726076 [debug] [Thread-2  ]: Began compiling node seed.ggchallengejoao.partners
[0m19:34:02.726157 [debug] [Thread-3  ]: Began compiling node seed.ggchallengejoao.referrals
[0m19:34:02.726233 [debug] [Thread-4  ]: Began compiling node seed.ggchallengejoao.sales_people
[0m19:34:02.726412 [debug] [Thread-1  ]: Compiling model.metrics.dbt_metrics_default_calendar
[0m19:34:02.726487 [debug] [Thread-2  ]: Compiling seed.ggchallengejoao.partners
[0m19:34:02.726602 [debug] [Thread-3  ]: Compiling seed.ggchallengejoao.referrals
[0m19:34:02.726765 [debug] [Thread-4  ]: Compiling seed.ggchallengejoao.sales_people
[0m19:34:02.743270 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:34:02.746111 [debug] [Thread-2  ]: Writing injected SQL for node "seed.ggchallengejoao.partners"
[0m19:34:02.747352 [debug] [Thread-3  ]: Writing injected SQL for node "seed.ggchallengejoao.referrals"
[0m19:34:02.750401 [debug] [Thread-1  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */


        select 

    datetime_diff(
        cast(cast('2030-01-01' as date) as datetime),
        cast(cast('1990-01-01' as date) as datetime),
        day
    )

  
[0m19:34:02.757696 [debug] [Thread-2  ]: finished collecting timing info
[0m19:34:02.758939 [debug] [Thread-3  ]: finished collecting timing info
[0m19:34:02.762305 [debug] [Thread-2  ]: Began executing node seed.ggchallengejoao.partners
[0m19:34:02.763542 [debug] [Thread-4  ]: Writing injected SQL for node "seed.ggchallengejoao.sales_people"
[0m19:34:02.764224 [debug] [Thread-3  ]: Began executing node seed.ggchallengejoao.referrals
[0m19:34:02.764379 [debug] [Thread-2  ]: finished collecting timing info
[0m19:34:02.764595 [debug] [Thread-4  ]: finished collecting timing info
[0m19:34:02.764696 [debug] [Thread-3  ]: finished collecting timing info
[0m19:34:02.765128 [debug] [Thread-2  ]: Finished running node seed.ggchallengejoao.partners
[0m19:34:02.765344 [debug] [Thread-4  ]: Began executing node seed.ggchallengejoao.sales_people
[0m19:34:02.765668 [debug] [Thread-3  ]: Finished running node seed.ggchallengejoao.referrals
[0m19:34:02.766345 [debug] [Thread-2  ]: Began running node model.ggchallengejoao.stg_partners
[0m19:34:02.766592 [debug] [Thread-4  ]: finished collecting timing info
[0m19:34:02.767387 [debug] [Thread-3  ]: Began running node model.ggchallengejoao.stg_referrals
[0m19:34:02.768543 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_partners"
[0m19:34:02.771621 [debug] [Thread-4  ]: Finished running node seed.ggchallengejoao.sales_people
[0m19:34:02.771926 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_referrals"
[0m19:34:02.772032 [debug] [Thread-2  ]: Began compiling node model.ggchallengejoao.stg_partners
[0m19:34:02.772186 [debug] [Thread-3  ]: Began compiling node model.ggchallengejoao.stg_referrals
[0m19:34:02.772273 [debug] [Thread-2  ]: Compiling model.ggchallengejoao.stg_partners
[0m19:34:02.772352 [debug] [Thread-3  ]: Compiling model.ggchallengejoao.stg_referrals
[0m19:34:02.775359 [debug] [Thread-2  ]: Writing injected SQL for node "model.ggchallengejoao.stg_partners"
[0m19:34:02.777784 [debug] [Thread-3  ]: Writing injected SQL for node "model.ggchallengejoao.stg_referrals"
[0m19:34:02.779013 [debug] [Thread-2  ]: finished collecting timing info
[0m19:34:02.779178 [debug] [Thread-2  ]: Began executing node model.ggchallengejoao.stg_partners
[0m19:34:02.779252 [debug] [Thread-3  ]: finished collecting timing info
[0m19:34:02.779342 [debug] [Thread-2  ]: finished collecting timing info
[0m19:34:02.779427 [debug] [Thread-3  ]: Began executing node model.ggchallengejoao.stg_referrals
[0m19:34:02.779822 [debug] [Thread-2  ]: Finished running node model.ggchallengejoao.stg_partners
[0m19:34:02.779913 [debug] [Thread-3  ]: finished collecting timing info
[0m19:34:02.780360 [debug] [Thread-3  ]: Finished running node model.ggchallengejoao.stg_referrals
[0m19:34:02.780481 [debug] [Thread-4  ]: Began running node test.ggchallengejoao.not_null_stg_partners_id.625c7b2674
[0m19:34:02.780560 [debug] [Thread-3  ]: Began running node test.ggchallengejoao.unique_stg_partners_id.8b2ef7f041
[0m19:34:02.780756 [debug] [Thread-2  ]: Began running node model.ggchallengejoao.mart_referrals
[0m19:34:02.781007 [debug] [Thread-4  ]: Acquiring new bigquery connection "test.ggchallengejoao.not_null_stg_partners_id.625c7b2674"
[0m19:34:02.781247 [debug] [Thread-3  ]: Acquiring new bigquery connection "test.ggchallengejoao.unique_stg_partners_id.8b2ef7f041"
[0m19:34:02.781486 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.ggchallengejoao.mart_referrals"
[0m19:34:02.781573 [debug] [Thread-4  ]: Began compiling node test.ggchallengejoao.not_null_stg_partners_id.625c7b2674
[0m19:34:02.781654 [debug] [Thread-3  ]: Began compiling node test.ggchallengejoao.unique_stg_partners_id.8b2ef7f041
[0m19:34:02.781729 [debug] [Thread-2  ]: Began compiling node model.ggchallengejoao.mart_referrals
[0m19:34:02.781809 [debug] [Thread-4  ]: Compiling test.ggchallengejoao.not_null_stg_partners_id.625c7b2674
[0m19:34:02.781882 [debug] [Thread-3  ]: Compiling test.ggchallengejoao.unique_stg_partners_id.8b2ef7f041
[0m19:34:02.781953 [debug] [Thread-2  ]: Compiling model.ggchallengejoao.mart_referrals
[0m19:34:02.789379 [debug] [Thread-4  ]: Writing injected SQL for node "test.ggchallengejoao.not_null_stg_partners_id.625c7b2674"
[0m19:34:02.793427 [debug] [Thread-3  ]: Writing injected SQL for node "test.ggchallengejoao.unique_stg_partners_id.8b2ef7f041"
[0m19:34:02.796407 [debug] [Thread-2  ]: Writing injected SQL for node "model.ggchallengejoao.mart_referrals"
[0m19:34:02.797447 [debug] [Thread-3  ]: finished collecting timing info
[0m19:34:02.797523 [debug] [Thread-2  ]: finished collecting timing info
[0m19:34:02.797587 [debug] [Thread-4  ]: finished collecting timing info
[0m19:34:02.797676 [debug] [Thread-3  ]: Began executing node test.ggchallengejoao.unique_stg_partners_id.8b2ef7f041
[0m19:34:02.797774 [debug] [Thread-2  ]: Began executing node model.ggchallengejoao.mart_referrals
[0m19:34:02.797866 [debug] [Thread-4  ]: Began executing node test.ggchallengejoao.not_null_stg_partners_id.625c7b2674
[0m19:34:02.797954 [debug] [Thread-3  ]: finished collecting timing info
[0m19:34:02.798033 [debug] [Thread-2  ]: finished collecting timing info
[0m19:34:02.798111 [debug] [Thread-4  ]: finished collecting timing info
[0m19:34:02.798427 [debug] [Thread-3  ]: Finished running node test.ggchallengejoao.unique_stg_partners_id.8b2ef7f041
[0m19:34:02.798723 [debug] [Thread-2  ]: Finished running node model.ggchallengejoao.mart_referrals
[0m19:34:02.799023 [debug] [Thread-4  ]: Finished running node test.ggchallengejoao.not_null_stg_partners_id.625c7b2674
[0m19:34:02.799130 [debug] [Thread-3  ]: Began running node test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f
[0m19:34:02.799253 [debug] [Thread-2  ]: Began running node test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53
[0m19:34:02.799362 [debug] [Thread-4  ]: Began running node test.ggchallengejoao.not_null_stg_referrals_id.f511791502
[0m19:34:02.799603 [debug] [Thread-3  ]: Acquiring new bigquery connection "test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f"
[0m19:34:02.799831 [debug] [Thread-2  ]: Acquiring new bigquery connection "test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53"
[0m19:34:02.800046 [debug] [Thread-4  ]: Acquiring new bigquery connection "test.ggchallengejoao.not_null_stg_referrals_id.f511791502"
[0m19:34:02.800125 [debug] [Thread-3  ]: Began compiling node test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f
[0m19:34:02.800201 [debug] [Thread-2  ]: Began compiling node test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53
[0m19:34:02.800273 [debug] [Thread-4  ]: Began compiling node test.ggchallengejoao.not_null_stg_referrals_id.f511791502
[0m19:34:02.800349 [debug] [Thread-3  ]: Compiling test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f
[0m19:34:02.800420 [debug] [Thread-2  ]: Compiling test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53
[0m19:34:02.800490 [debug] [Thread-4  ]: Compiling test.ggchallengejoao.not_null_stg_referrals_id.f511791502
[0m19:34:02.805024 [debug] [Thread-3  ]: Writing injected SQL for node "test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f"
[0m19:34:02.808494 [debug] [Thread-2  ]: Writing injected SQL for node "test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53"
[0m19:34:02.810970 [debug] [Thread-4  ]: Writing injected SQL for node "test.ggchallengejoao.not_null_stg_referrals_id.f511791502"
[0m19:34:02.811603 [debug] [Thread-3  ]: finished collecting timing info
[0m19:34:02.811703 [debug] [Thread-3  ]: Began executing node test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f
[0m19:34:02.811786 [debug] [Thread-3  ]: finished collecting timing info
[0m19:34:02.812086 [debug] [Thread-3  ]: Finished running node test.ggchallengejoao.accepted_values_stg_referrals_is_outbound__False__0__1.050111bc6f
[0m19:34:02.812181 [debug] [Thread-4  ]: finished collecting timing info
[0m19:34:02.812279 [debug] [Thread-3  ]: Began running node test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f
[0m19:34:02.812406 [debug] [Thread-4  ]: Began executing node test.ggchallengejoao.not_null_stg_referrals_id.f511791502
[0m19:34:02.812465 [debug] [Thread-2  ]: finished collecting timing info
[0m19:34:02.812706 [debug] [Thread-3  ]: Acquiring new bigquery connection "test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f"
[0m19:34:02.812791 [debug] [Thread-4  ]: finished collecting timing info
[0m19:34:02.812869 [debug] [Thread-2  ]: Began executing node test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53
[0m19:34:02.812947 [debug] [Thread-3  ]: Began compiling node test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f
[0m19:34:02.813208 [debug] [Thread-4  ]: Finished running node test.ggchallengejoao.not_null_stg_referrals_id.f511791502
[0m19:34:02.813285 [debug] [Thread-2  ]: finished collecting timing info
[0m19:34:02.813360 [debug] [Thread-3  ]: Compiling test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f
[0m19:34:02.813662 [debug] [Thread-2  ]: Finished running node test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53
[0m19:34:02.816046 [debug] [Thread-3  ]: Writing injected SQL for node "test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f"
[0m19:34:02.816391 [debug] [Thread-3  ]: finished collecting timing info
[0m19:34:02.816478 [debug] [Thread-3  ]: Began executing node test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f
[0m19:34:02.816561 [debug] [Thread-3  ]: finished collecting timing info
[0m19:34:02.816823 [debug] [Thread-3  ]: Finished running node test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f
[0m19:34:04.618140 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:ee24271d-1e6b-4b15-8c54-7426a02beda1:EU&page=queryresults
[0m19:34:04.645489 [debug] [Thread-1  ]: Writing injected SQL for node "model.metrics.dbt_metrics_default_calendar"
[0m19:34:04.646780 [debug] [Thread-1  ]: finished collecting timing info
[0m19:34:04.647134 [debug] [Thread-1  ]: Began executing node model.metrics.dbt_metrics_default_calendar
[0m19:34:04.647447 [debug] [Thread-1  ]: finished collecting timing info
[0m19:34:04.648574 [debug] [Thread-1  ]: Finished running node model.metrics.dbt_metrics_default_calendar
[0m19:34:04.650211 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:34:04.650388 [debug] [MainThread]: Connection 'model.metrics.dbt_metrics_default_calendar' was properly closed.
[0m19:34:04.650526 [debug] [MainThread]: Connection 'test.ggchallengejoao.accepted_values_stg_referrals_status__disinterested__pending__successful.613dd29c53' was properly closed.
[0m19:34:04.650655 [debug] [MainThread]: Connection 'test.ggchallengejoao.unique_stg_referrals_id.3a83fe0e6f' was properly closed.
[0m19:34:04.650778 [debug] [MainThread]: Connection 'test.ggchallengejoao.not_null_stg_referrals_id.f511791502' was properly closed.
[0m19:34:04.666676 [info ] [MainThread]: Done.
[0m19:34:04.667274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f5f37f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f5f3b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f5f34f0>]}
[0m19:34:04.667628 [debug] [MainThread]: Flushing usage events


============================== 2023-01-06 19:34:35.082373 | d8b65250-aaea-43ef-91f8-856363fc6b94 ==============================
[0m19:34:35.082390 [info ] [MainThread]: Running with dbt=1.3.2
[0m19:34:35.082962 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joaopaulomedeiroscecilio/dev/dbt-data-analysis', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:34:35.083102 [debug] [MainThread]: Tracking: tracking
[0m19:34:35.094939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137cfaf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137d14160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137d14100>]}
[0m19:34:35.167083 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:34:35.167397 [debug] [MainThread]: Partial parsing: updated file: ggchallengejoao://models/marts/mart_referrals.sql
[0m19:34:35.177186 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_referrals.sql
[0m19:34:35.199787 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ggchallengejoao.example

[0m19:34:35.203444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd8b65250-aaea-43ef-91f8-856363fc6b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139a270d0>]}
[0m19:34:35.217700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd8b65250-aaea-43ef-91f8-856363fc6b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1398b4310>]}
[0m19:34:35.217950 [info ] [MainThread]: Found 4 models, 6 tests, 0 snapshots, 0 analyses, 533 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 2 metrics
[0m19:34:35.218103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8b65250-aaea-43ef-91f8-856363fc6b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10441b160>]}
[0m19:34:35.219017 [info ] [MainThread]: 
[0m19:34:35.219441 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m19:34:35.220060 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801"
[0m19:34:35.220247 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:34:36.827114 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801_getgroundjoao"
[0m19:34:36.827861 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:34:37.259780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8b65250-aaea-43ef-91f8-856363fc6b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1398b41c0>]}
[0m19:34:37.261443 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:34:37.261928 [info ] [MainThread]: 
[0m19:34:37.271053 [debug] [Thread-1  ]: Began running node model.ggchallengejoao.stg_partners
[0m19:34:37.271228 [debug] [Thread-2  ]: Began running node model.ggchallengejoao.stg_referrals
[0m19:34:37.271361 [debug] [Thread-3  ]: Began running node model.metrics.dbt_metrics_default_calendar
[0m19:34:37.271654 [info ] [Thread-1  ]: 1 of 4 START sql view model getgroundjoao.stg_partners ......................... [RUN]
[0m19:34:37.271896 [info ] [Thread-2  ]: 2 of 4 START sql view model getgroundjoao.stg_referrals ........................ [RUN]
[0m19:34:37.272106 [info ] [Thread-3  ]: 3 of 4 START sql table model getgroundjoao.dbt_metrics_default_calendar ........ [RUN]
[0m19:34:37.272764 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_partners"
[0m19:34:37.273345 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_referrals"
[0m19:34:37.274763 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.metrics.dbt_metrics_default_calendar"
[0m19:34:37.274978 [debug] [Thread-1  ]: Began compiling node model.ggchallengejoao.stg_partners
[0m19:34:37.275149 [debug] [Thread-2  ]: Began compiling node model.ggchallengejoao.stg_referrals
[0m19:34:37.275289 [debug] [Thread-3  ]: Began compiling node model.metrics.dbt_metrics_default_calendar
[0m19:34:37.275538 [debug] [Thread-1  ]: Compiling model.ggchallengejoao.stg_partners
[0m19:34:37.275672 [debug] [Thread-2  ]: Compiling model.ggchallengejoao.stg_referrals
[0m19:34:37.275801 [debug] [Thread-3  ]: Compiling model.metrics.dbt_metrics_default_calendar
[0m19:34:37.282145 [debug] [Thread-1  ]: Writing injected SQL for node "model.ggchallengejoao.stg_partners"
[0m19:34:37.286092 [debug] [Thread-2  ]: Writing injected SQL for node "model.ggchallengejoao.stg_referrals"
[0m19:34:37.312031 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:34:37.314661 [debug] [Thread-3  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */


        select 

    datetime_diff(
        cast(cast('2030-01-01' as date) as datetime),
        cast(cast('1990-01-01' as date) as datetime),
        day
    )

  
[0m19:34:37.315725 [debug] [Thread-1  ]: finished collecting timing info
[0m19:34:37.320380 [debug] [Thread-2  ]: finished collecting timing info
[0m19:34:37.321231 [debug] [Thread-1  ]: Began executing node model.ggchallengejoao.stg_partners
[0m19:34:37.322230 [debug] [Thread-2  ]: Began executing node model.ggchallengejoao.stg_referrals
[0m19:34:37.343443 [debug] [Thread-1  ]: Writing runtime sql for node "model.ggchallengejoao.stg_partners"
[0m19:34:37.345557 [debug] [Thread-2  ]: Writing runtime sql for node "model.ggchallengejoao.stg_referrals"
[0m19:34:37.346093 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m19:34:37.346185 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:34:37.346312 [debug] [Thread-2  ]: On model.ggchallengejoao.stg_referrals: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.stg_referrals"} */


  create or replace view `dynamic-point-367801`.`getgroundjoao`.`stg_referrals`
  OPTIONS()
  as 

select *
except
    (created_at, updated_at),
    
timestamp_micros(cast(created_at/ 1000 as int64))
 as referral_created_at_timestamp,
    
timestamp_micros(cast(updated_at/ 1000 as int64))
 as referral_updated_at_timestamp
from `dynamic-point-367801`.`getgroundjoao`.`referrals`;


[0m19:34:37.346416 [debug] [Thread-1  ]: On model.ggchallengejoao.stg_partners: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.stg_partners"} */


  create or replace view `dynamic-point-367801`.`getgroundjoao`.`stg_partners`
  OPTIONS()
  as 

select *
except
    (lead_sales_contact, created_at, updated_at),
    if(
        lead_sales_contact = '0', 'No contact', lead_sales_contact
    ) as lead_sales_contact,
    
timestamp_micros(cast(created_at/ 1000 as int64))
 as partner_created_at_timestamp,
    
timestamp_micros(cast(updated_at/ 1000 as int64))
 as partner_updated_at_timestamp
from `dynamic-point-367801`.`getgroundjoao`.`partners`;


[0m19:34:38.441567 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:80505d97-79d6-49b1-91af-1fbaf8ef9a40:EU&page=queryresults
[0m19:34:38.466889 [debug] [Thread-2  ]: finished collecting timing info
[0m19:34:38.468638 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8b65250-aaea-43ef-91f8-856363fc6b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139b32bb0>]}
[0m19:34:38.469745 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:4200f5ce-3248-48b9-b387-f35345bae84d:EU&page=queryresults
[0m19:34:38.470264 [info ] [Thread-2  ]: 2 of 4 OK created sql view model getgroundjoao.stg_referrals ................... [[32mCREATE VIEW (0 processed)[0m in 1.20s]
[0m19:34:38.471657 [debug] [Thread-1  ]: finished collecting timing info
[0m19:34:38.472184 [debug] [Thread-2  ]: Finished running node model.ggchallengejoao.stg_referrals
[0m19:34:38.472810 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8b65250-aaea-43ef-91f8-856363fc6b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139a66f40>]}
[0m19:34:38.473360 [debug] [Thread-4  ]: Began running node model.ggchallengejoao.mart_referrals
[0m19:34:38.473668 [info ] [Thread-1  ]: 1 of 4 OK created sql view model getgroundjoao.stg_partners .................... [[32mCREATE VIEW (0 processed)[0m in 1.20s]
[0m19:34:38.473914 [info ] [Thread-4  ]: 4 of 4 START sql table model getgroundjoao.mart_referrals ...................... [RUN]
[0m19:34:38.474287 [debug] [Thread-1  ]: Finished running node model.ggchallengejoao.stg_partners
[0m19:34:38.474926 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.ggchallengejoao.mart_referrals"
[0m19:34:38.475245 [debug] [Thread-4  ]: Began compiling node model.ggchallengejoao.mart_referrals
[0m19:34:38.475427 [debug] [Thread-4  ]: Compiling model.ggchallengejoao.mart_referrals
[0m19:34:38.480066 [debug] [Thread-4  ]: Writing injected SQL for node "model.ggchallengejoao.mart_referrals"
[0m19:34:38.480709 [debug] [Thread-4  ]: finished collecting timing info
[0m19:34:38.480871 [debug] [Thread-4  ]: Began executing node model.ggchallengejoao.mart_referrals
[0m19:34:38.492133 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m19:34:38.949792 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:f2778fcb-683b-4829-a349-28842e48acba:EU&page=queryresults
[0m19:34:38.979747 [debug] [Thread-4  ]: Writing runtime sql for node "model.ggchallengejoao.mart_referrals"
[0m19:34:38.990420 [debug] [Thread-3  ]: Writing injected SQL for node "model.metrics.dbt_metrics_default_calendar"
[0m19:34:38.991033 [debug] [Thread-4  ]: On model.ggchallengejoao.mart_referrals: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.mart_referrals"} */

  
    

    create or replace table `dynamic-point-367801`.`getgroundjoao`.`mart_referrals`
    
    
    OPTIONS()
    as (
      

select
    r.id as referral_id,
    r.company_id as referral_company,
    r.partner_id as referral_partner,
    r.status as referral_status,
    r.is_outbound as referral_outbound,
    r.referral_created_at_timestamp as referral_record_date,
    r.referral_updated_at_timestamp as referral_updated,
    nullif(
        timestamp_diff(
            referral_updated_at_timestamp, referral_created_at_timestamp, day
        ),
        0
    ) as referral_days_from_creation,
    p.partner_type as referral_partner_type,
    p.lead_sales_contact as referral_lead_sales_contact,
    coalesce(d.country, 'No country') as referral_country
from `dynamic-point-367801`.`getgroundjoao`.`stg_referrals` r
left join `dynamic-point-367801`.`getgroundjoao`.`partners` p on r.partner_id = p.id
left join `dynamic-point-367801`.`getgroundjoao`.`sales_people` d on p.lead_sales_contact = d.name
    );
  
[0m19:34:38.991196 [debug] [Thread-3  ]: finished collecting timing info
[0m19:34:38.992667 [debug] [Thread-3  ]: Began executing node model.metrics.dbt_metrics_default_calendar
[0m19:34:39.308425 [debug] [Thread-3  ]: Writing runtime sql for node "model.metrics.dbt_metrics_default_calendar"
[0m19:34:39.309458 [debug] [Thread-3  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */

  
    

    create or replace table `dynamic-point-367801`.`getgroundjoao`.`dbt_metrics_default_calendar`
    
    
    OPTIONS()
    as (
      

with days as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
     + 
    
    p11.generated_number * power(2, 11)
     + 
    
    p12.generated_number * power(2, 12)
     + 
    
    p13.generated_number * power(2, 13)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
     cross join 
    
    p as p11
     cross join 
    
    p as p12
     cross join 
    
    p as p13
    
    

    )

    select *
    from unioned
    where generated_number <= 14610
    order by generated_number



),

all_periods as (

    select (
        

        datetime_add(
            cast( cast('1990-01-01' as date) as datetime),
        interval row_number() over (order by 1) - 1 day
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2030-01-01' as date)

)

select * from filtered


),

final as (
    select 
        cast(date_day as date) as date_day,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        week
    ) as date) as date_week,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        month
    ) as date) as date_month,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        quarter
    ) as date) as date_quarter,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        year
    ) as date) as date_year
    from days
)

select * from final
    );
  
[0m19:34:42.025697 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:391348d3-20eb-4dbc-9139-e6608217239a:EU&page=queryresults
[0m19:34:42.032360 [debug] [Thread-4  ]: finished collecting timing info
[0m19:34:42.034417 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8b65250-aaea-43ef-91f8-856363fc6b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139b2fca0>]}
[0m19:34:42.035384 [info ] [Thread-4  ]: 4 of 4 OK created sql table model getgroundjoao.mart_referrals ................. [[32mCREATE TABLE (1.5k rows, 96.3 KB processed)[0m in 3.56s]
[0m19:34:42.036665 [debug] [Thread-4  ]: Finished running node model.ggchallengejoao.mart_referrals
[0m19:34:42.528687 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:9865ca77-8d47-4070-80b8-e97c7de95dd2:EU&page=queryresults
[0m19:34:42.531433 [debug] [Thread-3  ]: finished collecting timing info
[0m19:34:42.532716 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8b65250-aaea-43ef-91f8-856363fc6b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139bde550>]}
[0m19:34:42.533432 [info ] [Thread-3  ]: 3 of 4 OK created sql table model getgroundjoao.dbt_metrics_default_calendar ... [[32mCREATE TABLE (14.6k rows, 0 processed)[0m in 5.26s]
[0m19:34:42.534067 [debug] [Thread-3  ]: Finished running node model.metrics.dbt_metrics_default_calendar
[0m19:34:42.536833 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m19:34:42.537706 [info ] [MainThread]: 
[0m19:34:42.538078 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 7.32 seconds (7.32s).
[0m19:34:42.538392 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:34:42.538548 [debug] [MainThread]: Connection 'model.ggchallengejoao.stg_partners' was properly closed.
[0m19:34:42.538692 [debug] [MainThread]: Connection 'model.ggchallengejoao.stg_referrals' was properly closed.
[0m19:34:42.538833 [debug] [MainThread]: Connection 'model.metrics.dbt_metrics_default_calendar' was properly closed.
[0m19:34:42.538970 [debug] [MainThread]: Connection 'model.ggchallengejoao.mart_referrals' was properly closed.
[0m19:34:42.557787 [info ] [MainThread]: 
[0m19:34:42.558248 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:34:42.558617 [info ] [MainThread]: 
[0m19:34:42.558908 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m19:34:42.559363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1398b4040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137d29160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139a38bb0>]}
[0m19:34:42.559650 [debug] [MainThread]: Flushing usage events


============================== 2023-01-06 19:51:55.430797 | aaa9d970-f8b8-4570-b0b6-2cbb449501e5 ==============================
[0m19:51:55.430814 [info ] [MainThread]: Running with dbt=1.3.2
[0m19:51:55.431384 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joaopaulomedeiroscecilio/dev/dbt-data-analysis', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:51:55.431486 [debug] [MainThread]: Tracking: tracking
[0m19:51:55.447692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11793af10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117954130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1179540d0>]}
[0m19:51:55.530519 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:51:55.530895 [debug] [MainThread]: Partial parsing: updated file: ggchallengejoao://models/marts/mart_referrals.sql
[0m19:51:55.541916 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_referrals.sql
[0m19:51:55.564022 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ggchallengejoao.example

[0m19:51:55.567380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aaa9d970-f8b8-4570-b0b6-2cbb449501e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117c670d0>]}
[0m19:51:55.574445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aaa9d970-f8b8-4570-b0b6-2cbb449501e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102986610>]}
[0m19:51:55.574673 [info ] [MainThread]: Found 4 models, 6 tests, 0 snapshots, 0 analyses, 533 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 2 metrics
[0m19:51:55.574820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aaa9d970-f8b8-4570-b0b6-2cbb449501e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117b747c0>]}
[0m19:51:55.575737 [info ] [MainThread]: 
[0m19:51:55.576134 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m19:51:55.576694 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801"
[0m19:51:55.576843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:51:57.591292 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801_getgroundjoao"
[0m19:51:57.591869 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:51:58.035639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aaa9d970-f8b8-4570-b0b6-2cbb449501e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117af51c0>]}
[0m19:51:58.037812 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:51:58.038568 [info ] [MainThread]: 
[0m19:51:58.052263 [debug] [Thread-1  ]: Began running node model.ggchallengejoao.stg_partners
[0m19:51:58.052534 [debug] [Thread-2  ]: Began running node model.ggchallengejoao.stg_referrals
[0m19:51:58.052721 [debug] [Thread-3  ]: Began running node model.metrics.dbt_metrics_default_calendar
[0m19:51:58.053206 [info ] [Thread-1  ]: 1 of 4 START sql view model getgroundjoao.stg_partners ......................... [RUN]
[0m19:51:58.053599 [info ] [Thread-2  ]: 2 of 4 START sql view model getgroundjoao.stg_referrals ........................ [RUN]
[0m19:51:58.053955 [info ] [Thread-3  ]: 3 of 4 START sql table model getgroundjoao.dbt_metrics_default_calendar ........ [RUN]
[0m19:51:58.054876 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_partners"
[0m19:51:58.055612 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_referrals"
[0m19:51:58.058195 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.metrics.dbt_metrics_default_calendar"
[0m19:51:58.058553 [debug] [Thread-1  ]: Began compiling node model.ggchallengejoao.stg_partners
[0m19:51:58.058815 [debug] [Thread-2  ]: Began compiling node model.ggchallengejoao.stg_referrals
[0m19:51:58.059069 [debug] [Thread-3  ]: Began compiling node model.metrics.dbt_metrics_default_calendar
[0m19:51:58.059483 [debug] [Thread-1  ]: Compiling model.ggchallengejoao.stg_partners
[0m19:51:58.059688 [debug] [Thread-2  ]: Compiling model.ggchallengejoao.stg_referrals
[0m19:51:58.059886 [debug] [Thread-3  ]: Compiling model.metrics.dbt_metrics_default_calendar
[0m19:51:58.067404 [debug] [Thread-1  ]: Writing injected SQL for node "model.ggchallengejoao.stg_partners"
[0m19:51:58.072374 [debug] [Thread-2  ]: Writing injected SQL for node "model.ggchallengejoao.stg_referrals"
[0m19:51:58.097454 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:51:58.097854 [debug] [Thread-3  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */


        select 

    datetime_diff(
        cast(cast('2030-01-01' as date) as datetime),
        cast(cast('1990-01-01' as date) as datetime),
        day
    )

  
[0m19:51:58.098087 [debug] [Thread-1  ]: finished collecting timing info
[0m19:51:58.099298 [debug] [Thread-1  ]: Began executing node model.ggchallengejoao.stg_partners
[0m19:51:58.099860 [debug] [Thread-2  ]: finished collecting timing info
[0m19:51:58.118752 [debug] [Thread-1  ]: Writing runtime sql for node "model.ggchallengejoao.stg_partners"
[0m19:51:58.119009 [debug] [Thread-2  ]: Began executing node model.ggchallengejoao.stg_referrals
[0m19:51:58.121585 [debug] [Thread-2  ]: Writing runtime sql for node "model.ggchallengejoao.stg_referrals"
[0m19:51:58.121828 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:51:58.121992 [debug] [Thread-1  ]: On model.ggchallengejoao.stg_partners: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.stg_partners"} */


  create or replace view `dynamic-point-367801`.`getgroundjoao`.`stg_partners`
  OPTIONS()
  as 

select *
except
    (lead_sales_contact, created_at, updated_at),
    if(
        lead_sales_contact = '0', 'No contact', lead_sales_contact
    ) as lead_sales_contact,
    
timestamp_micros(cast(created_at/ 1000 as int64))
 as partner_created_at_timestamp,
    
timestamp_micros(cast(updated_at/ 1000 as int64))
 as partner_updated_at_timestamp
from `dynamic-point-367801`.`getgroundjoao`.`partners`;


[0m19:51:58.122088 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m19:51:58.122512 [debug] [Thread-2  ]: On model.ggchallengejoao.stg_referrals: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.stg_referrals"} */


  create or replace view `dynamic-point-367801`.`getgroundjoao`.`stg_referrals`
  OPTIONS()
  as 

select *
except
    (created_at, updated_at),
    
timestamp_micros(cast(created_at/ 1000 as int64))
 as referral_created_at_timestamp,
    
timestamp_micros(cast(updated_at/ 1000 as int64))
 as referral_updated_at_timestamp
from `dynamic-point-367801`.`getgroundjoao`.`referrals`;


[0m19:51:59.229034 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:b2447e4e-1e02-4deb-b4c5-0d8377197234:EU&page=queryresults
[0m19:51:59.259118 [debug] [Thread-1  ]: finished collecting timing info
[0m19:51:59.260375 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:3be13fe5-0dbc-4279-8f2e-89d599f6b695:EU&page=queryresults
[0m19:51:59.261517 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaa9d970-f8b8-4570-b0b6-2cbb449501e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117ca5f10>]}
[0m19:51:59.262858 [debug] [Thread-2  ]: finished collecting timing info
[0m19:51:59.263567 [info ] [Thread-1  ]: 1 of 4 OK created sql view model getgroundjoao.stg_partners .................... [[32mCREATE VIEW (0 processed)[0m in 1.21s]
[0m19:51:59.264155 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaa9d970-f8b8-4570-b0b6-2cbb449501e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117d74cd0>]}
[0m19:51:59.265111 [debug] [Thread-1  ]: Finished running node model.ggchallengejoao.stg_partners
[0m19:51:59.265528 [info ] [Thread-2  ]: 2 of 4 OK created sql view model getgroundjoao.stg_referrals ................... [[32mCREATE VIEW (0 processed)[0m in 1.21s]
[0m19:51:59.266519 [debug] [Thread-2  ]: Finished running node model.ggchallengejoao.stg_referrals
[0m19:51:59.267029 [debug] [Thread-4  ]: Began running node model.ggchallengejoao.mart_referrals
[0m19:51:59.267351 [info ] [Thread-4  ]: 4 of 4 START sql table model getgroundjoao.mart_referrals ...................... [RUN]
[0m19:51:59.268062 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.ggchallengejoao.mart_referrals"
[0m19:51:59.268240 [debug] [Thread-4  ]: Began compiling node model.ggchallengejoao.mart_referrals
[0m19:51:59.268467 [debug] [Thread-4  ]: Compiling model.ggchallengejoao.mart_referrals
[0m19:51:59.273321 [debug] [Thread-4  ]: Writing injected SQL for node "model.ggchallengejoao.mart_referrals"
[0m19:51:59.274635 [debug] [Thread-4  ]: finished collecting timing info
[0m19:51:59.274802 [debug] [Thread-4  ]: Began executing node model.ggchallengejoao.mart_referrals
[0m19:51:59.285588 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m19:51:59.652643 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:d1de89f7-7e76-4373-974b-f7bf682915af:EU&page=queryresults
[0m19:51:59.665518 [debug] [Thread-3  ]: Writing injected SQL for node "model.metrics.dbt_metrics_default_calendar"
[0m19:51:59.666382 [debug] [Thread-3  ]: finished collecting timing info
[0m19:51:59.666525 [debug] [Thread-3  ]: Began executing node model.metrics.dbt_metrics_default_calendar
[0m19:51:59.761400 [debug] [Thread-4  ]: Writing runtime sql for node "model.ggchallengejoao.mart_referrals"
[0m19:51:59.762131 [debug] [Thread-4  ]: On model.ggchallengejoao.mart_referrals: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.mart_referrals"} */

  
    

    create or replace table `dynamic-point-367801`.`getgroundjoao`.`mart_referrals`
    
    
    OPTIONS()
    as (
      

select
    r.id as referral_id,
    r.company_id as referral_company,
    r.partner_id as referral_partner,
    r.status as referral_status,
    r.is_outbound as referral_outbound,
    r.referral_created_at_timestamp as referral_record_date,
    r.referral_updated_at_timestamp as referral_updated,
    nullif(
        timestamp_diff(
            referral_updated_at_timestamp, referral_created_at_timestamp, day
        ),
        0
    ) as referral_days_from_creation,
    p.partner_type as referral_partner_type,
    case
        when p.lead_sales_contact = '0'
        then
            'No contact' as referral_lead_sales_contact,
            coalesce(d.country, 'No country')
    end as referral_country
from `dynamic-point-367801`.`getgroundjoao`.`stg_referrals` r
left join `dynamic-point-367801`.`getgroundjoao`.`partners` p on r.partner_id = p.id
left join `dynamic-point-367801`.`getgroundjoao`.`sales_people` d on p.lead_sales_contact = d.name
    );
  
[0m19:52:00.014928 [debug] [Thread-3  ]: Writing runtime sql for node "model.metrics.dbt_metrics_default_calendar"
[0m19:52:00.016646 [debug] [Thread-3  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */

  
    

    create or replace table `dynamic-point-367801`.`getgroundjoao`.`dbt_metrics_default_calendar`
    
    
    OPTIONS()
    as (
      

with days as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
     + 
    
    p11.generated_number * power(2, 11)
     + 
    
    p12.generated_number * power(2, 12)
     + 
    
    p13.generated_number * power(2, 13)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
     cross join 
    
    p as p11
     cross join 
    
    p as p12
     cross join 
    
    p as p13
    
    

    )

    select *
    from unioned
    where generated_number <= 14610
    order by generated_number



),

all_periods as (

    select (
        

        datetime_add(
            cast( cast('1990-01-01' as date) as datetime),
        interval row_number() over (order by 1) - 1 day
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2030-01-01' as date)

)

select * from filtered


),

final as (
    select 
        cast(date_day as date) as date_day,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        week
    ) as date) as date_week,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        month
    ) as date) as date_month,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        quarter
    ) as date) as date_quarter,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        year
    ) as date) as date_year
    from days
)

select * from final
    );
  
[0m19:52:00.074751 [debug] [Thread-4  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword ELSE or keyword END but got keyword AS at [31:26]')
[0m19:52:01.799556 [error] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:EU:523d1970-f3cd-4ce9-9aff-84381a467cc6&page=queryresults
[0m19:52:01.801104 [debug] [Thread-4  ]: finished collecting timing info
[0m19:52:01.803491 [debug] [Thread-4  ]: Database Error in model mart_referrals (models/marts/mart_referrals.sql)
  Syntax error: Expected keyword ELSE or keyword END but got keyword AS at [31:26]
  compiled Code at target/run/ggchallengejoao/models/marts/mart_referrals.sql
[0m19:52:01.804253 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaa9d970-f8b8-4570-b0b6-2cbb449501e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117d9e310>]}
[0m19:52:01.805034 [error] [Thread-4  ]: 4 of 4 ERROR creating sql table model getgroundjoao.mart_referrals ............. [[31mERROR[0m in 2.54s]
[0m19:52:01.805866 [debug] [Thread-4  ]: Finished running node model.ggchallengejoao.mart_referrals
[0m19:52:02.920463 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:887cf6a3-c010-41da-9dad-7e1230c98f4f:EU&page=queryresults
[0m19:52:02.929023 [debug] [Thread-3  ]: finished collecting timing info
[0m19:52:02.931462 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaa9d970-f8b8-4570-b0b6-2cbb449501e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117e12310>]}
[0m19:52:02.933030 [info ] [Thread-3  ]: 3 of 4 OK created sql table model getgroundjoao.dbt_metrics_default_calendar ... [[32mCREATE TABLE (14.6k rows, 0 processed)[0m in 4.87s]
[0m19:52:02.934760 [debug] [Thread-3  ]: Finished running node model.metrics.dbt_metrics_default_calendar
[0m19:52:02.939175 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m19:52:02.941118 [info ] [MainThread]: 
[0m19:52:02.941863 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 7.36 seconds (7.36s).
[0m19:52:02.942856 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:52:02.944098 [debug] [MainThread]: Connection 'model.ggchallengejoao.stg_partners' was properly closed.
[0m19:52:02.944465 [debug] [MainThread]: Connection 'model.ggchallengejoao.stg_referrals' was properly closed.
[0m19:52:02.945013 [debug] [MainThread]: Connection 'model.metrics.dbt_metrics_default_calendar' was properly closed.
[0m19:52:02.945385 [debug] [MainThread]: Connection 'model.ggchallengejoao.mart_referrals' was properly closed.
[0m19:52:02.967341 [info ] [MainThread]: 
[0m19:52:02.968170 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:52:02.968397 [info ] [MainThread]: 
[0m19:52:02.968528 [error] [MainThread]: [33mDatabase Error in model mart_referrals (models/marts/mart_referrals.sql)[0m
[0m19:52:02.968651 [error] [MainThread]:   Syntax error: Expected keyword ELSE or keyword END but got keyword AS at [31:26]
[0m19:52:02.968766 [error] [MainThread]:   compiled Code at target/run/ggchallengejoao/models/marts/mart_referrals.sql
[0m19:52:02.968895 [info ] [MainThread]: 
[0m19:52:02.969247 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m19:52:02.970000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11793a5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11793af10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117dc20d0>]}
[0m19:52:02.970226 [debug] [MainThread]: Flushing usage events


============================== 2023-01-06 19:52:42.842128 | 9ba94bfa-9601-428a-aace-57be08357166 ==============================
[0m19:52:42.842164 [info ] [MainThread]: Running with dbt=1.3.2
[0m19:52:42.842697 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joaopaulomedeiroscecilio/dev/dbt-data-analysis', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:52:42.842800 [debug] [MainThread]: Tracking: tracking
[0m19:52:42.856040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159b7aee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159b93100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159b930a0>]}
[0m19:52:42.976342 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:52:42.976862 [debug] [MainThread]: Partial parsing: updated file: ggchallengejoao://models/marts/mart_referrals.sql
[0m19:52:42.987223 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_referrals.sql
[0m19:52:43.011191 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ggchallengejoao.example

[0m19:52:43.014809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ba94bfa-9601-428a-aace-57be08357166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159e9b0d0>]}
[0m19:52:43.022113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ba94bfa-9601-428a-aace-57be08357166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159d2c190>]}
[0m19:52:43.022377 [info ] [MainThread]: Found 4 models, 6 tests, 0 snapshots, 0 analyses, 533 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 2 metrics
[0m19:52:43.022533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ba94bfa-9601-428a-aace-57be08357166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159db3790>]}
[0m19:52:43.023504 [info ] [MainThread]: 
[0m19:52:43.023903 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m19:52:43.024485 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801"
[0m19:52:43.024621 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:52:44.464934 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801_getgroundjoao"
[0m19:52:44.466004 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:52:44.967858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ba94bfa-9601-428a-aace-57be08357166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159d2c340>]}
[0m19:52:44.972001 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:52:44.972730 [info ] [MainThread]: 
[0m19:52:44.983006 [debug] [Thread-1  ]: Began running node model.ggchallengejoao.stg_partners
[0m19:52:44.983358 [debug] [Thread-2  ]: Began running node model.ggchallengejoao.stg_referrals
[0m19:52:44.983508 [debug] [Thread-3  ]: Began running node model.metrics.dbt_metrics_default_calendar
[0m19:52:44.983859 [info ] [Thread-1  ]: 1 of 4 START sql view model getgroundjoao.stg_partners ......................... [RUN]
[0m19:52:44.984175 [info ] [Thread-2  ]: 2 of 4 START sql view model getgroundjoao.stg_referrals ........................ [RUN]
[0m19:52:44.984422 [info ] [Thread-3  ]: 3 of 4 START sql table model getgroundjoao.dbt_metrics_default_calendar ........ [RUN]
[0m19:52:44.985132 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_partners"
[0m19:52:44.985786 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_referrals"
[0m19:52:44.987340 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.metrics.dbt_metrics_default_calendar"
[0m19:52:44.987620 [debug] [Thread-1  ]: Began compiling node model.ggchallengejoao.stg_partners
[0m19:52:44.987799 [debug] [Thread-2  ]: Began compiling node model.ggchallengejoao.stg_referrals
[0m19:52:44.987951 [debug] [Thread-3  ]: Began compiling node model.metrics.dbt_metrics_default_calendar
[0m19:52:44.988256 [debug] [Thread-1  ]: Compiling model.ggchallengejoao.stg_partners
[0m19:52:44.988409 [debug] [Thread-2  ]: Compiling model.ggchallengejoao.stg_referrals
[0m19:52:44.988548 [debug] [Thread-3  ]: Compiling model.metrics.dbt_metrics_default_calendar
[0m19:52:44.995853 [debug] [Thread-1  ]: Writing injected SQL for node "model.ggchallengejoao.stg_partners"
[0m19:52:44.999848 [debug] [Thread-2  ]: Writing injected SQL for node "model.ggchallengejoao.stg_referrals"
[0m19:52:45.021202 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:52:45.022325 [debug] [Thread-3  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */


        select 

    datetime_diff(
        cast(cast('2030-01-01' as date) as datetime),
        cast(cast('1990-01-01' as date) as datetime),
        day
    )

  
[0m19:52:45.024499 [debug] [Thread-2  ]: finished collecting timing info
[0m19:52:45.024617 [debug] [Thread-1  ]: finished collecting timing info
[0m19:52:45.025132 [debug] [Thread-2  ]: Began executing node model.ggchallengejoao.stg_referrals
[0m19:52:45.025838 [debug] [Thread-1  ]: Began executing node model.ggchallengejoao.stg_partners
[0m19:52:45.049914 [debug] [Thread-2  ]: Writing runtime sql for node "model.ggchallengejoao.stg_referrals"
[0m19:52:45.052321 [debug] [Thread-1  ]: Writing runtime sql for node "model.ggchallengejoao.stg_partners"
[0m19:52:45.053104 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m19:52:45.053218 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:52:45.053348 [debug] [Thread-2  ]: On model.ggchallengejoao.stg_referrals: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.stg_referrals"} */


  create or replace view `dynamic-point-367801`.`getgroundjoao`.`stg_referrals`
  OPTIONS()
  as 

select *
except
    (created_at, updated_at),
    
timestamp_micros(cast(created_at/ 1000 as int64))
 as referral_created_at_timestamp,
    
timestamp_micros(cast(updated_at/ 1000 as int64))
 as referral_updated_at_timestamp
from `dynamic-point-367801`.`getgroundjoao`.`referrals`;


[0m19:52:45.053450 [debug] [Thread-1  ]: On model.ggchallengejoao.stg_partners: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.stg_partners"} */


  create or replace view `dynamic-point-367801`.`getgroundjoao`.`stg_partners`
  OPTIONS()
  as 

select *
except
    (lead_sales_contact, created_at, updated_at),
    if(
        lead_sales_contact = '0', 'No contact', lead_sales_contact
    ) as lead_sales_contact,
    
timestamp_micros(cast(created_at/ 1000 as int64))
 as partner_created_at_timestamp,
    
timestamp_micros(cast(updated_at/ 1000 as int64))
 as partner_updated_at_timestamp
from `dynamic-point-367801`.`getgroundjoao`.`partners`;


[0m19:52:46.118963 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:7b4ff37e-ac5d-486d-b7d3-c4115600fd47:EU&page=queryresults
[0m19:52:46.131327 [debug] [Thread-1  ]: finished collecting timing info
[0m19:52:46.132123 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ba94bfa-9601-428a-aace-57be08357166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159ee6ee0>]}
[0m19:52:46.132450 [info ] [Thread-1  ]: 1 of 4 OK created sql view model getgroundjoao.stg_partners .................... [[32mCREATE VIEW (0 processed)[0m in 1.15s]
[0m19:52:46.132793 [debug] [Thread-1  ]: Finished running node model.ggchallengejoao.stg_partners
[0m19:52:46.375975 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:253b97cf-9f2f-485c-a7cc-05ce357e8c7a:EU&page=queryresults
[0m19:52:46.378248 [debug] [Thread-2  ]: finished collecting timing info
[0m19:52:46.379136 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ba94bfa-9601-428a-aace-57be08357166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159f99b50>]}
[0m19:52:46.379699 [info ] [Thread-2  ]: 2 of 4 OK created sql view model getgroundjoao.stg_referrals ................... [[32mCREATE VIEW (0 processed)[0m in 1.39s]
[0m19:52:46.380332 [debug] [Thread-2  ]: Finished running node model.ggchallengejoao.stg_referrals
[0m19:52:46.381044 [debug] [Thread-4  ]: Began running node model.ggchallengejoao.mart_referrals
[0m19:52:46.381488 [info ] [Thread-4  ]: 4 of 4 START sql table model getgroundjoao.mart_referrals ...................... [RUN]
[0m19:52:46.382216 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.ggchallengejoao.mart_referrals"
[0m19:52:46.382357 [debug] [Thread-4  ]: Began compiling node model.ggchallengejoao.mart_referrals
[0m19:52:46.382508 [debug] [Thread-4  ]: Compiling model.ggchallengejoao.mart_referrals
[0m19:52:46.385696 [debug] [Thread-4  ]: Writing injected SQL for node "model.ggchallengejoao.mart_referrals"
[0m19:52:46.386589 [debug] [Thread-4  ]: finished collecting timing info
[0m19:52:46.386713 [debug] [Thread-4  ]: Began executing node model.ggchallengejoao.mart_referrals
[0m19:52:46.394821 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m19:52:46.560982 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:b3642e66-aab8-440e-8073-2db3149bbd61:EU&page=queryresults
[0m19:52:46.572116 [debug] [Thread-3  ]: Writing injected SQL for node "model.metrics.dbt_metrics_default_calendar"
[0m19:52:46.572847 [debug] [Thread-3  ]: finished collecting timing info
[0m19:52:46.572962 [debug] [Thread-3  ]: Began executing node model.metrics.dbt_metrics_default_calendar
[0m19:52:46.869321 [debug] [Thread-4  ]: Writing runtime sql for node "model.ggchallengejoao.mart_referrals"
[0m19:52:46.869825 [debug] [Thread-4  ]: On model.ggchallengejoao.mart_referrals: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.mart_referrals"} */

  
    

    create or replace table `dynamic-point-367801`.`getgroundjoao`.`mart_referrals`
    
    
    OPTIONS()
    as (
      

select
    r.id as referral_id,
    r.company_id as referral_company,
    r.partner_id as referral_partner,
    r.status as referral_status,
    r.is_outbound as referral_outbound,
    r.referral_created_at_timestamp as referral_record_date,
    r.referral_updated_at_timestamp as referral_updated,
    nullif(
        timestamp_diff(
            referral_updated_at_timestamp, referral_created_at_timestamp, day
        ),
        0
    ) as referral_days_from_creation,
    p.partner_type as referral_partner_type,
    case
        when p.lead_sales_contact = '0'
        then 'No contact'
        else
            p.lead_sales_contact as referral_lead_sales_contact,
            coalesce(d.country, 'No country')
    end as referral_country
from `dynamic-point-367801`.`getgroundjoao`.`stg_referrals` r
left join `dynamic-point-367801`.`getgroundjoao`.`partners` p on r.partner_id = p.id
left join `dynamic-point-367801`.`getgroundjoao`.`sales_people` d on p.lead_sales_contact = d.name
    );
  
[0m19:52:47.070165 [debug] [Thread-3  ]: Writing runtime sql for node "model.metrics.dbt_metrics_default_calendar"
[0m19:52:47.072414 [debug] [Thread-3  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */

  
    

    create or replace table `dynamic-point-367801`.`getgroundjoao`.`dbt_metrics_default_calendar`
    
    
    OPTIONS()
    as (
      

with days as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
     + 
    
    p11.generated_number * power(2, 11)
     + 
    
    p12.generated_number * power(2, 12)
     + 
    
    p13.generated_number * power(2, 13)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
     cross join 
    
    p as p11
     cross join 
    
    p as p12
     cross join 
    
    p as p13
    
    

    )

    select *
    from unioned
    where generated_number <= 14610
    order by generated_number



),

all_periods as (

    select (
        

        datetime_add(
            cast( cast('1990-01-01' as date) as datetime),
        interval row_number() over (order by 1) - 1 day
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2030-01-01' as date)

)

select * from filtered


),

final as (
    select 
        cast(date_day as date) as date_day,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        week
    ) as date) as date_week,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        month
    ) as date) as date_month,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        quarter
    ) as date) as date_quarter,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        year
    ) as date) as date_year
    from days
)

select * from final
    );
  
[0m19:52:47.185765 [debug] [Thread-4  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword AS at [32:34]')
[0m19:52:48.446746 [error] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:EU:8fd5d208-b983-4ca9-ac66-24ae9aff8c6c&page=queryresults
[0m19:52:48.448571 [debug] [Thread-4  ]: finished collecting timing info
[0m19:52:48.450239 [debug] [Thread-4  ]: Database Error in model mart_referrals (models/marts/mart_referrals.sql)
  Syntax error: Unexpected keyword AS at [32:34]
  compiled Code at target/run/ggchallengejoao/models/marts/mart_referrals.sql
[0m19:52:48.451119 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ba94bfa-9601-428a-aace-57be08357166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159fd86a0>]}
[0m19:52:48.452025 [error] [Thread-4  ]: 4 of 4 ERROR creating sql table model getgroundjoao.mart_referrals ............. [[31mERROR[0m in 2.07s]
[0m19:52:48.453015 [debug] [Thread-4  ]: Finished running node model.ggchallengejoao.mart_referrals
[0m19:52:49.938091 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:2ea9c9fc-1431-4cb6-a5a7-ab5a09fdb5d4:EU&page=queryresults
[0m19:52:49.942251 [debug] [Thread-3  ]: finished collecting timing info
[0m19:52:49.943864 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ba94bfa-9601-428a-aace-57be08357166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a055160>]}
[0m19:52:49.944769 [info ] [Thread-3  ]: 3 of 4 OK created sql table model getgroundjoao.dbt_metrics_default_calendar ... [[32mCREATE TABLE (14.6k rows, 0 processed)[0m in 4.96s]
[0m19:52:49.945891 [debug] [Thread-3  ]: Finished running node model.metrics.dbt_metrics_default_calendar
[0m19:52:49.949310 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m19:52:49.950336 [info ] [MainThread]: 
[0m19:52:49.950756 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 6.93 seconds (6.93s).
[0m19:52:49.951141 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:52:49.951327 [debug] [MainThread]: Connection 'model.ggchallengejoao.stg_partners' was properly closed.
[0m19:52:49.951507 [debug] [MainThread]: Connection 'model.ggchallengejoao.stg_referrals' was properly closed.
[0m19:52:49.951680 [debug] [MainThread]: Connection 'model.metrics.dbt_metrics_default_calendar' was properly closed.
[0m19:52:49.951848 [debug] [MainThread]: Connection 'model.ggchallengejoao.mart_referrals' was properly closed.
[0m19:52:49.980942 [info ] [MainThread]: 
[0m19:52:49.981749 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:52:49.982079 [info ] [MainThread]: 
[0m19:52:49.982750 [error] [MainThread]: [33mDatabase Error in model mart_referrals (models/marts/mart_referrals.sql)[0m
[0m19:52:49.983245 [error] [MainThread]:   Syntax error: Unexpected keyword AS at [32:34]
[0m19:52:49.983598 [error] [MainThread]:   compiled Code at target/run/ggchallengejoao/models/marts/mart_referrals.sql
[0m19:52:49.983892 [info ] [MainThread]: 
[0m19:52:49.984198 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m19:52:49.987274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159d2c9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159eb99d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159b3e760>]}
[0m19:52:49.987634 [debug] [MainThread]: Flushing usage events


============================== 2023-01-06 19:53:10.626905 | 14f5c2e2-3f94-4ad5-bb02-1c2e617e586e ==============================
[0m19:53:10.626935 [info ] [MainThread]: Running with dbt=1.3.2
[0m19:53:10.627560 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joaopaulomedeiroscecilio/dev/dbt-data-analysis', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:53:10.627663 [debug] [MainThread]: Tracking: tracking
[0m19:53:10.646690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b47bee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b493100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b4930a0>]}
[0m19:53:10.716564 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:53:10.716893 [debug] [MainThread]: Partial parsing: updated file: ggchallengejoao://models/marts/mart_referrals.sql
[0m19:53:10.726632 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_referrals.sql
[0m19:53:10.749661 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ggchallengejoao.example

[0m19:53:10.753104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14f5c2e2-3f94-4ad5-bb02-1c2e617e586e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13819b0d0>]}
[0m19:53:10.760027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14f5c2e2-3f94-4ad5-bb02-1c2e617e586e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13802c1c0>]}
[0m19:53:10.760278 [info ] [MainThread]: Found 4 models, 6 tests, 0 snapshots, 0 analyses, 533 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 2 metrics
[0m19:53:10.760431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14f5c2e2-3f94-4ad5-bb02-1c2e617e586e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1380b4790>]}
[0m19:53:10.761352 [info ] [MainThread]: 
[0m19:53:10.761785 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m19:53:10.762439 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801"
[0m19:53:10.762620 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:53:12.271199 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801_getgroundjoao"
[0m19:53:12.272268 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:53:12.713164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14f5c2e2-3f94-4ad5-bb02-1c2e617e586e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b43ec40>]}
[0m19:53:12.715179 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:53:12.715988 [info ] [MainThread]: 
[0m19:53:12.729877 [debug] [Thread-1  ]: Began running node model.ggchallengejoao.stg_partners
[0m19:53:12.730147 [debug] [Thread-2  ]: Began running node model.ggchallengejoao.stg_referrals
[0m19:53:12.730373 [debug] [Thread-3  ]: Began running node model.metrics.dbt_metrics_default_calendar
[0m19:53:12.730851 [info ] [Thread-1  ]: 1 of 4 START sql view model getgroundjoao.stg_partners ......................... [RUN]
[0m19:53:12.731194 [info ] [Thread-2  ]: 2 of 4 START sql view model getgroundjoao.stg_referrals ........................ [RUN]
[0m19:53:12.731487 [info ] [Thread-3  ]: 3 of 4 START sql table model getgroundjoao.dbt_metrics_default_calendar ........ [RUN]
[0m19:53:12.732527 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_partners"
[0m19:53:12.733337 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_referrals"
[0m19:53:12.735256 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.metrics.dbt_metrics_default_calendar"
[0m19:53:12.735637 [debug] [Thread-1  ]: Began compiling node model.ggchallengejoao.stg_partners
[0m19:53:12.736057 [debug] [Thread-2  ]: Began compiling node model.ggchallengejoao.stg_referrals
[0m19:53:12.736352 [debug] [Thread-3  ]: Began compiling node model.metrics.dbt_metrics_default_calendar
[0m19:53:12.736787 [debug] [Thread-1  ]: Compiling model.ggchallengejoao.stg_partners
[0m19:53:12.737005 [debug] [Thread-2  ]: Compiling model.ggchallengejoao.stg_referrals
[0m19:53:12.737204 [debug] [Thread-3  ]: Compiling model.metrics.dbt_metrics_default_calendar
[0m19:53:12.746690 [debug] [Thread-1  ]: Writing injected SQL for node "model.ggchallengejoao.stg_partners"
[0m19:53:12.751340 [debug] [Thread-2  ]: Writing injected SQL for node "model.ggchallengejoao.stg_referrals"
[0m19:53:12.773026 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:53:12.773658 [debug] [Thread-3  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */


        select 

    datetime_diff(
        cast(cast('2030-01-01' as date) as datetime),
        cast(cast('1990-01-01' as date) as datetime),
        day
    )

  
[0m19:53:12.773841 [debug] [Thread-1  ]: finished collecting timing info
[0m19:53:12.774811 [debug] [Thread-2  ]: finished collecting timing info
[0m19:53:12.774932 [debug] [Thread-1  ]: Began executing node model.ggchallengejoao.stg_partners
[0m19:53:12.775810 [debug] [Thread-2  ]: Began executing node model.ggchallengejoao.stg_referrals
[0m19:53:12.795925 [debug] [Thread-1  ]: Writing runtime sql for node "model.ggchallengejoao.stg_partners"
[0m19:53:12.797978 [debug] [Thread-2  ]: Writing runtime sql for node "model.ggchallengejoao.stg_referrals"
[0m19:53:12.798728 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m19:53:12.798834 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:53:12.798954 [debug] [Thread-2  ]: On model.ggchallengejoao.stg_referrals: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.stg_referrals"} */


  create or replace view `dynamic-point-367801`.`getgroundjoao`.`stg_referrals`
  OPTIONS()
  as 

select *
except
    (created_at, updated_at),
    
timestamp_micros(cast(created_at/ 1000 as int64))
 as referral_created_at_timestamp,
    
timestamp_micros(cast(updated_at/ 1000 as int64))
 as referral_updated_at_timestamp
from `dynamic-point-367801`.`getgroundjoao`.`referrals`;


[0m19:53:12.799054 [debug] [Thread-1  ]: On model.ggchallengejoao.stg_partners: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.stg_partners"} */


  create or replace view `dynamic-point-367801`.`getgroundjoao`.`stg_partners`
  OPTIONS()
  as 

select *
except
    (lead_sales_contact, created_at, updated_at),
    if(
        lead_sales_contact = '0', 'No contact', lead_sales_contact
    ) as lead_sales_contact,
    
timestamp_micros(cast(created_at/ 1000 as int64))
 as partner_created_at_timestamp,
    
timestamp_micros(cast(updated_at/ 1000 as int64))
 as partner_updated_at_timestamp
from `dynamic-point-367801`.`getgroundjoao`.`partners`;


[0m19:53:13.883415 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:8c9ba2ae-16a0-4349-aa89-1e6ba3c7e005:EU&page=queryresults
[0m19:53:13.910014 [debug] [Thread-2  ]: finished collecting timing info
[0m19:53:13.911842 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14f5c2e2-3f94-4ad5-bb02-1c2e617e586e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1381cb370>]}
[0m19:53:13.913252 [info ] [Thread-2  ]: 2 of 4 OK created sql view model getgroundjoao.stg_referrals ................... [[32mCREATE VIEW (0 processed)[0m in 1.18s]
[0m19:53:13.913840 [debug] [Thread-2  ]: Finished running node model.ggchallengejoao.stg_referrals
[0m19:53:13.914492 [debug] [Thread-4  ]: Began running node model.ggchallengejoao.mart_referrals
[0m19:53:13.915073 [info ] [Thread-4  ]: 4 of 4 START sql table model getgroundjoao.mart_referrals ...................... [RUN]
[0m19:53:13.916057 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.ggchallengejoao.mart_referrals"
[0m19:53:13.916383 [debug] [Thread-4  ]: Began compiling node model.ggchallengejoao.mart_referrals
[0m19:53:13.916617 [debug] [Thread-4  ]: Compiling model.ggchallengejoao.mart_referrals
[0m19:53:13.921200 [debug] [Thread-4  ]: Writing injected SQL for node "model.ggchallengejoao.mart_referrals"
[0m19:53:13.922079 [debug] [Thread-4  ]: finished collecting timing info
[0m19:53:13.922254 [debug] [Thread-4  ]: Began executing node model.ggchallengejoao.mart_referrals
[0m19:53:13.933447 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m19:53:14.120694 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:7198ac62-f067-43bb-ba7b-e1fdaae78d2f:EU&page=queryresults
[0m19:53:14.124251 [debug] [Thread-1  ]: finished collecting timing info
[0m19:53:14.125737 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14f5c2e2-3f94-4ad5-bb02-1c2e617e586e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1381e7eb0>]}
[0m19:53:14.126417 [info ] [Thread-1  ]: 1 of 4 OK created sql view model getgroundjoao.stg_partners .................... [[32mCREATE VIEW (0 processed)[0m in 1.39s]
[0m19:53:14.127005 [debug] [Thread-1  ]: Finished running node model.ggchallengejoao.stg_partners
[0m19:53:14.400061 [debug] [Thread-4  ]: Writing runtime sql for node "model.ggchallengejoao.mart_referrals"
[0m19:53:14.400946 [debug] [Thread-4  ]: On model.ggchallengejoao.mart_referrals: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.mart_referrals"} */

  
    

    create or replace table `dynamic-point-367801`.`getgroundjoao`.`mart_referrals`
    
    
    OPTIONS()
    as (
      

select
    r.id as referral_id,
    r.company_id as referral_company,
    r.partner_id as referral_partner,
    r.status as referral_status,
    r.is_outbound as referral_outbound,
    r.referral_created_at_timestamp as referral_record_date,
    r.referral_updated_at_timestamp as referral_updated,
    nullif(
        timestamp_diff(
            referral_updated_at_timestamp, referral_created_at_timestamp, day
        ),
        0
    ) as referral_days_from_creation,
    p.partner_type as referral_partner_type,
    case
        when p.lead_sales_contact = '0' then 'No contact' else p.lead_sales_contact
    end as referral_lead_sales_contact,
    coalesce(d.country, 'No country')
from `dynamic-point-367801`.`getgroundjoao`.`stg_referrals` r
left join `dynamic-point-367801`.`getgroundjoao`.`partners` p on r.partner_id = p.id
left join `dynamic-point-367801`.`getgroundjoao`.`sales_people` d on p.lead_sales_contact = d.name
    );
  
[0m19:53:14.555201 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:b22d97cc-b84e-41ab-a544-9a501d6400f9:EU&page=queryresults
[0m19:53:14.579629 [debug] [Thread-3  ]: Writing injected SQL for node "model.metrics.dbt_metrics_default_calendar"
[0m19:53:14.580541 [debug] [Thread-3  ]: finished collecting timing info
[0m19:53:14.580813 [debug] [Thread-3  ]: Began executing node model.metrics.dbt_metrics_default_calendar
[0m19:53:14.897836 [debug] [Thread-3  ]: Writing runtime sql for node "model.metrics.dbt_metrics_default_calendar"
[0m19:53:14.900000 [debug] [Thread-3  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */

  
    

    create or replace table `dynamic-point-367801`.`getgroundjoao`.`dbt_metrics_default_calendar`
    
    
    OPTIONS()
    as (
      

with days as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
     + 
    
    p11.generated_number * power(2, 11)
     + 
    
    p12.generated_number * power(2, 12)
     + 
    
    p13.generated_number * power(2, 13)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
     cross join 
    
    p as p11
     cross join 
    
    p as p12
     cross join 
    
    p as p13
    
    

    )

    select *
    from unioned
    where generated_number <= 14610
    order by generated_number



),

all_periods as (

    select (
        

        datetime_add(
            cast( cast('1990-01-01' as date) as datetime),
        interval row_number() over (order by 1) - 1 day
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2030-01-01' as date)

)

select * from filtered


),

final as (
    select 
        cast(date_day as date) as date_day,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        week
    ) as date) as date_week,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        month
    ) as date) as date_month,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        quarter
    ) as date) as date_quarter,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        year
    ) as date) as date_year
    from days
)

select * from final
    );
  
[0m19:53:15.394560 [debug] [Thread-4  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('CREATE TABLE columns must be named, but column 11 has no name at [10:8]')
[0m19:53:17.585078 [error] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:EU:ffe22006-6c8e-4de2-9bd8-bc0cf456092d&page=queryresults
[0m19:53:17.587834 [debug] [Thread-4  ]: finished collecting timing info
[0m19:53:17.590400 [debug] [Thread-4  ]: Database Error in model mart_referrals (models/marts/mart_referrals.sql)
  CREATE TABLE columns must be named, but column 11 has no name at [10:8]
  compiled Code at target/run/ggchallengejoao/models/marts/mart_referrals.sql
[0m19:53:17.591347 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14f5c2e2-3f94-4ad5-bb02-1c2e617e586e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1382c8a60>]}
[0m19:53:17.592607 [error] [Thread-4  ]: 4 of 4 ERROR creating sql table model getgroundjoao.mart_referrals ............. [[31mERROR[0m in 3.68s]
[0m19:53:17.593743 [debug] [Thread-4  ]: Finished running node model.ggchallengejoao.mart_referrals
[0m19:53:17.772475 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:e6f1ef06-9785-4a4c-b9c6-308e035196f2:EU&page=queryresults
[0m19:53:17.777657 [debug] [Thread-3  ]: finished collecting timing info
[0m19:53:17.779097 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14f5c2e2-3f94-4ad5-bb02-1c2e617e586e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1382e52b0>]}
[0m19:53:17.779674 [info ] [Thread-3  ]: 3 of 4 OK created sql table model getgroundjoao.dbt_metrics_default_calendar ... [[32mCREATE TABLE (14.6k rows, 0 processed)[0m in 5.05s]
[0m19:53:17.780355 [debug] [Thread-3  ]: Finished running node model.metrics.dbt_metrics_default_calendar
[0m19:53:17.783645 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m19:53:17.784596 [info ] [MainThread]: 
[0m19:53:17.785010 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 7.02 seconds (7.02s).
[0m19:53:17.785383 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:53:17.785569 [debug] [MainThread]: Connection 'model.ggchallengejoao.stg_partners' was properly closed.
[0m19:53:17.785746 [debug] [MainThread]: Connection 'model.ggchallengejoao.stg_referrals' was properly closed.
[0m19:53:17.785920 [debug] [MainThread]: Connection 'model.metrics.dbt_metrics_default_calendar' was properly closed.
[0m19:53:17.786091 [debug] [MainThread]: Connection 'model.ggchallengejoao.mart_referrals' was properly closed.
[0m19:53:17.802159 [info ] [MainThread]: 
[0m19:53:17.802535 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:53:17.802823 [info ] [MainThread]: 
[0m19:53:17.803068 [error] [MainThread]: [33mDatabase Error in model mart_referrals (models/marts/mart_referrals.sql)[0m
[0m19:53:17.803318 [error] [MainThread]:   CREATE TABLE columns must be named, but column 11 has no name at [10:8]
[0m19:53:17.803537 [error] [MainThread]:   compiled Code at target/run/ggchallengejoao/models/marts/mart_referrals.sql
[0m19:53:17.803773 [info ] [MainThread]: 
[0m19:53:17.804021 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m19:53:17.804469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b5cf0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b5cfbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1382b0c40>]}
[0m19:53:17.804742 [debug] [MainThread]: Flushing usage events


============================== 2023-01-06 19:53:54.119509 | 245cff8f-9220-42e2-8db0-3cf1a6e60601 ==============================
[0m19:53:54.119530 [info ] [MainThread]: Running with dbt=1.3.2
[0m19:53:54.120111 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joaopaulomedeiroscecilio/dev/dbt-data-analysis', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:53:54.120211 [debug] [MainThread]: Tracking: tracking
[0m19:53:54.131931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dbbde80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dbd6070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dbd60a0>]}
[0m19:53:54.202143 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:53:54.202451 [debug] [MainThread]: Partial parsing: updated file: ggchallengejoao://models/marts/mart_referrals.sql
[0m19:53:54.210532 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_referrals.sql
[0m19:53:54.231414 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ggchallengejoao.example

[0m19:53:54.234794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '245cff8f-9220-42e2-8db0-3cf1a6e60601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dfe40d0>]}
[0m19:53:54.241632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '245cff8f-9220-42e2-8db0-3cf1a6e60601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11de6c2b0>]}
[0m19:53:54.241853 [info ] [MainThread]: Found 4 models, 6 tests, 0 snapshots, 0 analyses, 533 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 2 metrics
[0m19:53:54.241999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '245cff8f-9220-42e2-8db0-3cf1a6e60601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11def5730>]}
[0m19:53:54.242865 [info ] [MainThread]: 
[0m19:53:54.243241 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m19:53:54.243824 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801"
[0m19:53:54.243981 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:53:55.821074 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801_getgroundjoao"
[0m19:53:55.821982 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:53:56.255387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '245cff8f-9220-42e2-8db0-3cf1a6e60601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11df8df10>]}
[0m19:53:56.256696 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:53:56.257026 [info ] [MainThread]: 
[0m19:53:56.266205 [debug] [Thread-1  ]: Began running node model.ggchallengejoao.stg_partners
[0m19:53:56.266366 [debug] [Thread-2  ]: Began running node model.ggchallengejoao.stg_referrals
[0m19:53:56.266484 [debug] [Thread-3  ]: Began running node model.metrics.dbt_metrics_default_calendar
[0m19:53:56.266792 [info ] [Thread-1  ]: 1 of 4 START sql view model getgroundjoao.stg_partners ......................... [RUN]
[0m19:53:56.267037 [info ] [Thread-2  ]: 2 of 4 START sql view model getgroundjoao.stg_referrals ........................ [RUN]
[0m19:53:56.267257 [info ] [Thread-3  ]: 3 of 4 START sql table model getgroundjoao.dbt_metrics_default_calendar ........ [RUN]
[0m19:53:56.267877 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_partners"
[0m19:53:56.269576 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_referrals"
[0m19:53:56.276859 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.metrics.dbt_metrics_default_calendar"
[0m19:53:56.277369 [debug] [Thread-1  ]: Began compiling node model.ggchallengejoao.stg_partners
[0m19:53:56.278744 [debug] [Thread-1  ]: Compiling model.ggchallengejoao.stg_partners
[0m19:53:56.278470 [debug] [Thread-3  ]: Began compiling node model.metrics.dbt_metrics_default_calendar
[0m19:53:56.277773 [debug] [Thread-2  ]: Began compiling node model.ggchallengejoao.stg_referrals
[0m19:53:56.285265 [debug] [Thread-1  ]: Writing injected SQL for node "model.ggchallengejoao.stg_partners"
[0m19:53:56.285689 [debug] [Thread-3  ]: Compiling model.metrics.dbt_metrics_default_calendar
[0m19:53:56.286065 [debug] [Thread-2  ]: Compiling model.ggchallengejoao.stg_referrals
[0m19:53:56.298187 [debug] [Thread-1  ]: finished collecting timing info
[0m19:53:56.305485 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:53:56.308334 [debug] [Thread-2  ]: Writing injected SQL for node "model.ggchallengejoao.stg_referrals"
[0m19:53:56.308570 [debug] [Thread-1  ]: Began executing node model.ggchallengejoao.stg_partners
[0m19:53:56.308844 [debug] [Thread-3  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */


        select 

    datetime_diff(
        cast(cast('2030-01-01' as date) as datetime),
        cast(cast('1990-01-01' as date) as datetime),
        day
    )

  
[0m19:53:56.326483 [debug] [Thread-1  ]: Writing runtime sql for node "model.ggchallengejoao.stg_partners"
[0m19:53:56.327356 [debug] [Thread-2  ]: finished collecting timing info
[0m19:53:56.328314 [debug] [Thread-2  ]: Began executing node model.ggchallengejoao.stg_referrals
[0m19:53:56.331343 [debug] [Thread-2  ]: Writing runtime sql for node "model.ggchallengejoao.stg_referrals"
[0m19:53:56.331501 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:53:56.331821 [debug] [Thread-1  ]: On model.ggchallengejoao.stg_partners: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.stg_partners"} */


  create or replace view `dynamic-point-367801`.`getgroundjoao`.`stg_partners`
  OPTIONS()
  as 

select *
except
    (lead_sales_contact, created_at, updated_at),
    if(
        lead_sales_contact = '0', 'No contact', lead_sales_contact
    ) as lead_sales_contact,
    
timestamp_micros(cast(created_at/ 1000 as int64))
 as partner_created_at_timestamp,
    
timestamp_micros(cast(updated_at/ 1000 as int64))
 as partner_updated_at_timestamp
from `dynamic-point-367801`.`getgroundjoao`.`partners`;


[0m19:53:56.333098 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m19:53:56.333391 [debug] [Thread-2  ]: On model.ggchallengejoao.stg_referrals: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.stg_referrals"} */


  create or replace view `dynamic-point-367801`.`getgroundjoao`.`stg_referrals`
  OPTIONS()
  as 

select *
except
    (created_at, updated_at),
    
timestamp_micros(cast(created_at/ 1000 as int64))
 as referral_created_at_timestamp,
    
timestamp_micros(cast(updated_at/ 1000 as int64))
 as referral_updated_at_timestamp
from `dynamic-point-367801`.`getgroundjoao`.`referrals`;


[0m19:53:57.404761 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:f44569b8-21b2-47e9-bf52-1b2e65072904:EU&page=queryresults
[0m19:53:57.419909 [debug] [Thread-1  ]: finished collecting timing info
[0m19:53:57.420794 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '245cff8f-9220-42e2-8db0-3cf1a6e60601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e026f10>]}
[0m19:53:57.421869 [info ] [Thread-1  ]: 1 of 4 OK created sql view model getgroundjoao.stg_partners .................... [[32mCREATE VIEW (0 processed)[0m in 1.15s]
[0m19:53:57.422573 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:21611d5b-d2d7-4e3a-8cb0-22976a013ba3:EU&page=queryresults
[0m19:53:57.423245 [debug] [Thread-1  ]: Finished running node model.ggchallengejoao.stg_partners
[0m19:53:57.425312 [debug] [Thread-2  ]: finished collecting timing info
[0m19:53:57.434004 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '245cff8f-9220-42e2-8db0-3cf1a6e60601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e0c2280>]}
[0m19:53:57.434488 [info ] [Thread-2  ]: 2 of 4 OK created sql view model getgroundjoao.stg_referrals ................... [[32mCREATE VIEW (0 processed)[0m in 1.17s]
[0m19:53:57.434877 [debug] [Thread-2  ]: Finished running node model.ggchallengejoao.stg_referrals
[0m19:53:57.435504 [debug] [Thread-4  ]: Began running node model.ggchallengejoao.mart_referrals
[0m19:53:57.435759 [info ] [Thread-4  ]: 4 of 4 START sql table model getgroundjoao.mart_referrals ...................... [RUN]
[0m19:53:57.436301 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.ggchallengejoao.mart_referrals"
[0m19:53:57.436427 [debug] [Thread-4  ]: Began compiling node model.ggchallengejoao.mart_referrals
[0m19:53:57.436988 [debug] [Thread-4  ]: Compiling model.ggchallengejoao.mart_referrals
[0m19:53:57.451804 [debug] [Thread-4  ]: Writing injected SQL for node "model.ggchallengejoao.mart_referrals"
[0m19:53:57.455300 [debug] [Thread-4  ]: finished collecting timing info
[0m19:53:57.455701 [debug] [Thread-4  ]: Began executing node model.ggchallengejoao.mart_referrals
[0m19:53:57.480175 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m19:53:57.973426 [debug] [Thread-4  ]: Writing runtime sql for node "model.ggchallengejoao.mart_referrals"
[0m19:53:57.974448 [debug] [Thread-4  ]: On model.ggchallengejoao.mart_referrals: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.mart_referrals"} */

  
    

    create or replace table `dynamic-point-367801`.`getgroundjoao`.`mart_referrals`
    
    
    OPTIONS()
    as (
      

select
    r.id as referral_id,
    r.company_id as referral_company,
    r.partner_id as referral_partner,
    r.status as referral_status,
    r.is_outbound as referral_outbound,
    r.referral_created_at_timestamp as referral_record_date,
    r.referral_updated_at_timestamp as referral_updated,
    nullif(
        timestamp_diff(
            referral_updated_at_timestamp, referral_created_at_timestamp, day
        ),
        0
    ) as referral_days_from_creation,
    p.partner_type as referral_partner_type,
    case
        when p.lead_sales_contact = '0' then 'No contact' else p.lead_sales_contact
    end as referral_lead_sales_contact,
    coalesce(d.country, 'No country') as referral_country
from `dynamic-point-367801`.`getgroundjoao`.`stg_referrals` r
left join `dynamic-point-367801`.`getgroundjoao`.`partners` p on r.partner_id = p.id
left join `dynamic-point-367801`.`getgroundjoao`.`sales_people` d on p.lead_sales_contact = d.name
    );
  
[0m19:53:58.083111 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:0f7ddec0-390d-41c5-babd-29d3b1bb9566:EU&page=queryresults
[0m19:53:58.095913 [debug] [Thread-3  ]: Writing injected SQL for node "model.metrics.dbt_metrics_default_calendar"
[0m19:53:58.096863 [debug] [Thread-3  ]: finished collecting timing info
[0m19:53:58.097070 [debug] [Thread-3  ]: Began executing node model.metrics.dbt_metrics_default_calendar
[0m19:53:58.414395 [debug] [Thread-3  ]: Writing runtime sql for node "model.metrics.dbt_metrics_default_calendar"
[0m19:53:58.415260 [debug] [Thread-3  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */

  
    

    create or replace table `dynamic-point-367801`.`getgroundjoao`.`dbt_metrics_default_calendar`
    
    
    OPTIONS()
    as (
      

with days as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
     + 
    
    p11.generated_number * power(2, 11)
     + 
    
    p12.generated_number * power(2, 12)
     + 
    
    p13.generated_number * power(2, 13)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
     cross join 
    
    p as p11
     cross join 
    
    p as p12
     cross join 
    
    p as p13
    
    

    )

    select *
    from unioned
    where generated_number <= 14610
    order by generated_number



),

all_periods as (

    select (
        

        datetime_add(
            cast( cast('1990-01-01' as date) as datetime),
        interval row_number() over (order by 1) - 1 day
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2030-01-01' as date)

)

select * from filtered


),

final as (
    select 
        cast(date_day as date) as date_day,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        week
    ) as date) as date_week,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        month
    ) as date) as date_month,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        quarter
    ) as date) as date_quarter,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        year
    ) as date) as date_year
    from days
)

select * from final
    );
  
[0m19:54:00.442884 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:96804510-16f5-4314-b01b-c07a0c808a31:EU&page=queryresults
[0m19:54:00.449755 [debug] [Thread-4  ]: finished collecting timing info
[0m19:54:00.451721 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '245cff8f-9220-42e2-8db0-3cf1a6e60601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e13bdc0>]}
[0m19:54:00.452995 [info ] [Thread-4  ]: 4 of 4 OK created sql table model getgroundjoao.mart_referrals ................. [[32mCREATE TABLE (1.5k rows, 96.3 KB processed)[0m in 3.02s]
[0m19:54:00.454678 [debug] [Thread-4  ]: Finished running node model.ggchallengejoao.mart_referrals
[0m19:54:01.001983 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:766ebb39-1de1-436b-86ac-6b9137a60627:EU&page=queryresults
[0m19:54:01.005469 [debug] [Thread-3  ]: finished collecting timing info
[0m19:54:01.006987 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '245cff8f-9220-42e2-8db0-3cf1a6e60601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e1999a0>]}
[0m19:54:01.008520 [info ] [Thread-3  ]: 3 of 4 OK created sql table model getgroundjoao.dbt_metrics_default_calendar ... [[32mCREATE TABLE (14.6k rows, 0 processed)[0m in 4.74s]
[0m19:54:01.009939 [debug] [Thread-3  ]: Finished running node model.metrics.dbt_metrics_default_calendar
[0m19:54:01.014011 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m19:54:01.015277 [info ] [MainThread]: 
[0m19:54:01.016124 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 6.77 seconds (6.77s).
[0m19:54:01.016930 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:54:01.017415 [debug] [MainThread]: Connection 'model.ggchallengejoao.stg_partners' was properly closed.
[0m19:54:01.017794 [debug] [MainThread]: Connection 'model.ggchallengejoao.stg_referrals' was properly closed.
[0m19:54:01.018093 [debug] [MainThread]: Connection 'model.metrics.dbt_metrics_default_calendar' was properly closed.
[0m19:54:01.018375 [debug] [MainThread]: Connection 'model.ggchallengejoao.mart_referrals' was properly closed.
[0m19:54:01.041307 [info ] [MainThread]: 
[0m19:54:01.041772 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:54:01.042110 [info ] [MainThread]: 
[0m19:54:01.042392 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m19:54:01.043105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dbe0100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dff2550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11df2af40>]}
[0m19:54:01.044251 [debug] [MainThread]: Flushing usage events


============================== 2023-01-06 20:18:50.627987 | ff0b8e04-482c-4e1f-b31f-f885bec1d183 ==============================
[0m20:18:50.628011 [info ] [MainThread]: Running with dbt=1.3.2
[0m20:18:50.628925 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joaopaulomedeiroscecilio/dev/dbt-data-analysis', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:18:50.631054 [debug] [MainThread]: Tracking: tracking
[0m20:18:50.651536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117b3deb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117b530d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117b53070>]}
[0m20:18:50.724636 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:18:50.724859 [debug] [MainThread]: Partial parsing: added file: ggchallengejoao://analyses/total_referrals.sql
[0m20:18:50.770452 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ggchallengejoao.example

[0m20:18:50.773891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff0b8e04-482c-4e1f-b31f-f885bec1d183', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117e5e0d0>]}
[0m20:18:50.780928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff0b8e04-482c-4e1f-b31f-f885bec1d183', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117c8fd30>]}
[0m20:18:50.781150 [info ] [MainThread]: Found 4 models, 6 tests, 0 snapshots, 1 analysis, 533 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 2 metrics
[0m20:18:50.781295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff0b8e04-482c-4e1f-b31f-f885bec1d183', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117c8fbe0>]}
[0m20:18:50.782193 [info ] [MainThread]: 
[0m20:18:50.782675 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m20:18:50.783256 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801"
[0m20:18:50.783413 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:18:52.492264 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801_getgroundjoao"
[0m20:18:52.492846 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:18:52.958099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff0b8e04-482c-4e1f-b31f-f885bec1d183', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117e11cd0>]}
[0m20:18:52.959683 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:18:52.960244 [info ] [MainThread]: 
[0m20:18:52.972686 [debug] [Thread-1  ]: Began running node model.ggchallengejoao.stg_partners
[0m20:18:52.972979 [debug] [Thread-2  ]: Began running node model.ggchallengejoao.stg_referrals
[0m20:18:52.973204 [debug] [Thread-3  ]: Began running node model.metrics.dbt_metrics_default_calendar
[0m20:18:52.973670 [info ] [Thread-1  ]: 1 of 4 START sql view model getgroundjoao.stg_partners ......................... [RUN]
[0m20:18:52.974010 [info ] [Thread-2  ]: 2 of 4 START sql view model getgroundjoao.stg_referrals ........................ [RUN]
[0m20:18:52.974287 [info ] [Thread-3  ]: 3 of 4 START sql table model getgroundjoao.dbt_metrics_default_calendar ........ [RUN]
[0m20:18:52.975111 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_partners"
[0m20:18:52.975942 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_referrals"
[0m20:18:52.976624 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.metrics.dbt_metrics_default_calendar"
[0m20:18:52.976847 [debug] [Thread-1  ]: Began compiling node model.ggchallengejoao.stg_partners
[0m20:18:52.977308 [debug] [Thread-2  ]: Began compiling node model.ggchallengejoao.stg_referrals
[0m20:18:52.977607 [debug] [Thread-3  ]: Began compiling node model.metrics.dbt_metrics_default_calendar
[0m20:18:52.977913 [debug] [Thread-1  ]: Compiling model.ggchallengejoao.stg_partners
[0m20:18:52.978115 [debug] [Thread-2  ]: Compiling model.ggchallengejoao.stg_referrals
[0m20:18:52.978296 [debug] [Thread-3  ]: Compiling model.metrics.dbt_metrics_default_calendar
[0m20:18:52.989600 [debug] [Thread-2  ]: Writing injected SQL for node "model.ggchallengejoao.stg_referrals"
[0m20:18:53.011185 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m20:18:53.014270 [debug] [Thread-1  ]: Writing injected SQL for node "model.ggchallengejoao.stg_partners"
[0m20:18:53.014563 [debug] [Thread-3  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */


        select 

    datetime_diff(
        cast(cast('2030-01-01' as date) as datetime),
        cast(cast('1990-01-01' as date) as datetime),
        day
    )

  
[0m20:18:53.015652 [debug] [Thread-2  ]: finished collecting timing info
[0m20:18:53.016082 [debug] [Thread-1  ]: finished collecting timing info
[0m20:18:53.016206 [debug] [Thread-2  ]: Began executing node model.ggchallengejoao.stg_referrals
[0m20:18:53.016383 [debug] [Thread-1  ]: Began executing node model.ggchallengejoao.stg_partners
[0m20:18:53.034522 [debug] [Thread-2  ]: Writing runtime sql for node "model.ggchallengejoao.stg_referrals"
[0m20:18:53.037024 [debug] [Thread-1  ]: Writing runtime sql for node "model.ggchallengejoao.stg_partners"
[0m20:18:53.037936 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:18:53.038120 [debug] [Thread-1  ]: On model.ggchallengejoao.stg_partners: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.stg_partners"} */


  create or replace view `dynamic-point-367801`.`getgroundjoao`.`stg_partners`
  OPTIONS()
  as 

select *
except
    (lead_sales_contact, created_at, updated_at),
    if(
        lead_sales_contact = '0', 'No contact', lead_sales_contact
    ) as lead_sales_contact,
    
timestamp_micros(cast(created_at/ 1000 as int64))
 as partner_created_at_timestamp,
    
timestamp_micros(cast(updated_at/ 1000 as int64))
 as partner_updated_at_timestamp
from `dynamic-point-367801`.`getgroundjoao`.`partners`;


[0m20:18:53.038218 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m20:18:53.039254 [debug] [Thread-2  ]: On model.ggchallengejoao.stg_referrals: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.stg_referrals"} */


  create or replace view `dynamic-point-367801`.`getgroundjoao`.`stg_referrals`
  OPTIONS()
  as 

select *
except
    (created_at, updated_at),
    
timestamp_micros(cast(created_at/ 1000 as int64))
 as referral_created_at_timestamp,
    
timestamp_micros(cast(updated_at/ 1000 as int64))
 as referral_updated_at_timestamp
from `dynamic-point-367801`.`getgroundjoao`.`referrals`;


[0m20:18:54.197608 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:8ce964f7-6c90-44c7-8baa-390e46b02b22:EU&page=queryresults
[0m20:18:54.220063 [debug] [Thread-1  ]: finished collecting timing info
[0m20:18:54.221330 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff0b8e04-482c-4e1f-b31f-f885bec1d183', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117eb0d30>]}
[0m20:18:54.222233 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:7fe19328-1b62-4961-a67e-5284f3b65e35:EU&page=queryresults
[0m20:18:54.222657 [info ] [Thread-1  ]: 1 of 4 OK created sql view model getgroundjoao.stg_partners .................... [[32mCREATE VIEW (0 processed)[0m in 1.25s]
[0m20:18:54.223903 [debug] [Thread-2  ]: finished collecting timing info
[0m20:18:54.224406 [debug] [Thread-1  ]: Finished running node model.ggchallengejoao.stg_partners
[0m20:18:54.225022 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff0b8e04-482c-4e1f-b31f-f885bec1d183', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117eb0f10>]}
[0m20:18:54.225508 [info ] [Thread-2  ]: 2 of 4 OK created sql view model getgroundjoao.stg_referrals ................... [[32mCREATE VIEW (0 processed)[0m in 1.25s]
[0m20:18:54.225899 [debug] [Thread-2  ]: Finished running node model.ggchallengejoao.stg_referrals
[0m20:18:54.226239 [debug] [Thread-4  ]: Began running node model.ggchallengejoao.mart_referrals
[0m20:18:54.226519 [info ] [Thread-4  ]: 4 of 4 START sql table model getgroundjoao.mart_referrals ...................... [RUN]
[0m20:18:54.227141 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.ggchallengejoao.mart_referrals"
[0m20:18:54.227295 [debug] [Thread-4  ]: Began compiling node model.ggchallengejoao.mart_referrals
[0m20:18:54.227445 [debug] [Thread-4  ]: Compiling model.ggchallengejoao.mart_referrals
[0m20:18:54.231711 [debug] [Thread-4  ]: Writing injected SQL for node "model.ggchallengejoao.mart_referrals"
[0m20:18:54.244978 [debug] [Thread-4  ]: finished collecting timing info
[0m20:18:54.245139 [debug] [Thread-4  ]: Began executing node model.ggchallengejoao.mart_referrals
[0m20:18:54.255242 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m20:18:54.733574 [debug] [Thread-4  ]: Writing runtime sql for node "model.ggchallengejoao.mart_referrals"
[0m20:18:54.734414 [debug] [Thread-4  ]: On model.ggchallengejoao.mart_referrals: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.mart_referrals"} */

  
    

    create or replace table `dynamic-point-367801`.`getgroundjoao`.`mart_referrals`
    
    
    OPTIONS()
    as (
      

select
    r.id as referral_id,
    r.company_id as referral_company,
    r.partner_id as referral_partner,
    r.status as referral_status,
    r.is_outbound as referral_outbound,
    r.referral_created_at_timestamp as referral_record_date,
    r.referral_updated_at_timestamp as referral_updated,
    nullif(
        timestamp_diff(
            referral_updated_at_timestamp, referral_created_at_timestamp, day
        ),
        0
    ) as referral_days_from_creation,
    p.partner_type as referral_partner_type,
    case
        when p.lead_sales_contact = '0' then 'No contact' else p.lead_sales_contact
    end as referral_lead_sales_contact,
    coalesce(d.country, 'No country') as referral_country
from `dynamic-point-367801`.`getgroundjoao`.`stg_referrals` r
left join `dynamic-point-367801`.`getgroundjoao`.`partners` p on r.partner_id = p.id
left join `dynamic-point-367801`.`getgroundjoao`.`sales_people` d on p.lead_sales_contact = d.name
    );
  
[0m20:18:54.970084 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:4d19fcf8-604e-4607-9ed9-a031a4286135:EU&page=queryresults
[0m20:18:54.994050 [debug] [Thread-3  ]: Writing injected SQL for node "model.metrics.dbt_metrics_default_calendar"
[0m20:18:54.996953 [debug] [Thread-3  ]: finished collecting timing info
[0m20:18:54.997183 [debug] [Thread-3  ]: Began executing node model.metrics.dbt_metrics_default_calendar
[0m20:18:55.327847 [debug] [Thread-3  ]: Writing runtime sql for node "model.metrics.dbt_metrics_default_calendar"
[0m20:18:55.329660 [debug] [Thread-3  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */

  
    

    create or replace table `dynamic-point-367801`.`getgroundjoao`.`dbt_metrics_default_calendar`
    
    
    OPTIONS()
    as (
      

with days as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
     + 
    
    p11.generated_number * power(2, 11)
     + 
    
    p12.generated_number * power(2, 12)
     + 
    
    p13.generated_number * power(2, 13)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
     cross join 
    
    p as p11
     cross join 
    
    p as p12
     cross join 
    
    p as p13
    
    

    )

    select *
    from unioned
    where generated_number <= 14610
    order by generated_number



),

all_periods as (

    select (
        

        datetime_add(
            cast( cast('1990-01-01' as date) as datetime),
        interval row_number() over (order by 1) - 1 day
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2030-01-01' as date)

)

select * from filtered


),

final as (
    select 
        cast(date_day as date) as date_day,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        week
    ) as date) as date_week,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        month
    ) as date) as date_month,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        quarter
    ) as date) as date_quarter,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        year
    ) as date) as date_year
    from days
)

select * from final
    );
  
[0m20:18:57.228987 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:85ce6e66-8ce1-4ea6-9f70-498dd24c321e:EU&page=queryresults
[0m20:18:57.231568 [debug] [Thread-4  ]: finished collecting timing info
[0m20:18:57.232454 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff0b8e04-482c-4e1f-b31f-f885bec1d183', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120203250>]}
[0m20:18:57.232910 [info ] [Thread-4  ]: 4 of 4 OK created sql table model getgroundjoao.mart_referrals ................. [[32mCREATE TABLE (1.5k rows, 96.3 KB processed)[0m in 3.01s]
[0m20:18:57.233517 [debug] [Thread-4  ]: Finished running node model.ggchallengejoao.mart_referrals
[0m20:18:58.546229 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:423cd4fb-b0c3-45ca-82ba-99bcdf76c6e0:EU&page=queryresults
[0m20:18:58.550156 [debug] [Thread-3  ]: finished collecting timing info
[0m20:18:58.551698 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff0b8e04-482c-4e1f-b31f-f885bec1d183', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117f7eeb0>]}
[0m20:18:58.552526 [info ] [Thread-3  ]: 3 of 4 OK created sql table model getgroundjoao.dbt_metrics_default_calendar ... [[32mCREATE TABLE (14.6k rows, 0 processed)[0m in 5.58s]
[0m20:18:58.553363 [debug] [Thread-3  ]: Finished running node model.metrics.dbt_metrics_default_calendar
[0m20:18:58.556833 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m20:18:58.557760 [info ] [MainThread]: 
[0m20:18:58.558161 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 7.78 seconds (7.78s).
[0m20:18:58.558502 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:18:58.558692 [debug] [MainThread]: Connection 'model.ggchallengejoao.stg_partners' was properly closed.
[0m20:18:58.558868 [debug] [MainThread]: Connection 'model.ggchallengejoao.stg_referrals' was properly closed.
[0m20:18:58.559038 [debug] [MainThread]: Connection 'model.metrics.dbt_metrics_default_calendar' was properly closed.
[0m20:18:58.559211 [debug] [MainThread]: Connection 'model.ggchallengejoao.mart_referrals' was properly closed.
[0m20:18:58.576399 [info ] [MainThread]: 
[0m20:18:58.576819 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:18:58.577155 [info ] [MainThread]: 
[0m20:18:58.577424 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m20:18:58.577830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117b678b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117c8fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117e5e220>]}
[0m20:18:58.578120 [debug] [MainThread]: Flushing usage events


============================== 2023-01-06 20:20:06.951634 | f3c34806-c1b4-4a2c-8288-db37717c0372 ==============================
[0m20:20:06.951667 [info ] [MainThread]: Running with dbt=1.3.2
[0m20:20:06.952208 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joaopaulomedeiroscecilio/dev/dbt-data-analysis', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'parse_only': False, 'select': ['total_referrals'], 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m20:20:06.952327 [debug] [MainThread]: Tracking: tracking
[0m20:20:06.964998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ddfbf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11de15130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11de150d0>]}
[0m20:20:07.046153 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:20:07.046321 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:20:07.046634 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ggchallengejoao.example

[0m20:20:07.050618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3c34806-c1b4-4a2c-8288-db37717c0372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e0a70d0>]}
[0m20:20:07.058797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3c34806-c1b4-4a2c-8288-db37717c0372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11df77040>]}
[0m20:20:07.059075 [info ] [MainThread]: Found 4 models, 6 tests, 0 snapshots, 1 analysis, 533 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 2 metrics
[0m20:20:07.059234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3c34806-c1b4-4a2c-8288-db37717c0372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11df77070>]}
[0m20:20:07.060232 [info ] [MainThread]: 
[0m20:20:07.060772 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m20:20:07.061489 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801_getgroundjoao"
[0m20:20:07.061670 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:20:08.386328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3c34806-c1b4-4a2c-8288-db37717c0372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e06db50>]}
[0m20:20:08.387029 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:20:08.387249 [info ] [MainThread]: 
[0m20:20:08.391027 [debug] [Thread-1  ]: Began running node analysis.ggchallengejoao.total_referrals
[0m20:20:08.391417 [debug] [Thread-1  ]: Acquiring new bigquery connection "analysis.ggchallengejoao.total_referrals"
[0m20:20:08.391540 [debug] [Thread-1  ]: Began compiling node analysis.ggchallengejoao.total_referrals
[0m20:20:08.391690 [debug] [Thread-1  ]: Compiling analysis.ggchallengejoao.total_referrals
[0m20:20:08.430697 [debug] [Thread-1  ]: finished collecting timing info
[0m20:20:08.431090 [debug] [Thread-1  ]: Compilation Error in analysis total_referrals (analyses/total_referrals.sql)
  No date grain provided
  
  > in macro default__calculate (macros/calculate.sql)
  > called by macro calculate (macros/calculate.sql)
  > called by analysis total_referrals (analyses/total_referrals.sql)
  > called by analysis total_referrals (analyses/total_referrals.sql)
[0m20:20:08.431295 [debug] [Thread-1  ]: Finished running node analysis.ggchallengejoao.total_referrals
[0m20:20:08.431579 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:20:08.431745 [debug] [MainThread]: Connection 'analysis.ggchallengejoao.total_referrals' was properly closed.
[0m20:20:08.431903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11de15070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e06dee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e1efdc0>]}
[0m20:20:08.432039 [debug] [MainThread]: Flushing usage events
[0m20:20:09.098426 [error] [MainThread]: Encountered an error:
Runtime Error
  Compilation Error in analysis total_referrals (analyses/total_referrals.sql)
    No date grain provided
    
    > in macro default__calculate (macros/calculate.sql)
    > called by macro calculate (macros/calculate.sql)
    > called by analysis total_referrals (analyses/total_referrals.sql)
    > called by analysis total_referrals (analyses/total_referrals.sql)


============================== 2023-01-06 20:20:39.212882 | 99445a1f-06f0-4010-a6dd-f2a5c91fd2f8 ==============================
[0m20:20:39.212919 [info ] [MainThread]: Running with dbt=1.3.2
[0m20:20:39.213493 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joaopaulomedeiroscecilio/dev/dbt-data-analysis', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'parse_only': False, 'select': ['total_referrals'], 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m20:20:39.213618 [debug] [MainThread]: Tracking: tracking
[0m20:20:39.232924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f6fbee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f715100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f7150a0>]}
[0m20:20:39.316497 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m20:20:39.316781 [debug] [MainThread]: Partial parsing: added file: ggchallengejoao://models/examples/total_referrals.sql
[0m20:20:39.316878 [debug] [MainThread]: Partial parsing: deleted file: ggchallengejoao://analyses/total_referrals.sql
[0m20:20:39.330977 [debug] [MainThread]: 1603: static parser failed on examples/total_referrals.sql
[0m20:20:39.388911 [debug] [MainThread]: 1602: parser fallback to jinja rendering on examples/total_referrals.sql
[0m20:20:39.402506 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ggchallengejoao.example

[0m20:20:39.407134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99445a1f-06f0-4010-a6dd-f2a5c91fd2f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fa1f0d0>]}
[0m20:20:39.420915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99445a1f-06f0-4010-a6dd-f2a5c91fd2f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f8af460>]}
[0m20:20:39.421449 [info ] [MainThread]: Found 5 models, 6 tests, 0 snapshots, 0 analyses, 533 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 2 metrics
[0m20:20:39.421793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99445a1f-06f0-4010-a6dd-f2a5c91fd2f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f8af430>]}
[0m20:20:39.424901 [info ] [MainThread]: 
[0m20:20:39.425540 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m20:20:39.426219 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801_getgroundjoao"
[0m20:20:39.426360 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:20:40.825160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99445a1f-06f0-4010-a6dd-f2a5c91fd2f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f6c1c40>]}
[0m20:20:40.826472 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:20:40.826849 [info ] [MainThread]: 
[0m20:20:40.832883 [debug] [Thread-1  ]: Began running node model.ggchallengejoao.total_referrals
[0m20:20:40.833715 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.ggchallengejoao.total_referrals"
[0m20:20:40.833970 [debug] [Thread-1  ]: Began compiling node model.ggchallengejoao.total_referrals
[0m20:20:40.834319 [debug] [Thread-1  ]: Compiling model.ggchallengejoao.total_referrals
[0m20:20:40.862835 [debug] [Thread-1  ]: finished collecting timing info
[0m20:20:40.863347 [debug] [Thread-1  ]: Compilation Error in model total_referrals (models/examples/total_referrals.sql)
  No date grain provided
  
  > in macro default__calculate (macros/calculate.sql)
  > called by macro calculate (macros/calculate.sql)
  > called by model total_referrals (models/examples/total_referrals.sql)
  > called by model total_referrals (models/examples/total_referrals.sql)
[0m20:20:40.863715 [debug] [Thread-1  ]: Finished running node model.ggchallengejoao.total_referrals
[0m20:20:40.864204 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:20:40.864444 [debug] [MainThread]: Connection 'model.ggchallengejoao.total_referrals' was properly closed.
[0m20:20:40.864726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fa6d1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fba7520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fba7430>]}
[0m20:20:40.864945 [debug] [MainThread]: Flushing usage events
[0m20:20:41.678592 [error] [MainThread]: Encountered an error:
Runtime Error
  Compilation Error in model total_referrals (models/examples/total_referrals.sql)
    No date grain provided
    
    > in macro default__calculate (macros/calculate.sql)
    > called by macro calculate (macros/calculate.sql)
    > called by model total_referrals (models/examples/total_referrals.sql)
    > called by model total_referrals (models/examples/total_referrals.sql)


============================== 2023-01-06 20:21:12.815005 | 57581c3e-e4c9-4a60-a91c-693d79d1d135 ==============================
[0m20:21:12.815012 [info ] [MainThread]: Running with dbt=1.3.2
[0m20:21:12.815455 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joaopaulomedeiroscecilio/dev/dbt-data-analysis', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m20:21:12.815538 [debug] [MainThread]: Tracking: tracking
[0m20:21:12.828056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a35520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a35f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a442b0>]}
[0m20:21:12.828982 [debug] [MainThread]: Set downloads directory='/var/folders/nr/2t4z4mks1h3fqcd9w6_2ftvr0000gn/T/dbt-downloads-pfyzxui3'
[0m20:21:12.829340 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:21:13.049427 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:21:13.049839 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:21:13.175574 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:21:13.208104 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/metrics.json
[0m20:21:13.474434 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/metrics.json 200
[0m20:21:13.524000 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:21:14.074635 [info ] [MainThread]:   Installed from version 1.0.0
[0m20:21:14.074912 [info ] [MainThread]:   Up to date!
[0m20:21:14.075177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '57581c3e-e4c9-4a60-a91c-693d79d1d135', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a44910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a9c250>]}
[0m20:21:14.075412 [info ] [MainThread]: Installing dbt-labs/metrics
[0m20:21:14.584010 [info ] [MainThread]:   Installed from version 1.3.2
[0m20:21:14.584981 [info ] [MainThread]:   Up to date!
[0m20:21:14.585634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '57581c3e-e4c9-4a60-a91c-693d79d1d135', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a9ef70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a9eac0>]}
[0m20:21:14.588856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aeaeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a11cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a35280>]}
[0m20:21:14.589221 [debug] [MainThread]: Flushing usage events


============================== 2023-01-06 20:21:30.588732 | f673c098-6369-4d0f-a818-395c15175013 ==============================
[0m20:21:30.588762 [info ] [MainThread]: Running with dbt=1.3.2
[0m20:21:30.589384 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joaopaulomedeiroscecilio/dev/dbt-data-analysis', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:21:30.589511 [debug] [MainThread]: Tracking: tracking
[0m20:21:30.601560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1243fdeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1244130d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124413070>]}
[0m20:21:30.676994 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:21:30.677173 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:21:30.677540 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ggchallengejoao.example

[0m20:21:30.681436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f673c098-6369-4d0f-a818-395c15175013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1247a50d0>]}
[0m20:21:30.692967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f673c098-6369-4d0f-a818-395c15175013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12476cf70>]}
[0m20:21:30.693259 [info ] [MainThread]: Found 5 models, 6 tests, 0 snapshots, 0 analyses, 533 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 2 metrics
[0m20:21:30.693425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f673c098-6369-4d0f-a818-395c15175013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124578040>]}
[0m20:21:30.694733 [info ] [MainThread]: 
[0m20:21:30.695185 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m20:21:30.696048 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801"
[0m20:21:30.696207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:21:32.292741 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801_getgroundjoao"
[0m20:21:32.293166 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:21:32.773056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f673c098-6369-4d0f-a818-395c15175013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12476c7c0>]}
[0m20:21:32.775045 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:21:32.775818 [info ] [MainThread]: 
[0m20:21:32.786188 [debug] [Thread-1  ]: Began running node model.ggchallengejoao.stg_partners
[0m20:21:32.786627 [debug] [Thread-2  ]: Began running node model.ggchallengejoao.stg_referrals
[0m20:21:32.786816 [debug] [Thread-3  ]: Began running node model.metrics.dbt_metrics_default_calendar
[0m20:21:32.787775 [info ] [Thread-1  ]: 1 of 5 START sql view model getgroundjoao.stg_partners ......................... [RUN]
[0m20:21:32.788121 [info ] [Thread-2  ]: 2 of 5 START sql view model getgroundjoao.stg_referrals ........................ [RUN]
[0m20:21:32.788555 [info ] [Thread-3  ]: 3 of 5 START sql table model getgroundjoao.dbt_metrics_default_calendar ........ [RUN]
[0m20:21:32.791322 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_partners"
[0m20:21:32.792169 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_referrals"
[0m20:21:32.793610 [debug] [Thread-2  ]: Began compiling node model.ggchallengejoao.stg_referrals
[0m20:21:32.793087 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.metrics.dbt_metrics_default_calendar"
[0m20:21:32.795103 [debug] [Thread-2  ]: Compiling model.ggchallengejoao.stg_referrals
[0m20:21:32.793407 [debug] [Thread-1  ]: Began compiling node model.ggchallengejoao.stg_partners
[0m20:21:32.795386 [debug] [Thread-3  ]: Began compiling node model.metrics.dbt_metrics_default_calendar
[0m20:21:32.816175 [debug] [Thread-2  ]: Writing injected SQL for node "model.ggchallengejoao.stg_referrals"
[0m20:21:32.817490 [debug] [Thread-1  ]: Compiling model.ggchallengejoao.stg_partners
[0m20:21:32.818410 [debug] [Thread-3  ]: Compiling model.metrics.dbt_metrics_default_calendar
[0m20:21:32.828244 [debug] [Thread-1  ]: Writing injected SQL for node "model.ggchallengejoao.stg_partners"
[0m20:21:32.834781 [debug] [Thread-2  ]: finished collecting timing info
[0m20:21:32.837562 [debug] [Thread-2  ]: Began executing node model.ggchallengejoao.stg_referrals
[0m20:21:32.844101 [debug] [Thread-1  ]: finished collecting timing info
[0m20:21:32.859519 [debug] [Thread-2  ]: Writing runtime sql for node "model.ggchallengejoao.stg_referrals"
[0m20:21:32.863613 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m20:21:32.863732 [debug] [Thread-1  ]: Began executing node model.ggchallengejoao.stg_partners
[0m20:21:32.864014 [debug] [Thread-3  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */


        select 

    datetime_diff(
        cast(cast('2030-01-01' as date) as datetime),
        cast(cast('1990-01-01' as date) as datetime),
        day
    )

  
[0m20:21:32.866982 [debug] [Thread-1  ]: Writing runtime sql for node "model.ggchallengejoao.stg_partners"
[0m20:21:32.867657 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m20:21:32.868035 [debug] [Thread-2  ]: On model.ggchallengejoao.stg_referrals: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.stg_referrals"} */


  create or replace view `dynamic-point-367801`.`getgroundjoao`.`stg_referrals`
  OPTIONS()
  as 

select *
except
    (created_at, updated_at),
    
timestamp_micros(cast(created_at/ 1000 as int64))
 as referral_created_at_timestamp,
    
timestamp_micros(cast(updated_at/ 1000 as int64))
 as referral_updated_at_timestamp
from `dynamic-point-367801`.`getgroundjoao`.`referrals`;


[0m20:21:32.868429 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:21:32.868880 [debug] [Thread-1  ]: On model.ggchallengejoao.stg_partners: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.stg_partners"} */


  create or replace view `dynamic-point-367801`.`getgroundjoao`.`stg_partners`
  OPTIONS()
  as 

select *
except
    (lead_sales_contact, created_at, updated_at),
    if(
        lead_sales_contact = '0', 'No contact', lead_sales_contact
    ) as lead_sales_contact,
    
timestamp_micros(cast(created_at/ 1000 as int64))
 as partner_created_at_timestamp,
    
timestamp_micros(cast(updated_at/ 1000 as int64))
 as partner_updated_at_timestamp
from `dynamic-point-367801`.`getgroundjoao`.`partners`;


[0m20:21:34.128974 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:50d8d0c0-7ad5-4a42-9e7b-b85de64c88ce:EU&page=queryresults
[0m20:21:34.151895 [debug] [Thread-1  ]: finished collecting timing info
[0m20:21:34.152777 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f673c098-6369-4d0f-a818-395c15175013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1300f5ee0>]}
[0m20:21:34.153737 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:9a9fff2e-cad6-4734-8df5-d38d3b04927a:EU&page=queryresults
[0m20:21:34.154234 [info ] [Thread-1  ]: 1 of 5 OK created sql view model getgroundjoao.stg_partners .................... [[32mCREATE VIEW (0 processed)[0m in 1.36s]
[0m20:21:34.155533 [debug] [Thread-2  ]: finished collecting timing info
[0m20:21:34.156042 [debug] [Thread-1  ]: Finished running node model.ggchallengejoao.stg_partners
[0m20:21:34.156610 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f673c098-6369-4d0f-a818-395c15175013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1300f5f40>]}
[0m20:21:34.157188 [info ] [Thread-2  ]: 2 of 5 OK created sql view model getgroundjoao.stg_referrals ................... [[32mCREATE VIEW (0 processed)[0m in 1.36s]
[0m20:21:34.157558 [debug] [Thread-2  ]: Finished running node model.ggchallengejoao.stg_referrals
[0m20:21:34.158057 [debug] [Thread-4  ]: Began running node model.ggchallengejoao.mart_referrals
[0m20:21:34.158309 [info ] [Thread-4  ]: 4 of 5 START sql table model getgroundjoao.mart_referrals ...................... [RUN]
[0m20:21:34.158989 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.ggchallengejoao.mart_referrals"
[0m20:21:34.159159 [debug] [Thread-4  ]: Began compiling node model.ggchallengejoao.mart_referrals
[0m20:21:34.159343 [debug] [Thread-4  ]: Compiling model.ggchallengejoao.mart_referrals
[0m20:21:34.164098 [debug] [Thread-4  ]: Writing injected SQL for node "model.ggchallengejoao.mart_referrals"
[0m20:21:34.164988 [debug] [Thread-4  ]: finished collecting timing info
[0m20:21:34.165189 [debug] [Thread-4  ]: Began executing node model.ggchallengejoao.mart_referrals
[0m20:21:34.176173 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m20:21:34.695531 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:c7bda650-4af3-436f-a1b0-156a14c17b6d:EU&page=queryresults
[0m20:21:34.711777 [debug] [Thread-4  ]: Writing runtime sql for node "model.ggchallengejoao.mart_referrals"
[0m20:21:34.728812 [debug] [Thread-3  ]: Writing injected SQL for node "model.metrics.dbt_metrics_default_calendar"
[0m20:21:34.729813 [debug] [Thread-4  ]: On model.ggchallengejoao.mart_referrals: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.mart_referrals"} */

  
    

    create or replace table `dynamic-point-367801`.`getgroundjoao`.`mart_referrals`
    
    
    OPTIONS()
    as (
      

select
    r.id as referral_id,
    r.company_id as referral_company,
    r.partner_id as referral_partner,
    r.status as referral_status,
    r.is_outbound as referral_outbound,
    r.referral_created_at_timestamp as referral_record_date,
    r.referral_updated_at_timestamp as referral_updated,
    nullif(
        timestamp_diff(
            referral_updated_at_timestamp, referral_created_at_timestamp, day
        ),
        0
    ) as referral_days_from_creation,
    p.partner_type as referral_partner_type,
    case
        when p.lead_sales_contact = '0' then 'No contact' else p.lead_sales_contact
    end as referral_lead_sales_contact,
    coalesce(d.country, 'No country') as referral_country
from `dynamic-point-367801`.`getgroundjoao`.`stg_referrals` r
left join `dynamic-point-367801`.`getgroundjoao`.`partners` p on r.partner_id = p.id
left join `dynamic-point-367801`.`getgroundjoao`.`sales_people` d on p.lead_sales_contact = d.name
    );
  
[0m20:21:34.730787 [debug] [Thread-3  ]: finished collecting timing info
[0m20:21:34.731363 [debug] [Thread-3  ]: Began executing node model.metrics.dbt_metrics_default_calendar
[0m20:21:35.065579 [debug] [Thread-3  ]: Writing runtime sql for node "model.metrics.dbt_metrics_default_calendar"
[0m20:21:35.066686 [debug] [Thread-3  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */

  
    

    create or replace table `dynamic-point-367801`.`getgroundjoao`.`dbt_metrics_default_calendar`
    
    
    OPTIONS()
    as (
      

with days as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
     + 
    
    p11.generated_number * power(2, 11)
     + 
    
    p12.generated_number * power(2, 12)
     + 
    
    p13.generated_number * power(2, 13)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
     cross join 
    
    p as p11
     cross join 
    
    p as p12
     cross join 
    
    p as p13
    
    

    )

    select *
    from unioned
    where generated_number <= 14610
    order by generated_number



),

all_periods as (

    select (
        

        datetime_add(
            cast( cast('1990-01-01' as date) as datetime),
        interval row_number() over (order by 1) - 1 day
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2030-01-01' as date)

)

select * from filtered


),

final as (
    select 
        cast(date_day as date) as date_day,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        week
    ) as date) as date_week,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        month
    ) as date) as date_month,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        quarter
    ) as date) as date_quarter,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        year
    ) as date) as date_year
    from days
)

select * from final
    );
  
[0m20:21:37.190914 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:43303d82-a487-44bc-96ad-e8f2589eb821:EU&page=queryresults
[0m20:21:37.194059 [debug] [Thread-4  ]: finished collecting timing info
[0m20:21:37.195526 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f673c098-6369-4d0f-a818-395c15175013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13012c7f0>]}
[0m20:21:37.196424 [info ] [Thread-4  ]: 4 of 5 OK created sql table model getgroundjoao.mart_referrals ................. [[32mCREATE TABLE (1.5k rows, 96.3 KB processed)[0m in 3.04s]
[0m20:21:37.197553 [debug] [Thread-4  ]: Finished running node model.ggchallengejoao.mart_referrals
[0m20:21:38.027397 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:05afeb61-ed02-4cb2-9deb-3a879fdca5e1:EU&page=queryresults
[0m20:21:38.032880 [debug] [Thread-3  ]: finished collecting timing info
[0m20:21:38.034450 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f673c098-6369-4d0f-a818-395c15175013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1300f5e80>]}
[0m20:21:38.035264 [info ] [Thread-3  ]: 3 of 5 OK created sql table model getgroundjoao.dbt_metrics_default_calendar ... [[32mCREATE TABLE (14.6k rows, 0 processed)[0m in 5.24s]
[0m20:21:38.036014 [debug] [Thread-3  ]: Finished running node model.metrics.dbt_metrics_default_calendar
[0m20:21:38.037374 [debug] [Thread-2  ]: Began running node model.ggchallengejoao.total_referrals
[0m20:21:38.037909 [info ] [Thread-2  ]: 5 of 5 START sql view model getgroundjoao.total_referrals ...................... [RUN]
[0m20:21:38.038924 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.ggchallengejoao.total_referrals"
[0m20:21:38.039199 [debug] [Thread-2  ]: Began compiling node model.ggchallengejoao.total_referrals
[0m20:21:38.039538 [debug] [Thread-2  ]: Compiling model.ggchallengejoao.total_referrals
[0m20:21:38.118567 [debug] [Thread-2  ]: finished collecting timing info
[0m20:21:38.119056 [debug] [Thread-2  ]: Compilation Error in model total_referrals (models/examples/total_referrals.sql)
  No date grain provided
  
  > in macro default__calculate (macros/calculate.sql)
  > called by macro calculate (macros/calculate.sql)
  > called by model total_referrals (models/examples/total_referrals.sql)
  > called by model total_referrals (models/examples/total_referrals.sql)
[0m20:21:38.119230 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f673c098-6369-4d0f-a818-395c15175013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1300928b0>]}
[0m20:21:38.119454 [error] [Thread-2  ]: 5 of 5 ERROR creating sql view model getgroundjoao.total_referrals ............. [[31mERROR[0m in 0.08s]
[0m20:21:38.119712 [debug] [Thread-2  ]: Finished running node model.ggchallengejoao.total_referrals
[0m20:21:38.120670 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m20:21:38.121059 [info ] [MainThread]: 
[0m20:21:38.121244 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 7.43 seconds (7.43s).
[0m20:21:38.121399 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:21:38.121479 [debug] [MainThread]: Connection 'model.ggchallengejoao.stg_partners' was properly closed.
[0m20:21:38.121551 [debug] [MainThread]: Connection 'model.ggchallengejoao.total_referrals' was properly closed.
[0m20:21:38.121625 [debug] [MainThread]: Connection 'model.metrics.dbt_metrics_default_calendar' was properly closed.
[0m20:21:38.121694 [debug] [MainThread]: Connection 'model.ggchallengejoao.mart_referrals' was properly closed.
[0m20:21:38.129597 [info ] [MainThread]: 
[0m20:21:38.129787 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:21:38.129937 [info ] [MainThread]: 
[0m20:21:38.130057 [error] [MainThread]: [33mCompilation Error in model total_referrals (models/examples/total_referrals.sql)[0m
[0m20:21:38.130183 [error] [MainThread]:   No date grain provided
[0m20:21:38.130300 [error] [MainThread]:   
[0m20:21:38.130411 [error] [MainThread]:   > in macro default__calculate (macros/calculate.sql)
[0m20:21:38.130525 [error] [MainThread]:   > called by macro calculate (macros/calculate.sql)
[0m20:21:38.130635 [error] [MainThread]:   > called by model total_referrals (models/examples/total_referrals.sql)
[0m20:21:38.130745 [error] [MainThread]:   > called by model total_referrals (models/examples/total_referrals.sql)
[0m20:21:38.130867 [info ] [MainThread]: 
[0m20:21:38.130984 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m20:21:38.131242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130090b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130090a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130090790>]}
[0m20:21:38.131488 [debug] [MainThread]: Flushing usage events


============================== 2023-01-06 20:22:14.006826 | f10621a5-1994-4999-a725-a4c050f8fe76 ==============================
[0m20:22:14.006868 [info ] [MainThread]: Running with dbt=1.3.2
[0m20:22:14.007571 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/joaopaulomedeiroscecilio/dev/dbt-data-analysis', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:22:14.007694 [debug] [MainThread]: Tracking: tracking
[0m20:22:14.034153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e47aee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e494100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e4940a0>]}
[0m20:22:14.113854 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:22:14.114242 [debug] [MainThread]: Partial parsing: updated file: ggchallengejoao://models/examples/total_referrals.sql
[0m20:22:14.123399 [debug] [MainThread]: 1603: static parser failed on examples/total_referrals.sql
[0m20:22:14.154130 [debug] [MainThread]: 1602: parser fallback to jinja rendering on examples/total_referrals.sql
[0m20:22:14.163175 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ggchallengejoao.example

[0m20:22:14.166681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f10621a5-1994-4999-a725-a4c050f8fe76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f6860d0>]}
[0m20:22:14.173892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f10621a5-1994-4999-a725-a4c050f8fe76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f52f460>]}
[0m20:22:14.174113 [info ] [MainThread]: Found 5 models, 6 tests, 0 snapshots, 0 analyses, 533 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 2 metrics
[0m20:22:14.174264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f10621a5-1994-4999-a725-a4c050f8fe76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f52f430>]}
[0m20:22:14.175181 [info ] [MainThread]: 
[0m20:22:14.175540 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m20:22:14.176126 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801"
[0m20:22:14.176270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:22:15.485612 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dynamic-point-367801_getgroundjoao"
[0m20:22:15.486324 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:22:16.021849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f10621a5-1994-4999-a725-a4c050f8fe76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e4a62b0>]}
[0m20:22:16.023760 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:22:16.024340 [info ] [MainThread]: 
[0m20:22:16.032629 [debug] [Thread-1  ]: Began running node model.ggchallengejoao.stg_partners
[0m20:22:16.032929 [debug] [Thread-2  ]: Began running node model.ggchallengejoao.stg_referrals
[0m20:22:16.033170 [debug] [Thread-3  ]: Began running node model.metrics.dbt_metrics_default_calendar
[0m20:22:16.033669 [info ] [Thread-1  ]: 1 of 5 START sql view model getgroundjoao.stg_partners ......................... [RUN]
[0m20:22:16.034088 [info ] [Thread-2  ]: 2 of 5 START sql view model getgroundjoao.stg_referrals ........................ [RUN]
[0m20:22:16.034409 [info ] [Thread-3  ]: 3 of 5 START sql table model getgroundjoao.dbt_metrics_default_calendar ........ [RUN]
[0m20:22:16.035426 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_partners"
[0m20:22:16.036314 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.ggchallengejoao.stg_referrals"
[0m20:22:16.037161 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.metrics.dbt_metrics_default_calendar"
[0m20:22:16.037439 [debug] [Thread-1  ]: Began compiling node model.ggchallengejoao.stg_partners
[0m20:22:16.037678 [debug] [Thread-2  ]: Began compiling node model.ggchallengejoao.stg_referrals
[0m20:22:16.037909 [debug] [Thread-3  ]: Began compiling node model.metrics.dbt_metrics_default_calendar
[0m20:22:16.038274 [debug] [Thread-1  ]: Compiling model.ggchallengejoao.stg_partners
[0m20:22:16.038662 [debug] [Thread-2  ]: Compiling model.ggchallengejoao.stg_referrals
[0m20:22:16.038835 [debug] [Thread-3  ]: Compiling model.metrics.dbt_metrics_default_calendar
[0m20:22:16.047359 [debug] [Thread-2  ]: Writing injected SQL for node "model.ggchallengejoao.stg_referrals"
[0m20:22:16.061468 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m20:22:16.065112 [debug] [Thread-1  ]: Writing injected SQL for node "model.ggchallengejoao.stg_partners"
[0m20:22:16.065426 [debug] [Thread-3  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */


        select 

    datetime_diff(
        cast(cast('2030-01-01' as date) as datetime),
        cast(cast('1990-01-01' as date) as datetime),
        day
    )

  
[0m20:22:16.065939 [debug] [Thread-2  ]: finished collecting timing info
[0m20:22:16.066582 [debug] [Thread-2  ]: Began executing node model.ggchallengejoao.stg_referrals
[0m20:22:16.066719 [debug] [Thread-1  ]: finished collecting timing info
[0m20:22:16.088978 [debug] [Thread-2  ]: Writing runtime sql for node "model.ggchallengejoao.stg_referrals"
[0m20:22:16.089122 [debug] [Thread-1  ]: Began executing node model.ggchallengejoao.stg_partners
[0m20:22:16.091812 [debug] [Thread-1  ]: Writing runtime sql for node "model.ggchallengejoao.stg_partners"
[0m20:22:16.092100 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m20:22:16.092259 [debug] [Thread-2  ]: On model.ggchallengejoao.stg_referrals: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.stg_referrals"} */


  create or replace view `dynamic-point-367801`.`getgroundjoao`.`stg_referrals`
  OPTIONS()
  as 

select *
except
    (created_at, updated_at),
    
timestamp_micros(cast(created_at/ 1000 as int64))
 as referral_created_at_timestamp,
    
timestamp_micros(cast(updated_at/ 1000 as int64))
 as referral_updated_at_timestamp
from `dynamic-point-367801`.`getgroundjoao`.`referrals`;


[0m20:22:16.092707 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:16.093268 [debug] [Thread-1  ]: On model.ggchallengejoao.stg_partners: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.stg_partners"} */


  create or replace view `dynamic-point-367801`.`getgroundjoao`.`stg_partners`
  OPTIONS()
  as 

select *
except
    (lead_sales_contact, created_at, updated_at),
    if(
        lead_sales_contact = '0', 'No contact', lead_sales_contact
    ) as lead_sales_contact,
    
timestamp_micros(cast(created_at/ 1000 as int64))
 as partner_created_at_timestamp,
    
timestamp_micros(cast(updated_at/ 1000 as int64))
 as partner_updated_at_timestamp
from `dynamic-point-367801`.`getgroundjoao`.`partners`;


[0m20:22:17.252047 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:faa8f55f-c80c-4c5e-9673-88cb46d53d29:EU&page=queryresults
[0m20:22:17.268862 [debug] [Thread-2  ]: finished collecting timing info
[0m20:22:17.270235 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:961f37fa-9204-4a2f-9292-159d8da40b8c:EU&page=queryresults
[0m20:22:17.270826 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f10621a5-1994-4999-a725-a4c050f8fe76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f6e9400>]}
[0m20:22:17.271991 [debug] [Thread-1  ]: finished collecting timing info
[0m20:22:17.272484 [info ] [Thread-2  ]: 2 of 5 OK created sql view model getgroundjoao.stg_referrals ................... [[32mCREATE VIEW (0 processed)[0m in 1.23s]
[0m20:22:17.273020 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f10621a5-1994-4999-a725-a4c050f8fe76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f6f3f40>]}
[0m20:22:17.273476 [debug] [Thread-2  ]: Finished running node model.ggchallengejoao.stg_referrals
[0m20:22:17.273817 [info ] [Thread-1  ]: 1 of 5 OK created sql view model getgroundjoao.stg_partners .................... [[32mCREATE VIEW (0 processed)[0m in 1.24s]
[0m20:22:17.274304 [debug] [Thread-4  ]: Began running node model.ggchallengejoao.mart_referrals
[0m20:22:17.274626 [debug] [Thread-1  ]: Finished running node model.ggchallengejoao.stg_partners
[0m20:22:17.274866 [info ] [Thread-4  ]: 4 of 5 START sql table model getgroundjoao.mart_referrals ...................... [RUN]
[0m20:22:17.275556 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.ggchallengejoao.mart_referrals"
[0m20:22:17.275696 [debug] [Thread-4  ]: Began compiling node model.ggchallengejoao.mart_referrals
[0m20:22:17.275831 [debug] [Thread-4  ]: Compiling model.ggchallengejoao.mart_referrals
[0m20:22:17.280000 [debug] [Thread-4  ]: Writing injected SQL for node "model.ggchallengejoao.mart_referrals"
[0m20:22:17.280551 [debug] [Thread-4  ]: finished collecting timing info
[0m20:22:17.280711 [debug] [Thread-4  ]: Began executing node model.ggchallengejoao.mart_referrals
[0m20:22:17.295500 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m20:22:17.702562 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:5fcdbd18-535d-4f90-b154-aa6b562320fd:EU&page=queryresults
[0m20:22:17.727366 [debug] [Thread-3  ]: Writing injected SQL for node "model.metrics.dbt_metrics_default_calendar"
[0m20:22:17.728059 [debug] [Thread-3  ]: finished collecting timing info
[0m20:22:17.728280 [debug] [Thread-3  ]: Began executing node model.metrics.dbt_metrics_default_calendar
[0m20:22:17.783148 [debug] [Thread-4  ]: Writing runtime sql for node "model.ggchallengejoao.mart_referrals"
[0m20:22:17.784125 [debug] [Thread-4  ]: On model.ggchallengejoao.mart_referrals: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.mart_referrals"} */

  
    

    create or replace table `dynamic-point-367801`.`getgroundjoao`.`mart_referrals`
    
    
    OPTIONS()
    as (
      

select
    r.id as referral_id,
    r.company_id as referral_company,
    r.partner_id as referral_partner,
    r.status as referral_status,
    r.is_outbound as referral_outbound,
    r.referral_created_at_timestamp as referral_record_date,
    r.referral_updated_at_timestamp as referral_updated,
    nullif(
        timestamp_diff(
            referral_updated_at_timestamp, referral_created_at_timestamp, day
        ),
        0
    ) as referral_days_from_creation,
    p.partner_type as referral_partner_type,
    case
        when p.lead_sales_contact = '0' then 'No contact' else p.lead_sales_contact
    end as referral_lead_sales_contact,
    coalesce(d.country, 'No country') as referral_country
from `dynamic-point-367801`.`getgroundjoao`.`stg_referrals` r
left join `dynamic-point-367801`.`getgroundjoao`.`partners` p on r.partner_id = p.id
left join `dynamic-point-367801`.`getgroundjoao`.`sales_people` d on p.lead_sales_contact = d.name
    );
  
[0m20:22:18.089920 [debug] [Thread-3  ]: Writing runtime sql for node "model.metrics.dbt_metrics_default_calendar"
[0m20:22:18.090697 [debug] [Thread-3  ]: On model.metrics.dbt_metrics_default_calendar: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.metrics.dbt_metrics_default_calendar"} */

  
    

    create or replace table `dynamic-point-367801`.`getgroundjoao`.`dbt_metrics_default_calendar`
    
    
    OPTIONS()
    as (
      

with days as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
     + 
    
    p11.generated_number * power(2, 11)
     + 
    
    p12.generated_number * power(2, 12)
     + 
    
    p13.generated_number * power(2, 13)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
     cross join 
    
    p as p11
     cross join 
    
    p as p12
     cross join 
    
    p as p13
    
    

    )

    select *
    from unioned
    where generated_number <= 14610
    order by generated_number



),

all_periods as (

    select (
        

        datetime_add(
            cast( cast('1990-01-01' as date) as datetime),
        interval row_number() over (order by 1) - 1 day
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2030-01-01' as date)

)

select * from filtered


),

final as (
    select 
        cast(date_day as date) as date_day,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        week
    ) as date) as date_week,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        month
    ) as date) as date_month,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        quarter
    ) as date) as date_quarter,
        cast(timestamp_trunc(
        cast(date_day as timestamp),
        year
    ) as date) as date_year
    from days
)

select * from final
    );
  
[0m20:22:20.233328 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:d1422d76-e7d9-4415-8843-38b08007a72e:EU&page=queryresults
[0m20:22:20.238533 [debug] [Thread-4  ]: finished collecting timing info
[0m20:22:20.240184 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f10621a5-1994-4999-a725-a4c050f8fe76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f7dd730>]}
[0m20:22:20.241033 [info ] [Thread-4  ]: 4 of 5 OK created sql table model getgroundjoao.mart_referrals ................. [[32mCREATE TABLE (1.5k rows, 96.3 KB processed)[0m in 2.96s]
[0m20:22:20.242156 [debug] [Thread-4  ]: Finished running node model.ggchallengejoao.mart_referrals
[0m20:22:21.761372 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:3e96fa23-5175-488d-a98c-d141de95b48c:EU&page=queryresults
[0m20:22:21.764885 [debug] [Thread-3  ]: finished collecting timing info
[0m20:22:21.765966 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f10621a5-1994-4999-a725-a4c050f8fe76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a84beb0>]}
[0m20:22:21.766476 [info ] [Thread-3  ]: 3 of 5 OK created sql table model getgroundjoao.dbt_metrics_default_calendar ... [[32mCREATE TABLE (14.6k rows, 0 processed)[0m in 5.73s]
[0m20:22:21.767012 [debug] [Thread-3  ]: Finished running node model.metrics.dbt_metrics_default_calendar
[0m20:22:21.768024 [debug] [Thread-2  ]: Began running node model.ggchallengejoao.total_referrals
[0m20:22:21.768416 [info ] [Thread-2  ]: 5 of 5 START sql view model getgroundjoao.total_referrals ...................... [RUN]
[0m20:22:21.769224 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.ggchallengejoao.total_referrals"
[0m20:22:21.769465 [debug] [Thread-2  ]: Began compiling node model.ggchallengejoao.total_referrals
[0m20:22:21.769783 [debug] [Thread-2  ]: Compiling model.ggchallengejoao.total_referrals
[0m20:22:21.877156 [debug] [Thread-2  ]: Writing injected SQL for node "model.ggchallengejoao.total_referrals"
[0m20:22:21.877632 [debug] [Thread-2  ]: finished collecting timing info
[0m20:22:21.877734 [debug] [Thread-2  ]: Began executing node model.ggchallengejoao.total_referrals
[0m20:22:21.879547 [debug] [Thread-2  ]: Writing runtime sql for node "model.ggchallengejoao.total_referrals"
[0m20:22:21.879807 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m20:22:21.880018 [debug] [Thread-2  ]: On model.ggchallengejoao.total_referrals: /* {"app": "dbt", "dbt_version": "1.3.2", "profile_name": "ggchallengejoao", "target_name": "dev", "node_id": "model.ggchallengejoao.total_referrals"} */


  create or replace view `dynamic-point-367801`.`getgroundjoao`.`total_referrals`
  OPTIONS()
  as 

select *
from
    -- depends on: `dynamic-point-367801`.`getgroundjoao`.`dbt_metrics_default_calendar`
    

(

with calendar as (

    select 
        * 
    from `dynamic-point-367801`.`getgroundjoao`.`dbt_metrics_default_calendar`
     
)



, referral_total_count__aggregate as (
    select
        date_year,
        count(distinct property_to_aggregate) as referral_total_count,
        logical_or(metric_date_day is not null) as has_data
        

    from (

    
        select 
        
            cast(base_model.referral_record_date as date) as metric_date_day, -- timestamp field
            calendar_table.date_year as date_year,
            calendar_table.date_day as window_filter_date,

            
                (referral_id) as property_to_aggregate

        from `dynamic-point-367801`.`getgroundjoao`.`mart_referrals` base_model 
        

    left join `dynamic-point-367801`.`getgroundjoao`.`dbt_metrics_default_calendar` calendar_table
    
        on cast(base_model.referral_record_date as date) = calendar_table.date_day
    

 

        where 1=1
        
        
    ) as base_query

    where 1=1

    

    
        group by
        1



)

, referral_total_count__spine_time as (

    select
        calendar.date_year

    from calendar
    
        group by
        1



)

, referral_total_count__final as (
    
    select
        
        parent_metric_cte.date_year,
        coalesce(referral_total_count, 0) as referral_total_count

    from referral_total_count__spine_time as parent_metric_cte
    left outer join referral_total_count__aggregate
        using (
            date_year
        )

        where (
            parent_metric_cte.date_year >= (
                select 
                    min(case when has_data then date_year end) 
                from referral_total_count__aggregate
            )
            and parent_metric_cte.date_year <= (
                select 
                    max(case when has_data then date_year end) 
                from referral_total_count__aggregate
            )
             
        )      
         
    )



, secondary_calculations as (

    select 
        *


    from referral_total_count__final
)





    select * from referral_total_count__final
        order by
        1 desc



) metric_subq;


[0m20:22:23.491418 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dynamic-point-367801&j=bq:e49a92a7-182e-4643-a066-7b70ad65f61b:EU&page=queryresults
[0m20:22:23.492762 [debug] [Thread-2  ]: finished collecting timing info
[0m20:22:23.493174 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f10621a5-1994-4999-a725-a4c050f8fe76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a807100>]}
[0m20:22:23.493441 [info ] [Thread-2  ]: 5 of 5 OK created sql view model getgroundjoao.total_referrals ................. [[32mCREATE VIEW (0 processed)[0m in 1.72s]
[0m20:22:23.493706 [debug] [Thread-2  ]: Finished running node model.ggchallengejoao.total_referrals
[0m20:22:23.494774 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m20:22:23.495167 [info ] [MainThread]: 
[0m20:22:23.495330 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 9.32 seconds (9.32s).
[0m20:22:23.495472 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:22:23.495544 [debug] [MainThread]: Connection 'model.ggchallengejoao.stg_partners' was properly closed.
[0m20:22:23.495613 [debug] [MainThread]: Connection 'model.ggchallengejoao.total_referrals' was properly closed.
[0m20:22:23.495686 [debug] [MainThread]: Connection 'model.metrics.dbt_metrics_default_calendar' was properly closed.
[0m20:22:23.495754 [debug] [MainThread]: Connection 'model.ggchallengejoao.mart_referrals' was properly closed.
[0m20:22:23.502328 [info ] [MainThread]: 
[0m20:22:23.502523 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:22:23.502671 [info ] [MainThread]: 
[0m20:22:23.502800 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m20:22:23.503012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f5ebf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f5eba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f709700>]}
[0m20:22:23.503145 [debug] [MainThread]: Flushing usage events
